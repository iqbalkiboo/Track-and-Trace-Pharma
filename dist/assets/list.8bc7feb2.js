import{_ as ue}from"./t-loading.vue_vue_type_script_setup_true_lang.71bf4981.js";import{d as ie,r as c,u as Te,E as re,G as Ne,o as m,h as L,w as t,k as e,i as n,c as U,F as G,q as _,t as d,a as s,j as A,g as _e,af as de,s as qe,v as pe,ad as ce,ae as me,K as fe,aa as ge,as as Ce,ak as he,I as Le,aj as ve,J as Ue,M as Ie,f as ze,am as Ee,an as Re,a7 as xe,a8 as Be,H as Oe,aP as Ve,aQ as He,aR as Ae,aS as je,N as Fe,a9 as Qe,y as Ze,aT as Ge,ag as Je,C as Ke,D as We,m as Xe,a4 as oe}from"./index.21c0d750.js";import{d as te}from"./3pl.9faacd75.js";import{r as se}from"./render-icon.8c81e0de.js";import{m as Ye}from"./master-threepl.f4c7982d.js";import{m as et}from"./master-warehouse.353b4b3b.js";import{M as tt}from"./MailOutline.87ebd8f7.js";import{E as at}from"./EllipsisVertical.56989e7a.js";import{C as nt}from"./CloudUploadOutline.5871e1ae.js";import{S as lt}from"./SearchOutline.47b929a4.js";import"./getCompanyId.7d0eb93b.js";import"./getHoldingId.48f570fc.js";const ot=s("span",null,"ID Order 3PL: ",-1),st=s("span",null,"PIC: ",-1),ut=s("span",null,"Total Qty Packing: ",-1),it={key:0},rt=s("span",null,"3PL: ",-1),_t={class:"card-tnt"},dt={class:"table-tnt"},pt=s("thead",null,[s("tr",null,[s("th",null,"No"),s("th",null,"ID Manifest"),s("th",null,"No. DO"),s("th",null,"Tujuan"),s("th",null,"Alamat"),s("th",null,"Qty Packing")])],-1),ct={key:0,class:"card-tnt",style:{"margin-top":"3rem"}},mt=ie({__name:"t-3pl-serah-terima-modal",props:{show:{type:Boolean,default:!1},id:{},type:{}},emits:["update:show","click:serah","click:get"],setup(E,{emit:p}){const D=E,r=c({name:"",phone:"",email:"",date:void 0}),y=c(null),M=c(!1),j=Te(),I=re(),T=c(!1),k=c({});async function J(){M.value=!0,await te.getDetailRequest3pl(D.id).then(a=>{k.value=a.data,M.value=!1,b(a.data["3pl_handover"])}).catch(a=>{if(M.value=!1,a.response){const o=a.response.data;I.error(o.message)}})}function b(a){r.value={name:a.name,email:a.email,phone:a.phone,date:a.handover_date}}function K(a){var o,w,N,P;if(a){const h=a.detail,q=(o=a.urban_village)==null?void 0:o.name,l=(w=a.sub_district)==null?void 0:w.name,i=(N=a.district)==null?void 0:N.name,v=(P=a.province)==null?void 0:P.name;return`${h}, ${q}, ${l}, ${i}, ${v}`}}async function W(){var a;await((a=y.value)==null?void 0:a.validate().then(async()=>{M.value=!0,T.value=!0;const o={receiver:{name:r.value.name,email:r.value.email,phone:r.value.phone,date:r.value.date},request_id:D.id};await te.postHandOver3pl(o).then(()=>{M.value=!1,T.value=!1,p("update:show",!1),p("click:get"),I.success("Berhasil")}).catch(w=>{M.value=!1,T.value=!1;const N=w.response.data;I.error(N.message)})}).catch(()=>{I.error("Form tidak valid, tolong periksa kembali")}))}function X(){localStorage.setItem("is_print_open","0"),localStorage.setItem("data",JSON.stringify(k.value));const a=j.resolve({name:"print-serah-manifest"});window.open(a.href,"_blank")}const F=c();return F.value={name:{required:!0,message:"Nama driver tidak boleh kosong",trigger:["input","blur"]},phone:{required:!0,validator(a,o){if(o)if(/^\d*$/.test(o)){if(o.length<8)return new Error("No. Hp kurang dari 8 angka")}else return new Error("No. Hp harus angka");else return new Error("No. Hp tidak boleh kosong");return!0},trigger:["input","blur"]},email:{required:!0,validator(a,o){const w=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;if(o){if(!o.match(w))return new Error("Email tidak valid")}else return new Error("Email tidak boleh kosong");return!0},trigger:["input","blur"]},date:{required:!1,type:"string",message:"Date tidak boleh kosong",trigger:["blur","change"]}},Ne(()=>D.id,()=>{J()}),(a,o)=>{const w=ue,N=de,P=qe,h=pe,q=ce,l=me,i=fe,v=ge,Y=Ce,V=he,R=Le,ee=ve,Q=Ue,x=Ie;return m(),L(x,{show:a.show,preset:"card","auto-focus":"",role:"dialog",size:"huge",bordered:!1,style:{width:"1200px","max-width":"100%","border-radius":"8px"},"onUpdate:show":o[6]||(o[6]=u=>a.$emit("update:show",u))},{default:t(()=>[e(h,{vertical:""},{default:t(()=>[n(M)?(m(),L(w,{key:0})):(m(),U(G,{key:1},[e(h,{vertical:""},{default:t(()=>[e(N,{style:{"margin-bottom":"4px"}},{default:t(()=>[_(d(a.type==="serah-terima"?"Serah Terima":`ID Order 3PL : ${n(k).order_id||"-"}`),1)]),_:1}),e(h,{justify:"space-between"},{default:t(()=>[e(l,{cols:"2","x-gap":70},{default:t(()=>[e(q,null,{default:t(()=>[e(h,{vertical:"",size:0},{default:t(()=>[a.type==="serah-terima"?(m(),L(P,{key:0,style:{"margin-bottom":"0"}},{default:t(()=>[ot,s("span",null,d(n(k).order_id||"-"),1)]),_:1})):A("",!0),e(P,{style:{"margin-bottom":"0"}},{default:t(()=>{var u;return[st,s("span",null,d((u=n(k).created_by)==null?void 0:u.name),1)]}),_:1}),a.type==="detail"?(m(),L(P,{key:1,style:{"margin-bottom":"0"}},{default:t(()=>{var u;return[ut,a.type==="detail"?(m(),U("span",it,d((u=n(k).manifests)==null?void 0:u.reduce((B,O)=>{var z;return B+((z=O.total)==null?void 0:z.qty)},0)),1)):A("",!0)]}),_:1})):A("",!0)]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(P,{style:{"margin-bottom":"0"}},{default:t(()=>{var u;return[rt,s("span",null,d((u=n(k)["3pl"])==null?void 0:u.name),1)]}),_:1})]),_:1})]),_:1}),e(h,{vertical:""},{default:t(()=>[e(h,{align:"center"},{default:t(()=>[e(i,{type:"info",class:"button-tnt",onClick:X},{default:t(()=>[_("Cetak")]),_:1}),a.type==="detail"?(m(),L(i,{key:0,type:"primary",onClick:o[0]||(o[0]=u=>a.$emit("click:serah")),class:"button-tnt"},{default:t(()=>[_("Serah Terima 3PL")]),_:1})):A("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),s("div",_t,[s("div",dt,[e(v,{"single-line":!1},{default:t(()=>[pt,s("tbody",null,[(m(!0),U(G,null,_e(n(k).manifests,(u,B)=>{var O,z,f,H,Z,g;return m(),U("tr",{key:B},[s("td",null,d(B+1),1),s("td",null,d(u.code),1),s("td",null,d((O=u.do)==null?void 0:O.code),1),s("td",null,d((f=(z=u.do)==null?void 0:z.destination)==null?void 0:f.name),1),s("td",null,d(K((Z=(H=u.do)==null?void 0:H.destination)==null?void 0:Z.address)||"-"),1),s("td",null,d((g=u.total)==null?void 0:g.packing),1)])}),128))])]),_:1})])]),a.type==="serah-terima"?(m(),U("div",ct,[e(Y,{style:{"margin-bottom":"4px"}},{default:t(()=>[_("Penerima 3PL")]),_:1}),e(Q,{ref_key:"formRef",ref:y,class:"form-tnt","show-require-mark":!1,"label-width":80,model:n(r),rules:n(F)},{default:t(()=>[e(l,{cols:"2","x-gap":4},{default:t(()=>[e(q,null,{default:t(()=>[e(R,{label:"Nama",path:"name"},{default:t(()=>[e(V,{value:n(r).name,"onUpdate:value":o[1]||(o[1]=u=>n(r).name=u),placeholder:"Masukkan nama penerima"},null,8,["value"])]),_:1}),e(R,{label:"No. Hp",path:"phone"},{default:t(()=>[e(V,{value:n(r).phone,"onUpdate:value":o[2]||(o[2]=u=>n(r).phone=u),placeholder:"Masukkan nomer handphone"},null,8,["value"])]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(R,{label:"Email",path:"email"},{default:t(()=>[e(V,{value:n(r).email,"onUpdate:value":o[3]||(o[3]=u=>n(r).email=u),placeholder:"Masukkan email"},null,8,["value"])]),_:1}),e(R,{label:"Date",path:"date"},{default:t(()=>[e(ee,{style:{width:"100%"},type:"date","formatted-value":n(r).date,"onUpdate:formattedValue":o[4]||(o[4]=u=>n(r).date=u)},null,8,["formatted-value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"]),e(h,{justify:"center"},{default:t(()=>[e(i,{onClick:o[5]||(o[5]=u=>a.$emit("update:show",!1)),class:"button-tnt"},{default:t(()=>[_("Batalkan")]),_:1}),e(i,{onClick:W,type:"primary",class:"button-tnt"},{default:t(()=>[_("Simpan")]),_:1})]),_:1})])):A("",!0)],64))]),_:1})]),_:1},8,["show"])}}}),ft=E=>(Ke("data-v-7a852d1e"),E=E(),We(),E),gt={class:"body-tnt"},ht={class:"card-tnt"},vt={class:"table-tnt"},yt={style:{"text-transform":"capitalize"}},kt={key:1},bt=ft(()=>s("td",{colspan:"20",style:{"text-align":"center"}}," Belum ada data tersedia ",-1)),wt=[bt],$t={class:"table-footer"},ye=ie({__name:"list",setup(E){c({date:null,status:"",product:"",selected_data_all:!1});const p=c({sort:"desc",page:1,pickup_warehouse_building:{id:null},limit:10}),D=c(""),r=c(!1),y=c({}),M=c([]),j=c(""),I=c([]),T=c(!1),k=re(),J=l=>[{label:"Serah Terima",key:"serah-terima",icon:se(nt)},{label:"Lihat Detail",key:"detail",icon:se(lt)}];async function b(){r.value=!0,await te.get3pl(p.value).then(l=>{y.value=l.data,r.value=!1}).catch(l=>{r.value=!1;const i=l.response.data;k.error(i.message)})}async function K(){r.value=!0,await et.getBuilding({limit:1e3,sort:"desc"}).then(l=>{var i;r.value=!1,I.value=(i=l.data)==null?void 0:i.list.map(v=>({label:v.name,value:v.id}))}).catch(l=>{r.value=!1;const i=l.response.data;y.error(i.message)})}function W(){D.value="serah-terima"}function X(l,i){switch(j.value=i,l){case"detail":D.value=l,T.value=!0;break;case"repeat_send":break;case"edit":break;case"serah-terima":D.value=l,T.value=!0;break}}async function F(){r.value=!0,await Ye.getThreepl({limit:1e3,sort:"desc"}).then(l=>{var i;r.value=!1,M.value=(i=l.data)==null?void 0:i.list.map(v=>({label:v.name,value:v.id}))}).catch(l=>{r.value=!1;const i=l.response.data;y.error(i.message)})}const a=c(0);function o(){p.value.page=1,clearTimeout(a.value),a.value=setTimeout(function(){b()},600)}function w(l){p.value.limit=l,b()}function N(){T.value=!1}function P(l){p.value.pickup_warehouse_building.id=l||null,b()}function h(l){p.value.pickup_date=l||null,b()}function q(l){p.value["3pl.name"]=l||null,b()}return ze(()=>{b(),K(),F()}),(l,i)=>{const v=de,Y=Ee,V=Re,R=xe,ee=Be,Q=he,x=ce,u=ve,B=Oe,O=me,z=ue,f=Ve,H=He,Z=Ae,g=je,ae=Fe,ke=Qe,be=fe,we=Ze,$e=Ge,Se=ge,Me=Je,Pe=pe,De=mt;return m(),U(G,null,[s("div",gt,[e(Pe,{vertical:"",style:{padding:"1rem"}},{default:t(()=>[e(ee,{cols:12,class:"row"},{default:t(()=>[e(R,{span:12},{default:t(()=>[e(v,{style:{"margin-bottom":"4px"}},{default:t(()=>[_("List Request 3PL")]),_:1}),e(V,null,{default:t(()=>[e(Y,null,{default:t(()=>[_("List Request 3PL")]),_:1})]),_:1})]),_:1})]),_:1}),e(O,{cols:"4","x-gap":"12",style:{"margin-top":"1rem"}},{default:t(()=>[e(x,null,{default:t(()=>[e(Q,{value:n(p).order_id,"onUpdate:value":[i[0]||(i[0]=C=>n(p).order_id=C),o],clearable:"",placeholder:"Cari Kode Manifest"},null,8,["value"])]),_:1}),e(x,null,{default:t(()=>[e(Q,{"onUpdate:value":q,placeholder:"Cari Nama 3pl",clearable:""})]),_:1}),e(x,null,{default:t(()=>[e(u,{"value-format":"yyyy-MM-dd",clearable:"",onUpdateFormattedValue:h,placeholder:"Tanggal Request kirim",type:"date"})]),_:1}),e(x,null,{default:t(()=>[e(B,{options:n(I),"onUpdate:value":P,clearable:"",filterable:"",placeholder:"Pilih Lokasi Pengambilan"},null,8,["options"])]),_:1})]),_:1}),s("div",ht,[s("div",vt,[n(r)?(m(),L(z,{key:0})):(m(),L(Se,{key:1,"bottom-bordered":!1,bordered:!1,"single-line":!0},{default:t(()=>[e(Z,null,{default:t(()=>[e(H,null,{default:t(()=>[e(f,null,{default:t(()=>[_("No")]),_:1}),e(f,null,{default:t(()=>[_("ID Order 3PL")]),_:1}),e(f,null,{default:t(()=>[_("Tanggal Request kirim")]),_:1}),e(f,null,{default:t(()=>[_("3PL")]),_:1}),e(f,null,{default:t(()=>[_("Lokasi Pengambilan")]),_:1}),e(f,null,{default:t(()=>[_("Qty Manifest")]),_:1}),e(f,null,{default:t(()=>[_("Qty Packing")]),_:1}),e(f,null,{default:t(()=>[_("Status Email")]),_:1}),e(f,null,{default:t(()=>[_("Aksi")]),_:1})]),_:1})]),_:1}),e($e,null,{default:t(()=>{var C,ne;return[((ne=(C=n(y))==null?void 0:C.list)==null?void 0:ne.length)>0?(m(!0),U(G,{key:0},_e(n(y).list,($,le)=>(m(),L(H,{key:le},{default:t(()=>[e(g,null,{default:t(()=>[_(d(n(p).limit*(n(p).page-1)+(le+1)),1)]),_:2},1024),e(g,{style:{"text-align":"center"}},{default:t(()=>[_(d($.order_id||"-"),1)]),_:2},1024),e(g,null,{default:t(()=>[_(d($.pickup_date),1)]),_:2},1024),e(g,null,{default:t(()=>[_(d($["3pl"].name||"-"),1)]),_:2},1024),e(g,null,{default:t(()=>{var S;return[_(d((S=$.pickup_warehouse_building)==null?void 0:S.name),1)]}),_:2},1024),e(g,null,{default:t(()=>{var S;return[_(d((S=$.qty)==null?void 0:S.manifest),1)]}),_:2},1024),e(g,null,{default:t(()=>{var S;return[_(d((S=$.qty)==null?void 0:S.packing),1)]}),_:2},1024),e(g,null,{default:t(()=>[e(ke,{round:"",bordered:!1,type:$.is_email_request_sent?"success":"warning"},{icon:t(()=>[e(ae,{component:n(tt)},null,8,["component"])]),default:t(()=>[s("span",yt,d($.is_email_request_sent?"Terkirim":"Gagal Terkirim"),1)]),_:2},1032,["type"])]),_:2},1024),e(g,null,{default:t(()=>[e(we,{placement:"bottom-end","show-arrow":"",options:J($.status),onSelect:S=>X(S,$._id)},{default:t(()=>[e(be,{tertiary:""},{icon:t(()=>[e(ae,null,{default:t(()=>[e(n(at))]),_:1})]),_:1})]),_:2},1032,["options","onSelect"])]),_:2},1024)]),_:2},1024))),128)):(m(),U("tr",kt,wt))]}),_:1})]),_:1})),s("div",$t,[e(Me,{page:n(p).page,"onUpdate:page":[i[1]||(i[1]=C=>n(p).page=C),b],"page-size":n(p).limit,"onUpdate:pageSize":[i[2]||(i[2]=C=>n(p).limit=C),w],"page-count":n(y).total_page,"page-slot":7,"show-size-picker":n(y).total_data>10,"page-sizes":[10,20,30,40,50]},null,8,["page","page-size","page-count","show-size-picker"])])])])]),_:1})]),e(De,{show:n(T),id:n(j),"onUpdate:show":N,type:n(D),"onClick:serah":W,"onClick:get":b},null,8,["show","id","type"])],64)}}});typeof oe=="function"&&oe(ye);const Et=Xe(ye,[["__scopeId","data-v-7a852d1e"]]);export{Et as default};
