import{_ as ve}from"./t-feedback.vue_vue_type_script_setup_true_lang.83eb0b14.js";import{_ as ke}from"./t-loading.vue_vue_type_script_setup_true_lang.71bf4981.js";import{d as be,u as ye,E as we,r as c,a1 as Ce,f as xe,o as _,c as v,a as s,k as t,w as a,q as r,ah as f,i as e,N as S,h as B,F as D,g as Ae,t as k,j as T,af as je,am as Me,an as Se,K as Be,L as De,ak as $e,a7 as Ie,a8 as Ne,a9 as Fe,y as ze,aa as Ke,ab as Te,ag as Ue,v as Ve,as as Ee,I as Re,J as Oe,M as qe,Q as U}from"./index.21c0d750.js";import{h as Le}from"./moment.62d3fb0a.js";import{a as V}from"./adjustment.098753fc.js";import{_ as Pe}from"./modal-import-excel.vue_vue_type_script_setup_true_lang.4f82aa47.js";import{A as He}from"./Add.4f3b52cf.js";import{E as Qe}from"./EllipsisVertical.56989e7a.js";import{C as Ge}from"./CheckmarkCircleOutline.8fddcae1.js";import{S as E}from"./SearchOutline.47b929a4.js";import{C as Je}from"./CloseOutline.cda7564f.js";import"./getCompanyId.7d0eb93b.js";const Ye={class:"body-tnt"},We={class:"card-tnt"},Xe={class:"table-tnt"},Ze=s("thead",null,[s("tr",null,[s("th",null,"No"),s("th",null,"Kode Adjust"),s("th",null,"Tanggal Adjust"),s("th",null,"Qty"),s("th",{style:{"text-align":"center"}},"Status"),s("th",{style:{"text-align":"center",width:"3rem"}},"Aksi")])],-1),et={"data-label":"No"},tt={"data-label":"Kode Adjust"},at={"data-label":"Tanggal Adjust"},nt={"data-label":"Qty"},ot={"data-label":"Status",style:{"text-align":"center"}},st={"data-label":"Aksi",style:{"text-align":"center"}},lt={key:1},it=s("td",{colspan:"6",style:{"text-align":"center"}}," Belum ada data tersedia ",-1),ct=[it],ut={class:"table-footer"},Ct=be({__name:"index",setup(dt){const R=ye(),x=we(),b=c(!0),d=c(!1),g=c({}),u=c({search:"",status:"",sort:"desc",sort_field:"created_at",page:1,limit:10}),A=c({show:!1}),y=c({show:!1}),w=c({id:"",code:""}),$=c(),C=c({}),I=c();I.value={reason:{required:!0,message:"Alasan tidak boleh kosong",trigger:["input","blur"]}};const n=c({show:c(!1),type:"",icon:Ce(),iconColor:"",hideIcon:!1,title:"",subtitle:"",align:"center"}),j=i=>()=>U(S,null,{default:()=>U(i)}),O=[{label:"Detail",key:"detail",icon:j(E)}],q=[{label:"Detail",key:"detail",icon:j(E)},{label:"Batalkan",key:"cancel",icon:j(Je)}];function L(i,l,h){switch(i){case"detail":R.push({name:"penyimpanan-penyesuaian-id",params:{id:l}});break;case"cancel":w.value.id=l,w.value.code=h,J();break}}xe(()=>{localStorage.removeItem("product_id"),m()});async function m(){b.value=!0,d.value=!0,await V.getAdjustment(u.value).then(i=>{g.value=i.data,b.value=!1,d.value=!1}).catch(i=>{b.value=!1,d.value=!1;const l=i.response.data;x.error(l.message)})}const N=c(0);function P(){u.value.page=1,clearTimeout(N.value),N.value=setTimeout(function(){m()},600)}function H(i){u.value.page=1,u.value.limit=i,m()}function Q(){A.value.show=!0}function G(){A.value.show=!1}function J(){y.value.show=!0}function F(){C.value.reason="",y.value.show=!1}async function Y(){d.value=!0;const i=new FormData;i.append("adjustment_id",w.value.id),i.append("reason","coba"),await V.cancelAdjustment(i).then(()=>{n.value.show=!1,F(),setTimeout(()=>{ee(),d.value=!1},300)}).catch(l=>{d.value=!1;const h=l.response.data;x.error(h.message)})}function W(){var i;(i=$.value)==null||i.validate().then(()=>{n.value.type="confirm",n.value.hideIcon=!0,n.value.title="Konfirmasi Cancel",n.value.subtitle=`Apakah Anda yakin untuk membatalkan kode ${w.value.code} ?`,n.value.show=!0}).catch(()=>{x.error("Form tidak valid, tolong periksa kembali")})}function X(){n.value.show=!1}function Z(){m(),n.value.show=!1}function ee(){n.value.type="success",n.value.icon=Ge,n.value.iconColor="#219653",n.value.title="Berhasil",n.value.subtitle="Anda berhasil membatalkan adjustment",n.value.show=!0}return(i,l)=>{const h=je,te=Me,ae=Se,p=Be,ne=De,z=$e,oe=Ie,se=Ne,le=ke,ie=Fe,ce=ze,ue=Ke,de=Te,re=Ue,M=Ve,_e=ve,pe=Ee,me=Re,fe=Oe,ge=qe;return _(),v(D,null,[s("div",Ye,[t(h,{style:{"margin-bottom":"4px"}},{default:a(()=>[r("Penyesuaian (Adjustment)")]),_:1}),t(ae,null,{default:a(()=>[t(te,null,{default:a(()=>[r("Penyesuaian (Adjustment)")]),_:1})]),_:1}),t(ne,{style:{"border-radius":"10px","margin-top":"18px"}},{default:a(()=>[t(p,{type:"primary",class:"button-tnt",onClick:f(Q,["prevent"])},{default:a(()=>[t(e(S),{component:e(He)},null,8,["component"]),r(" Upload Adjustment ")]),_:1},8,["onClick"])]),_:1}),s("div",We,[t(se,{gutter:"16"},{default:a(()=>[t(oe,{span:6},{default:a(()=>[t(z,{value:e(u).search,"onUpdate:value":[l[0]||(l[0]=o=>e(u).search=o),P],clearable:"",type:"text",placeholder:"Cari Kode Adjustment"},null,8,["value"])]),_:1})]),_:1}),s("div",Xe,[e(b)?(_(),B(le,{key:0})):(_(),B(de,{key:1,"x-scrollable":""},{default:a(()=>[t(ue,{"single-line":!1},{default:a(()=>[Ze,s("tbody",null,[e(g).list.length>0?(_(!0),v(D,{key:0},Ae(e(g).list,(o,K)=>(_(),v("tr",{key:K},[s("td",et,k(e(u).limit*(e(u).page-1)+(K+1)),1),s("td",tt,k(o.adjustment_code),1),s("td",at,k(e(Le)(o.created_at).format("yyyy-MM-DD")),1),s("td",nt,k(o.total_qty),1),s("td",ot,[t(ie,{round:"",bordered:!1,type:o.status==="cancel"?"error":o.status==="pending"?"warning":"success"},{default:a(()=>[r(k(o.status),1)]),_:2},1032,["type"])]),s("td",st,[t(ce,{"show-arrow":"",placement:"bottom-end",options:o.status==="pending"?q:O,onSelect:he=>L(he,o.id,o.adjustment_code)},{default:a(()=>[t(p,{tertiary:""},{icon:a(()=>[t(e(S),null,{default:a(()=>[t(e(Qe))]),_:1})]),_:1})]),_:2},1032,["options","onSelect"])])]))),128)):(_(),v("tr",lt,ct))])]),_:1})]),_:1})),s("div",ut,[t(re,{page:e(u).page,"onUpdate:page":[l[1]||(l[1]=o=>e(u).page=o),m],"page-size":e(u).limit,"onUpdate:pageSize":[l[2]||(l[2]=o=>e(u).limit=o),H],"page-count":e(g).total_page,"page-slot":7,"show-size-picker":e(g).total_data>10,"page-sizes":[10,20,30,40,50]},null,8,["page","page-size","page-count","show-size-picker"])])])])]),t(Pe,{"is-show-modal":e(A).show,onHideModal:G,onGetData:m},null,8,["is-show-modal"]),t(_e,{show:e(n).show,"onUpdate:show":l[3]||(l[3]=o=>e(n).show=o),icon:e(n).icon,"icon-color":e(n).iconColor,"hide-icon":e(n).hideIcon,title:e(n).title,subtitle:e(n).subtitle,align:e(n).align},{default:a(()=>[t(M,{justify:"center",style:{width:"100%"}},{default:a(()=>[e(n).type=="success"?(_(),B(p,{key:0,color:"#828282",class:"button-tnt",onClick:f(Z,["prevent"])},{default:a(()=>[r(" Tutup ")]),_:1},8,["onClick"])):T("",!0),e(n).type=="confirm"?(_(),v(D,{key:1},[t(p,{loading:e(d),color:"#828282",class:"button-tnt",onClick:f(X,["prevent"])},{default:a(()=>[r(" Batalkan ")]),_:1},8,["loading","onClick"]),t(p,{loading:e(d),color:"#EB5757",class:"button-tnt",style:{"padding-left":"25px","padding-right":"25px"},onClick:f(Y,["prevent"])},{default:a(()=>[r(" Yakin ")]),_:1},8,["loading","onClick"])],64)):T("",!0)]),_:1})]),_:1},8,["show","icon","icon-color","hide-icon","title","subtitle","align"]),t(ge,{"mask-closable":!1,show:e(y).show,preset:"card",role:"dialog",size:"huge",bordered:!1,style:{width:"470px","max-width":"100%","border-radius":"8px"},"header-style":"padding-bottom: 10px","onUpdate:show":l[5]||(l[5]=o=>e(y).show=!1)},{default:a(()=>[t(M,{vertical:""},{default:a(()=>[t(pe,{style:{"margin-bottom":"0"}},{default:a(()=>[r("Konfirmasi Cancel")]),_:1}),t(fe,{ref_key:"formRef",ref:$,model:e(C),rules:e(I),"show-require-mark":!1,class:"form-tnt",style:{width:"100%"}},{default:a(()=>[t(me,{path:"reason",label:"Alasan"},{default:a(()=>[t(z,{value:e(C).reason,"onUpdate:value":l[4]||(l[4]=o=>e(C).reason=o),placeholder:"Masukkan alasan"},null,8,["value"])]),_:1})]),_:1},8,["model","rules"]),t(M,{justify:"center"},{default:a(()=>[t(p,{loading:e(d),color:"#828282",class:"button-tnt",onClick:f(F,["prevent"])},{default:a(()=>[r(" Batalkan ")]),_:1},8,["loading","onClick"]),t(p,{loading:e(d),color:"#EB5757",class:"button-tnt",style:{"padding-left":"25px","padding-right":"25px"},onClick:f(W,["prevent"])},{default:a(()=>[r(" Konfirmasi ")]),_:1},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["show"])],64)}}});export{Ct as default};
