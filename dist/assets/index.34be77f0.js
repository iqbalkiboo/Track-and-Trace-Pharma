import{_ as _e}from"./t-permission-modal.bdf6acbc.js";import{_ as pe}from"./t-feedback.vue_vue_type_script_setup_true_lang.83eb0b14.js";import{_ as ge}from"./t-loading.vue_vue_type_script_setup_true_lang.71bf4981.js";import{d as fe,b as he,E as ve,r as c,f as ke,e as be,aF as Y,a1 as we,p as ye,o as g,c as K,a as F,k as n,w as i,q as d,t as N,i as t,h as v,j as T,S as xe,F as V,ah as Ce,af as Te,am as Ee,an as Pe,ak as Fe,I as De,v as Me,s as Be,ad as Ie,ae as Se,aM as Ue,bq as Ke,J as Ne,K as Ve,M as $e}from"./index.21c0d750.js";import{c as I}from"./constant.549d5c21.js";import{m as qe}from"./master-kemasan-kolektif.2fd7ef6d.js";import{m as $}from"./master-kemasan-kategori-kolektif.b8aba5ae.js";import{s as je}from"./storage.731d7fd8.js";import{A as Ae}from"./AlertCircleOutline.19cf574c.js";import{C as Re}from"./CheckmarkCircleOutline.8fddcae1.js";import"./getHoldingId.48f570fc.js";import"./getCompanyId.7d0eb93b.js";const Le={class:"body-tnt"},ze={class:"card-tnt"},Ge={class:"bottom-action-button"},Oe={class:"action-item"},He=["src"],st=fe({__name:"index",setup(Je){const f=he(),D=ve(),M=c(),p=c(""),_=c(!1),m=c(!1),q=c({}),l=c({selling_packaging_id:"",name:"",dimention_long:0,dimention_wide:0,dimention_height:0,dimention_weight:0,dimention_volume:0,image_ids:[]}),j=c(),A=c(),E=c({show:!1});ke(()=>{M.value=be.getAuth(),f.params.crud=="create"?(p.value="create",Y.isGranted(I.accessPrivileges.collectivePackaging+".create")?(L(),R()):E.value.show=!0):(p.value="update",Y.isGranted(I.accessPrivileges.collectivePackaging+".update")?(L(),R()):E.value.show=!0)});function Q(){E.value.show=!1}async function R(){p.value=="update"&&(_.value=!0,await $.getDetailPackagingCategoryCollectif(f.params.id_kat).then(a=>{X(a.data),_.value=!1}).catch(a=>{_.value=!1;const e=a.response.data;D.error(e.message)}))}async function L(){_.value=!0,await qe.getDetailPackagingCollectif(f.params.id).then(a=>{q.value=a.data,_.value=!1,o.value.show=!1}).catch(a=>{_.value=!1;const e=a.response.data;D.error(e.message)})}function S(){if(l.value.dimention_long&&l.value.dimention_wide&&l.value.dimention_height){const a=parseFloat(l.value.dimention_long)*parseFloat(l.value.dimention_wide)*parseFloat(l.value.dimention_height);l.value.dimention_volume=Math.round(a*1e3)/1e3}else l.value.dimention_volume=0}function W(){_.value=!0,m.value=!0;let a="";M.value.xxtype==="5up3r4dm1n"?a=M.value["xx-usertype-access"].holding_id:a=M.value.users.user_type.id,b.value.forEach(s=>{l.value.image_ids.push(s.id)});const e={selling_packaging_id:f.params.id,holding_id:a,name:l.value.name,dimention:{long:Number(l.value.dimention_long),wide:Number(l.value.dimention_wide),height:Number(l.value.dimention_height),weight:Number(l.value.dimention_weight),volume:Number(l.value.dimention_volume)},image_ids:l.value.image_ids};if(p.value=="create")$.createPackagingCategoryCollectif(e).then(()=>{_.value=!1,m.value=!1,Z(),k(),setTimeout(()=>{O()},300)}).catch(s=>{const u=s.response.data;_.value=!1,m.value=!1,k(),setTimeout(()=>{G(u)},300)});else{const s=f.params.id_kat;$.updatePackagingCategoryCollectif(s,e).then(()=>{_.value=!1,m.value=!1,k(),setTimeout(()=>{O()},300)}).catch(u=>{const w=u.response.data;_.value=!1,m.value=!1,k(),setTimeout(()=>{G(w)},300)})}}function X(a){l.value={name:a.name,dimention_long:String(a.dimention.long),dimention_wide:String(a.dimention.wide),dimention_height:String(a.dimention.height),dimention_weight:String(a.dimention.weight),dimention_volume:String(a.dimention.volume),image_ids:[]},a.images.forEach(e=>{b.value.push({id:e.id,name:e.type,url:e.url,status:"finished"})})}function Z(){b.value=[],l.value={selling_packaging_id:"",name:"",dimention_long:0,dimention_wide:0,dimention_height:0,dimention_weight:0,dimention_volume:0,image_ids:[]}}async function z(a){var e;a.preventDefault(),await((e=j.value)==null?void 0:e.validate()),ee()}const o=c({type:"",show:c(!1),icon:we(),iconColor:"#36A630",hideIcon:!1,title:"Selamat",subtitle:"Tipe kemasan kolektif berhasil ditambahkan"});function k(){o.value.show=!1}function ee(){o.value.type="confirm",o.value.hideIcon=!0,o.value.title="Konfirmasi",p.value=="create"?o.value.subtitle="Apakah Anda yakin untuk menambah tipe kemasan?":o.value.subtitle="Apakah Anda yakin untuk mengubah tipe kemasan?",o.value.show=!0}function G(a){o.value.type="failed",o.value.hideIcon=!1,o.value.iconColor="#EB5757",o.value.icon=Ae,o.value.title="Gagal",Object.keys(a.validation).length>0?o.value.subtitle=a.validation:o.value.subtitle=a.message,o.value.show=!0}function O(){o.value.type="success",o.value.hideIcon=!1,o.value.iconColor="#219653",o.value.icon=Re,p.value=="create"?(o.value.title="Berhasil Tambah Data",o.value.subtitle="Data tipe kemasan berhasil ditambahkan"):(o.value.title="Berhasil Ubah Data",o.value.subtitle="Data tipe kemasan berhasil diubah"),o.value.show=!0}const B=c(!1),H=c(""),b=c([]);function te(a){const{url:e}=a;H.value=e,B.value=!0}function ae(a){b.value=b.value.filter(function(e){return e.id!==a.file.id})}function ne(a){var s;return["image/png","image/jpeg"].indexOf(String((s=a.file.file)==null?void 0:s.type))===-1?(D.error("Format gambar harus png atau jpg, tolong upload ulang"),!1):!0}function ie({file:a,onFinish:e}){m.value=!0;const s=new FormData;s.append("file",a.file),s.append("source","upload"),s.append("title",a.name),s.append("caption",a.name),s.append("alt",a.name),je.uploadStorage(s).then(u=>{u.data.status===200&&(b.value.push({id:u.data.data.id,name:u.data.data.title,status:"finished",url:u.data.data.public_url}),m.value=!1,e())}).catch(u=>{m.value=!1;const w=u.response.data;D.error(w.message)})}return A.value={name:{required:!0,message:"Nama tipe kemasan tidak boleh kosong",trigger:["input","blur"]},dimention_long:{required:!0,validator(a,e){const s=/,/;if(e){if(s.test(e))return new Error("Tidak boleh menggunakan koma");if(e==="0")return new Error("Panjang harus lebih dari 0")}else return new Error("Panjang tidak boleh kosong");return!0},trigger:["input","blur"]},dimention_wide:{required:!0,validator(a,e){const s=/,/;if(e){if(s.test(e))return new Error("Tidak boleh menggunakan koma");if(e==="0")return new Error("Lebar harus lebih dari 0")}else return new Error("Lebar tidak boleh kosong");return!0},trigger:["input","blur"]},dimention_height:{required:!0,validator(a,e){const s=/,/;if(e){if(s.test(e))return new Error("Tidak boleh menggunakan koma");if(e==="0")return new Error("Tinggi harus lebih dari 0")}else return new Error("Tinggi tidak boleh kosong");return!0},trigger:["input","blur"]},dimention_weight:{required:!0,validator(a,e){const s=/,/;if(e){if(s.test(e))return new Error("Tidak boleh menggunakan koma");if(e==="0")return new Error("Berat harus lebih dari 0")}else return new Error("Berat tidak boleh kosong");return!0},trigger:["input","blur"]},dimention_volume:{required:!0,validator(a,e){const s=/,/;if(e){if(s.test(e))return new Error("Tidak boleh menggunakan koma");if(e==="0")return new Error("Volume harus lebih dari 0")}else return new Error("Volume tidak boleh kosong");return!0},trigger:["input","blur"]}},(a,e)=>{const s=Te,u=ye("router-link"),w=Ee,oe=Pe,le=ge,x=Fe,C=De,y=Me,U=Be,P=Ie,se=Se,re=Ue,J=Ke,ue=Ne,h=Ve,de=$e,me=pe,ce=_e;return g(),K(V,null,[F("div",Le,[n(s,{style:{"margin-bottom":"4px"}},{default:i(()=>[d(N(t(p)==="create"?"Tambah":"Edit")+" Tipe Kemasan Kolektif",1)]),_:1}),n(oe,null,{default:i(()=>[n(w,null,{default:i(()=>[n(u,{to:"/setting/kategori-kemasan",class:"text-decoration-none"},{default:i(()=>[d(" Kategori Kemasan ")]),_:1})]),_:1}),n(w,null,{default:i(()=>[n(u,{to:`/setting/kategori-kemasan/${t(f).params.id}`,class:"text-decoration-none"},{default:i(()=>[d(N(t(q).name),1)]),_:1},8,["to"])]),_:1}),n(w,null,{default:i(()=>[d(N(t(p)==="create"?"Tambah":"Edit")+" Tipe Kemasan Kolektif",1)]),_:1})]),_:1}),F("div",ze,[t(_)?(g(),v(le,{key:0})):(g(),v(ue,{key:1,ref_key:"formRef",ref:j,class:"form-tnt","show-require-mark":!1,"label-width":80,model:t(l),rules:t(A)},{default:i(()=>[n(y,{vertical:"",size:0},{default:i(()=>[n(y,{vertical:"",size:0},{default:i(()=>[n(C,{label:"Nama Kemasan",path:"name"},{default:i(()=>[n(x,{value:t(l).name,"onUpdate:value":e[0]||(e[0]=r=>t(l).name=r),placeholder:"Masukkan Nama Kemasan"},null,8,["value"])]),_:1})]),_:1}),n(y,{vertical:"",size:0},{default:i(()=>[n(U,{style:{"font-weight":"500",display:"block","padding-bottom":"6px","padding-left":"2px"}},{default:i(()=>[d("Dimensi")]),_:1}),n(se,{cols:"5","item-responsive":"",responsive:"screen","x-gap":"16","y-gap":"16"},{default:i(()=>[n(P,{span:"5 m:1"},{default:i(()=>[n(C,{label:"Panjang (cm)",path:"dimention_long"},{default:i(()=>[n(x,{value:t(l).dimention_long,"onUpdate:value":e[1]||(e[1]=r=>t(l).dimention_long=r),placeholder:"0",onInput:S},null,8,["value"])]),_:1})]),_:1}),n(P,{span:"5 m:1"},{default:i(()=>[n(C,{label:"Lebar (cm)",path:"dimention_wide"},{default:i(()=>[n(x,{value:t(l).dimention_wide,"onUpdate:value":e[2]||(e[2]=r=>t(l).dimention_wide=r),placeholder:"0",onInput:S},null,8,["value"])]),_:1})]),_:1}),n(P,{span:"5 m:1"},{default:i(()=>[n(C,{label:"Tinggi (cm)",path:"dimention_height"},{default:i(()=>[n(x,{value:t(l).dimention_height,"onUpdate:value":e[3]||(e[3]=r=>t(l).dimention_height=r),placeholder:"0",onInput:S},null,8,["value"])]),_:1})]),_:1}),n(P,{span:"5 m:1"},{default:i(()=>[n(C,{label:"Volume (cm\xB3)",path:"dimention_volume"},{default:i(()=>[n(x,{value:t(l).dimention_volume,"onUpdate:value":e[4]||(e[4]=r=>t(l).dimention_volume=r),placeholder:"0"},null,8,["value"])]),_:1})]),_:1}),n(P,{span:"5 m:1"},{default:i(()=>[n(C,{label:"Berat (gram)",path:"dimention_weight"},{default:i(()=>[n(x,{value:t(l).dimention_weight,"onUpdate:value":e[5]||(e[5]=r=>t(l).dimention_weight=r),placeholder:"0"},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1}),n(y,{vertical:"",size:0},{default:i(()=>[n(U,{style:{"font-weight":"500",display:"block","padding-bottom":"6px","padding-left":"2px"}},{default:i(()=>[d("Upload Photo")]),_:1}),t(m)?(g(),v(y,{key:1,size:8},{default:i(()=>[n(J,{height:"90px",width:"96px"}),n(J,{height:"90px",width:"96px"})]),_:1})):(g(),v(re,{key:0,action:"","default-file-list":t(b),"list-type":"image-card",onPreview:te,onRemove:ae,onBeforeUpload:ne,"custom-request":ie},null,8,["default-file-list"])),n(y,{style:{"margin-top":"5px","margin-left":"3px"}},{default:i(()=>[n(U,{style:{"font-size":"11px"}},{default:i(()=>[d("Format gambar harus png atau jpg. Max ukuran 2Mb")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"]))]),F("div",Ge,[F("div",Oe,[n(u,{to:`/setting/kategori-kemasan/${t(f).params.id}`,class:"text-decoration-none"},{default:i(()=>[n(h,{loading:t(m),color:"#828282",class:"button-tnt"},{default:i(()=>[d(" Kembali ")]),_:1},8,["loading"])]),_:1},8,["to"]),t(p)==="create"&&a.$filters.isGranted(t(I).accessPrivileges.collectivePackaging+".create")?(g(),v(h,{key:0,color:"#219653",class:"button-tnt",loading:t(m),onClick:z},{default:i(()=>[d(" Simpan ")]),_:1},8,["loading"])):T("",!0),t(p)==="update"&&a.$filters.isGranted(t(I).accessPrivileges.collectivePackaging+".update")?(g(),v(h,{key:1,color:"#219653",class:"button-tnt",loading:t(m),onClick:z},{default:i(()=>[d(" Simpan ")]),_:1},8,["loading"])):T("",!0)])])]),n(de,{show:t(B),"onUpdate:show":e[6]||(e[6]=r=>xe(B)?B.value=r:null),preset:"card",style:{width:"600px"},title:""},{default:i(()=>[F("img",{src:t(H),style:{width:"100%"}},null,8,He)]),_:1},8,["show"]),n(me,{show:t(o).show,"onUpdate:show":e[7]||(e[7]=r=>t(o).show=r),icon:t(o).icon,"icon-color":t(o).iconColor,"hide-icon":t(o).hideIcon,title:t(o).title,subtitle:t(o).subtitle},{default:i(()=>[n(y,{justify:"center"},{default:i(()=>[t(o).type=="confirm"?(g(),K(V,{key:0},[n(h,{loading:t(m),color:"#828282",class:"button-tnt",onClick:k},{default:i(()=>[d(" Tutup ")]),_:1},8,["loading"]),n(h,{loading:t(m),color:"#219653",class:"button-tnt",style:{"padding-left":"25px","padding-right":"25px"},onClick:Ce(W,["prevent"])},{default:i(()=>[d(" Yakin ")]),_:1},8,["loading","onClick"])],64)):T("",!0),t(o).type=="success"?(g(),K(V,{key:1},[t(p)=="create"?(g(),v(h,{key:0,color:"#828282",class:"button-tnt",onClick:k},{default:i(()=>[d(" Tambah Lainya ")]),_:1})):T("",!0),n(u,{to:`/setting/kategori-kemasan/${t(f).params.id}`,class:"text-decoration-none"},{default:i(()=>[n(h,{color:"#219653",class:"button-tnt"},{default:i(()=>[d(" Kembali ke Beranda ")]),_:1})]),_:1},8,["to"])],64)):T("",!0),t(o).type=="failed"?(g(),v(h,{key:2,color:"#828282",class:"button-tnt",onClick:k},{default:i(()=>[d(" Tutup ")]),_:1})):T("",!0)]),_:1})]),_:1},8,["show","icon","icon-color","hide-icon","title","subtitle"]),n(ce,{show:t(E).show,"onUpdate:show":e[8]||(e[8]=r=>t(E).show=r),"onClick:close":Q},null,8,["show"])],64)}}});export{st as default};
