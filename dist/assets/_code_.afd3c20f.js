import{_ as Y}from"./t-scan-modal.vue_vue_type_script_setup_true_lang.af24c4ce.js";import{_ as Z}from"./t-feedback.vue_vue_type_script_setup_true_lang.83eb0b14.js";import{p as I,_ as ee}from"./pengemasan.c1a27849.js";import{d as ne,b as te,u as ae,E as oe,r as g,W as se,f as le,o as L,c as j,k as e,w as n,q as s,t as f,i as l,F as D,g as ie,h as ue,S as x,j as _e,aG as re,am as ce,an as me,v as de,ar as pe,ac as fe,s as ge,ad as ve,N as ke,K as ye,a9 as be,ae as he,aS as we,y as Se,aQ as Ie,a4 as B}from"./index.21c0d750.js";import{A as $e}from"./Add.4f3b52cf.js";import{E as Ke}from"./EllipsisVertical.56989e7a.js";import"./CheckmarkCircleOutline.8fddcae1.js";import"./getCompanyId.7d0eb93b.js";import"./getHoldingId.48f570fc.js";const Ce=ne({__name:"[code]",setup(Le){const N=te(),z=ae(),r=oe(),E=g([{label:"No"},{label:"ID Level 1"},{label:"Batch"},{label:"Aksi",style:{width:"3rem"}}]),M=se(()=>[{label:"Hapus",key:"delete"}]),$=g(!1),i=g(),v=g(!1),K=g(!1),_=g([]),y=g("");le(async()=>{await V(),A()});async function V(){const{data:o}=await I.detailKemasan({code:N.params.code,level:"2",reception_id:N.params.id});i.value=o}async function A(){var t,d,c;const{data:o}=await I.listItemKemas(i.value.id,{limit:(c=(d=(t=i.value)==null?void 0:t.serialize)==null?void 0:d.maximum)!=null?c:10});console.log({data:o}),_.value=o.list}async function F(o){var d,c,b,m;if(!o){r.error("Kode packing tidak boleh kosong");return}const{data:t}=await I.detailItem({code:o,reception_detail_id:i.value.id}).catch(p=>{let k=p.message;throw p.response.data&&(k=p.response.data.message),r.error(k),p}).finally(()=>{y.value=""});if(((c=(d=i.value)==null?void 0:d.serialize)==null?void 0:c.maximum)<=_.value.length){r.error("Kemasan penuh"),v.value=!1;return}if(t.status!="printed"){r.error("Label item belum tercetak");return}if(t.is_packed){r.error("Item sudah dikemas (items packed)");return}_.value.findIndex(p=>p.id==t.id)==-1?(r.success("Item berhasil ditambahkan"),_.value.push(t),((m=(b=i.value)==null?void 0:b.serialize)==null?void 0:m.maximum)==_.value.length&&(v.value=!1)):r.warning("Item sudah ditambahkan sebelumnya")}function H(o,t){_.value.splice(t,1)}async function R(){$.value=!0,await I.kemasItem({reception_detail_id:i.value.id,ids:_.value.map(o=>o.id)}).catch(o=>{let t=o.message;o.response.data&&(t=o.response.data.message),r.error(t)}).finally(()=>{$.value=!1}),r.success("Item berhasil dikemas"),z.push({name:"produksi-pengemasan-id"})}function U(){z.push({name:"produksi-pengemasan-id"})}return(o,t)=>{const d=re,c=ce,b=me,m=de,p=pe,k=fe,Q=ge,C=ve,P=ke,h=ye,q=be,G=he,w=we,O=Se,T=Ie,W=ee,J=Z,X=Y;return L(),j(D,null,[e(m,{vertical:"",size:24,style:{padding:"1rem"}},{default:n(()=>[e(m,{vertical:"",size:0},{default:n(()=>[e(d,{style:{"margin-bottom":"0"}},{default:n(()=>[s(" Packing Level 2")]),_:1}),e(b,null,{default:n(()=>[e(c,{onClick:t[0]||(t[0]=a=>o.$router.push("/pengemasan"))},{default:n(()=>[s("Pengemasan")]),_:1}),e(c,{onClick:t[1]||(t[1]=a=>o.$router.push({name:"produksi-pengemasan-id",params:{id:o.$route.params.id}}))},{default:n(()=>[s("Detail Pengemasan")]),_:1}),e(c,null,{default:n(()=>[s("Packing Level 2")]),_:1})]),_:1})]),_:1}),e(G,{cols:"2","item-responsive":"",responsive:"screen","x-gap":16,"y-gap":16},{default:n(()=>[e(C,{span:"2 s:1"},{default:n(()=>[e(m,{vertical:"",size:0},{default:n(()=>[e(d,{style:{"margin-bottom":"0"}},{default:n(()=>{var a;return[s(" Kode Level 2: "+f((a=l(i))==null?void 0:a.code),1)]}),_:1}),e(p,{style:{"margin-bottom":"0"}},{default:n(()=>{var a,u;return[s(" Kode PK: "+f((u=(a=l(i))==null?void 0:a.reception)==null?void 0:u.pk_id),1)]}),_:1}),e(k,{style:{"margin-bottom":"0"}},{default:n(()=>{var a,u,S;return[s(f((S=(u=(a=l(i))==null?void 0:a.reception)==null?void 0:u.product)==null?void 0:S.long_name),1)]}),_:1}),e(k,{style:{"margin-bottom":"0"}},{default:n(()=>[e(Q,{strong:""},{default:n(()=>[s("Packer: ")]),_:1}),s(" Syihab ")]),_:1})]),_:1})]),_:1}),e(C,{span:"2 s:1"},{default:n(()=>[e(m,{justify:"end"},{default:n(()=>[e(h,{type:"warning",onClick:t[2]||(t[2]=a=>v.value=!0)},{default:n(()=>[e(P,{component:l($e)},null,8,["component"]),s(" Scan ID ")]),_:1})]),_:1})]),_:1}),e(C,{span:"2 s:1"},{default:n(()=>[e(q,{style:{width:"100%",padding:"1rem","justify-content":"center"},strong:""},{default:n(()=>[e(k,{style:{"text-align":"center"}},{default:n(()=>{var a,u;return[s(" Qty: "+f(l(_).length)+"/"+f((u=(a=l(i))==null?void 0:a.serialize)==null?void 0:u.maximum),1)]}),_:1})]),_:1})]),_:1})]),_:1}),e(W,{headers:l(E)},{default:n(()=>[(L(!0),j(D,null,ie(l(_),(a,u)=>(L(),ue(T,{key:a.id},{default:n(()=>[e(w,null,{default:n(()=>[s(f(u+1),1)]),_:2},1024),e(w,null,{default:n(()=>[s(f(a.code),1)]),_:2},1024),e(w,null,{default:n(()=>[s(f(a.reception.batch_number),1)]),_:2},1024),e(w,null,{default:n(()=>[e(O,{trigger:"click",options:l(M),onSelect:S=>H(S,u)},{default:n(()=>[e(h,{bordered:!1,circle:""},{default:n(()=>[e(P,{component:l(Ke)},null,8,["component"])]),_:1})]),_:2},1032,["options","onSelect"])]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["headers"]),e(m,{justify:"center"},{default:n(()=>[e(h,{loading:l($),type:"primary",onClick:R},{default:n(()=>[s("Simpan")]),_:1},8,["loading"])]),_:1})]),_:1}),e(J,{show:l(K),"onUpdate:show":t[3]||(t[3]=a=>x(K)?K.value=a:null),title:"Selamat",subtitle:`${l(_).length} Item telah terkemas`},{default:n(()=>[e(m,{justify:"center"},{default:n(()=>[e(h,{type:"primary",onClick:U},{default:n(()=>[s("Selesai")]),_:1})]),_:1})]),_:1},8,["show","subtitle"]),_e("",!0),e(X,{show:l(v),"onUpdate:show":t[5]||(t[5]=a=>x(v)?v.value=a:null),code:l(y),"onUpdate:code":t[6]||(t[6]=a=>x(y)?y.value=a:null),onScanned:F,title:"Packing Level 1"},null,8,["show","code"])],64)}}});typeof B=="function"&&B(Ce);export{Ce as default};
