import{_ as be}from"./t-feedback.vue_vue_type_script_setup_true_lang.83eb0b14.js";import{_ as ke}from"./t-not-granted.vue_vue_type_script_setup_true_lang.a30cf979.js";import{_ as ye}from"./t-loading.vue_vue_type_script_setup_true_lang.71bf4981.js";import{d as we,u as xe,E as Ce,e as De,r as c,f as Se,aF as U,a1 as Pe,p as Te,o as u,c as _,a as l,k as a,w as o,q as f,i as e,h as w,N as $,j as N,F as x,g as H,t as h,ah as B,S as Ae,Q as O,af as Ue,am as $e,an as Ne,K as Be,v as Ee,ak as Me,a7 as Re,H as Fe,a8 as Ge,ab as Ie,a9 as Ve,y as ze,aa as He,ag as Oe}from"./index.21c0d750.js";import{c as C}from"./constant.549d5c21.js";import{m as W}from"./master-user.75b9491b.js";import{m as We}from"./master-warehouse.353b4b3b.js";import{_ as Le}from"./t-modal-reset-password.vue_vue_type_script_setup_true_lang.ffba3032.js";import{A as je}from"./Add.4f3b52cf.js";import{E as Je}from"./EllipsisVertical.56989e7a.js";import{S as Ke}from"./SettingsOutline.9ab700f4.js";import{P as qe}from"./Pencil.0b65f5de.js";import{T as Qe}from"./Trash.4f4f705c.js";import{C as Xe}from"./CheckmarkCircleOutline.8fddcae1.js";import{H as Ye}from"./HelpCircleOutline.a54a41ed.js";import"./AlertCircleOutline.19cf574c.js";import"./getSuperholdingId.94511ad9.js";import"./getHoldingId.48f570fc.js";import"./getCompanyId.7d0eb93b.js";const Ze={class:"body-tnt"},et={class:"card-tnt"},tt={class:"table-tnt"},at=l("thead",null,[l("tr",null,[l("th",{style:{"text-align":"center"}},"No"),l("th",null,"Username"),l("th",null,"Nama Driver"),l("th",null,"Jabatan"),l("th",null,"Plant/Cabang"),l("th",{style:{"text-align":"center"}},"Status"),l("th",{style:{"text-align":"center"}},"Aksi")])],-1),nt={"data-label":"No",style:{"text-align":"center"}},st={"data-label":"Username"},ot={"data-label":"Nama Driver"},lt={"data-label":"Jabatan"},it={"data-label":"Plant/Cabang"},rt={"data-label":"Status",style:{"text-align":"center"}},ut={"data-label":"Aksi",style:{"text-align":"center"}},ct={key:1},dt=l("td",{colspan:"8",style:{"text-align":"center"}}," Belum ada data tersedia ",-1),_t=[dt],pt={class:"table-footer"},Et=we({__name:"index",setup(mt){const L=xe(),E=Ce(),j=De.getAuth(),v=c(!0),g=c(!1),b=c({}),r=c({search:"",sort:"desc",sort_field:"created_at",page:1,limit:10,user_type:"driver",status:null,plant:null}),J=c([{label:"Aktif",value:1},{label:"Tidak Aktif",value:0}]),p=c({id:"",name:""}),D=c([]),P=s=>()=>O($,null,{default:()=>O(s)});Se(async()=>{K(),U.isGranted(C.accessPrivileges.driver+".list")&&(await m(),Q())});function K(){j.xxtype==="5up3r4dm1n"&&D.value.unshift({label:"Reset Password",key:"reset-password",icon:P(Ke)}),U.isGranted(C.accessPrivileges.driver+".update")&&D.value.push({label:"Edit Data",key:"edit",icon:P(qe)}),U.isGranted(C.accessPrivileges.driver+".delete")&&D.value.push({label:"Hapus Data",key:"delete",icon:P(Qe)})}async function q(s){s&&(r.value.status=s),m()}async function m(){v.value=!0,await W.getUser(r.value).then(s=>{b.value=s.data,v.value=!1,n.value.show=!1}).catch(s=>{v.value=!1;const t=s.response.data;E.error(t.message)})}const M=c([]);async function Q(){v.value=!0,We.getWarehouse({limit:100}).then(s=>{s.data.list.forEach(t=>{M.value.push({label:t.name,value:t.id})})}),v.value=!1}async function X(s){s&&(r.value.plant=s),m()}const R=c(0);function Y(){r.value.page=1,clearTimeout(R.value),R.value=setTimeout(function(){m()},600)}function Z(s){r.value.page=1,r.value.limit=s,m()}function ee(){g.value=!g.value}function te(s,t,S){switch(s){case"edit":L.push({path:`/setting/master-driver/update/${t}`});break;case"delete":p.value.id=t,p.value.name=S,oe();break;case"reset-password":p.value.id=t,p.value.name=S,ee();break}}function ae(){k.value=!0,W.deleteUser(p.value.id).then(()=>{n.value.show=!1,setTimeout(()=>{se(),k.value=!1},300)}).catch(s=>{k.value=!1;const t=s.response.data;E.error(t.message)})}const k=c(!1),n=c({show:c(!1),type:"",icon:Pe(),iconColor:"",hideIcon:!1,title:"",subtitle:""});function ne(){n.value.show=!1}function se(){n.value.type="success",n.value.icon=Xe,n.value.iconColor="#219653",n.value.title="Berhasil",n.value.subtitle="Anda berhasil menghapus data driver",n.value.show=!0}function oe(){n.value.type="delete",n.value.icon=Ye,n.value.iconColor="#EB5757",n.value.title="Perhatian",n.value.subtitle=`Apakah Anda yakin untuk menghapus ${p.value.name} ?`,n.value.show=!0}return(s,t)=>{const S=Ue,le=$e,ie=Ne,y=Be,re=Te("router-link"),F=Ee,ue=Me,T=Re,G=Fe,ce=Ge,de=ye,I=Ie,_e=Ve,pe=ze,me=He,fe=Oe,ve=ke,he=be;return u(),_(x,null,[l("div",Ze,[a(S,{style:{"margin-bottom":"4px"}},{default:o(()=>[f("Master Driver")]),_:1}),a(ie,null,{default:o(()=>[a(le,null,{default:o(()=>[f("Master Driver")]),_:1})]),_:1}),l("div",et,[s.$filters.isGranted(e(C).accessPrivileges.driver+".create")?(u(),w(F,{key:0},{default:o(()=>[a(re,{to:"/setting/master-driver/create/1",class:"text-decoration-none"},{default:o(()=>[a(y,{color:"#219653",class:"button-tnt"},{default:o(()=>[a(e($),{component:e(je)},null,8,["component"]),f(" Tambah Driver ")]),_:1})]),_:1})]),_:1})):N("",!0),s.$filters.isGranted(e(C).accessPrivileges.driver+".list")?(u(),_(x,{key:1},[a(ce,{gutter:"16",style:{"margin-top":"24px"}},{default:o(()=>[a(T,{span:6},{default:o(()=>[a(ue,{value:e(r).search,"onUpdate:value":t[0]||(t[0]=i=>e(r).search=i),onKeyup:Y,placeholder:"Cari nama Driver"},null,8,["value"])]),_:1}),a(T,{span:6},{default:o(()=>[a(G,{placeholder:"Status",options:e(J),clearable:"",value:e(r).status,"onUpdate:value":[t[1]||(t[1]=i=>e(r).status=i),t[2]||(t[2]=i=>q(i))],style:{"max-width":"100%"}},null,8,["options","value"])]),_:1}),a(T,{span:6},{default:o(()=>[a(G,{placeholder:"Plant/Cabang",options:e(M),clearable:"",style:{"max-width":"100%"},value:e(r).plant,"onUpdate:value":[t[3]||(t[3]=i=>e(r).plant=i),t[4]||(t[4]=i=>X(i))]},null,8,["options","value"])]),_:1})]),_:1}),l("div",tt,[e(v)?(u(),w(de,{key:0})):(u(),w(I,{key:1,"x-scrollable":""},{default:o(()=>[a(me,{"single-line":!1},{default:o(()=>{var i,V;return[at,l("tbody",null,[((V=(i=e(b))==null?void 0:i.list)==null?void 0:V.length)>0?(u(!0),_(x,{key:0},H(e(b).list,(d,z)=>(u(),_("tr",{key:z},[l("td",nt,h(e(r).limit*(e(r).page-1)+(z+1)),1),l("td",st,h(d.username),1),l("td",ot,h(d.name),1),l("td",lt,h(d.position),1),l("td",it,[a(I,{style:{"max-height":"100px"}},{default:o(()=>[(u(!0),_(x,null,H(d.warehouses,(A,ge)=>(u(),_("div",{key:ge},h(A.name),1))),128))]),_:2},1024)]),l("td",rt,[a(_e,{bordered:!1,type:d.status.value===1?"success":"error"},{default:o(()=>[f(h(d.status.label=="active"?"Aktif":"Tidak Aktif"),1)]),_:2},1032,["type"])]),l("td",ut,[a(pe,{placement:"bottom-end",options:e(D),"show-arrow":!0,onSelect:A=>te(A,d.id,d.name)},{default:o(()=>[a(y,{tertiary:""},{icon:o(()=>[a(e($),null,{default:o(()=>[a(e(Je))]),_:1})]),_:1})]),_:2},1032,["options","onSelect"])])]))),128)):(u(),_("tr",ct,_t))])]}),_:1})]),_:1})),l("div",pt,[a(fe,{page:e(r).page,"onUpdate:page":[t[5]||(t[5]=i=>e(r).page=i),m],"page-count":e(b).total_page,"page-slot":10,"show-size-picker":e(b).total_data>10,"page-sizes":[10,20,30,40,50],"onUpdate:pageSize":Z},null,8,["page","page-count","show-size-picker"])])])],64)):(u(),w(ve,{key:2}))])]),a(he,{show:e(n).show,"onUpdate:show":t[6]||(t[6]=i=>e(n).show=i),icon:e(n).icon,"icon-color":e(n).iconColor,"hide-icon":e(n).hideIcon,title:e(n).title,subtitle:e(n).subtitle},{default:o(()=>[a(F,{justify:"center"},{default:o(()=>[e(n).type=="success"?(u(),w(y,{key:0,color:"#828282",class:"button-tnt",onClick:B(m,["prevent"])},{default:o(()=>[f(" Tutup ")]),_:1},8,["onClick"])):N("",!0),e(n).type=="delete"?(u(),_(x,{key:1},[a(y,{loading:e(k),color:"#828282",class:"button-tnt",onClick:B(ne,["prevent"])},{default:o(()=>[f(" Tidak ")]),_:1},8,["loading","onClick"]),a(y,{loading:e(k),color:"#EB5757",class:"button-tnt",style:{"padding-left":"25px","padding-right":"25px"},onClick:B(ae,["prevent"])},{default:o(()=>[f(" Iya ")]),_:1},8,["loading","onClick"])],64)):N("",!0)]),_:1})]),_:1},8,["show","icon","icon-color","hide-icon","title","subtitle"]),a(Le,{show:e(g),"onUpdate:show":t[7]||(t[7]=i=>Ae(g)?g.value=i:null),user_id:e(p).id},null,8,["show","user_id"])],64)}}});export{Et as default};
