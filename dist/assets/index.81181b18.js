import{_ as we}from"./t-feedback.vue_vue_type_script_setup_true_lang.83eb0b14.js";import{_ as Ue}from"./t-not-granted.vue_vue_type_script_setup_true_lang.a30cf979.js";import{_ as xe}from"./t-loading.vue_vue_type_script_setup_true_lang.71bf4981.js";import{d as Ce,u as Te,E as Se,r,e as Pe,f as Ae,aF as D,Q as O,N,a1 as $e,p as De,o as c,c as m,a as o,k as a,w as l,q as h,i as e,h as w,j as R,F as U,g as W,t as g,ah as B,S as Ne,af as Re,am as Be,an as Ee,K as Me,v as Fe,ak as Ge,a7 as Ie,H as Ve,a8 as ze,ab as He,a9 as Oe,y as We,aa as Le,ag as je}from"./index.21c0d750.js";import{c as x}from"./constant.549d5c21.js";import{m as L}from"./master-user.75b9491b.js";import{m as Je}from"./master-warehouse.353b4b3b.js";import{a as qe}from"./hak-akses.99e628b7.js";import{_ as Ke}from"./t-modal-reset-password.vue_vue_type_script_setup_true_lang.ffba3032.js";import{A as Qe}from"./Add.4f3b52cf.js";import{E as Xe}from"./EllipsisVertical.56989e7a.js";import{S as Ye}from"./SettingsOutline.9ab700f4.js";import{P as Ze}from"./Pencil.0b65f5de.js";import{T as et}from"./Trash.4f4f705c.js";import{C as tt}from"./CheckmarkCircleOutline.8fddcae1.js";import{H as at}from"./HelpCircleOutline.a54a41ed.js";import"./AlertCircleOutline.19cf574c.js";import"./getSuperholdingId.94511ad9.js";import"./getHoldingId.48f570fc.js";import"./getCompanyId.7d0eb93b.js";const nt={class:"body-tnt"},st={class:"card-tnt"},ot={class:"table-tnt"},lt=o("thead",null,[o("tr",null,[o("th",{style:{"text-align":"center"}},"No"),o("th",null,"Username"),o("th",null,"Nama User"),o("th",null,"Jabatan"),o("th",null,"Plant/Cabang"),o("th",null,"Tipe User"),o("th",{style:{"text-align":"center"}},"Status"),o("th",{style:{"text-align":"center"}},"Aksi")])],-1),it={"data-label":"No",style:{"text-align":"center"}},ut={"data-label":"Username"},rt={"data-label":"Nama User"},ct={"data-label":"Jabatan"},dt={"data-label":"Plant/Cabang"},pt={"data-label":"Tipe User"},_t={"data-label":"Status",style:{"text-align":"center"}},mt={"data-label":"Aksi",style:{"text-align":"center"}},ft={key:1},ht=o("td",{colspan:"8",style:{"text-align":"center"}}," Belum ada data tersedia ",-1),gt=[ht],vt={class:"table-footer"},Vt=Ce({__name:"index",setup(yt){const j=Te(),E=Se(),p=r(!1),v=r({}),u=r({search:"",sort:"desc",sort_field:"created_at",page:1,limit:10,user_type:null,status:null,plant:null}),y=r(!1),C=r([]),J=Pe.getAuth();Ae(()=>{q(),D.isGranted(x.accessPrivileges.user+".list")&&(_(),Y(),Z())});function q(){J.xxtype==="5up3r4dm1n"&&C.value.unshift({label:"Reset Password",key:"reset-password",icon:P(Ye)}),D.isGranted(x.accessPrivileges.user+".edit")&&C.value.push({label:"Edit Data",key:"edit",icon:P(Ze)}),D.isGranted(x.accessPrivileges.user+".delete")&&C.value.push({label:"Hapus Data",key:"delete",icon:P(et)})}const K=r([{label:"Aktif",value:1},{label:"Tidak Aktif",value:0}]);async function Q(n){n&&(u.value.status=n),_()}async function X(n){n&&(u.value.user_type=n),_()}async function _(){p.value=!0,await L.getUser(u.value).then(n=>{v.value=n.data,p.value=!1,s.value.show=!1}).catch(n=>{p.value=!1;const t=n.response.data;E.error(t.message)})}const M=r([]);async function Y(){p.value=!0,Je.getWarehouse({limit:100}).then(n=>{n.data.list.forEach(t=>{M.value.push({label:t.name,value:t.id})})}),p.value=!1}const F=r([]);async function Z(){p.value=!0,qe.getRoleType({limit:100}).then(n=>{n.data.list.forEach(t=>{F.value.push({key:t.key,value:t.key,label:t.name})})}),p.value=!1}async function ee(n){n&&(u.value.plant=n),_()}const G=r(0);function te(){u.value.page=1,clearTimeout(G.value),G.value=setTimeout(function(){_()},600)}function ae(n){u.value.page=1,u.value.limit=n,_()}const P=n=>()=>O(N,null,{default:()=>O(n)}),f=r({id:"",name:""});function ne(n,t,T){switch(n){case"edit":j.push({path:`/setting/master-user/update/${t}`});break;case"delete":f.value.id=t,f.value.name=T,ie();break;case"reset-password":f.value.id=t,f.value.name=T,ue();break}}function se(){b.value=!0,L.deleteUser(f.value.id).then(()=>{s.value.show=!1,setTimeout(()=>{le(),b.value=!1},300)}).catch(n=>{b.value=!1;const t=n.response.data;E.error(t.message)})}const b=r(!1),s=r({show:r(!1),type:"",icon:$e(),iconColor:"",hideIcon:!1,title:"",subtitle:""});function oe(){s.value.show=!1}function le(){s.value.type="success",s.value.icon=tt,s.value.iconColor="#219653",s.value.title="Berhasil",s.value.subtitle="Anda berhasil menghapus data user",s.value.show=!0}function ie(){s.value.type="delete",s.value.icon=at,s.value.iconColor="#EB5757",s.value.title="Perhatian",s.value.subtitle=`Apakah Anda yakin untuk menghapus ${f.value.name} ?`,s.value.show=!0}function ue(){y.value=!y.value}return(n,t)=>{const T=Re,re=Be,ce=Ee,k=Me,de=De("router-link"),I=Fe,pe=Ge,S=Ie,A=Ve,_e=ze,me=xe,V=He,fe=Oe,he=We,ge=Le,ve=je,ye=Ue,be=we;return c(),m(U,null,[o("div",nt,[a(T,{style:{"margin-bottom":"4px"}},{default:l(()=>[h("Master User")]),_:1}),a(ce,null,{default:l(()=>[a(re,null,{default:l(()=>[h("Master User")]),_:1})]),_:1}),o("div",st,[n.$filters.isGranted(e(x).accessPrivileges.user+".create")?(c(),w(I,{key:0},{default:l(()=>[a(de,{to:"/setting/master-user/create/1",class:"text-decoration-none"},{default:l(()=>[a(k,{color:"#219653",class:"button-tnt"},{default:l(()=>[a(e(N),{component:e(Qe)},null,8,["component"]),h(" Tambah User ")]),_:1})]),_:1})]),_:1})):R("",!0),n.$filters.isGranted(e(x).accessPrivileges.user+".list")?(c(),m(U,{key:1},[a(_e,{gutter:"16",style:{"margin-top":"24px"}},{default:l(()=>[a(S,{span:6},{default:l(()=>[a(pe,{value:e(u).search,"onUpdate:value":[t[0]||(t[0]=i=>e(u).search=i),te],clearable:"",placeholder:"Cari nama user"},null,8,["value"])]),_:1}),a(S,{span:6},{default:l(()=>[a(A,{placeholder:"Status",options:e(K),clearable:"",value:e(u).status,"onUpdate:value":[t[1]||(t[1]=i=>e(u).status=i),t[2]||(t[2]=i=>Q(i))],style:{"max-width":"100%"}},null,8,["options","value"])]),_:1}),a(S,{span:6},{default:l(()=>[a(A,{placeholder:"Tipe User",options:e(F),clearable:"",value:e(u).user_type,"onUpdate:value":[t[3]||(t[3]=i=>e(u).user_type=i),t[4]||(t[4]=i=>X(i))],style:{"max-width":"100%"}},null,8,["options","value"])]),_:1}),a(S,{span:6},{default:l(()=>[a(A,{placeholder:"Plant/Cabang",options:e(M),clearable:"",style:{"max-width":"100%"},value:e(u).plant,"onUpdate:value":[t[5]||(t[5]=i=>e(u).plant=i),t[6]||(t[6]=i=>ee(i))]},null,8,["options","value"])]),_:1})]),_:1}),o("div",ot,[e(p)?(c(),w(me,{key:0})):(c(),w(V,{key:1,"x-scrollable":""},{default:l(()=>[a(ge,{"single-line":!1},{default:l(()=>{var i,z;return[lt,o("tbody",null,[((z=(i=e(v))==null?void 0:i.list)==null?void 0:z.length)>0?(c(!0),m(U,{key:0},W(e(v).list,(d,H)=>(c(),m("tr",{key:H},[o("td",it,g(e(u).limit*(e(u).page-1)+(H+1)),1),o("td",ut,g(d.username),1),o("td",rt,g(d.name),1),o("td",ct,g(d.position),1),o("td",dt,[a(V,{style:{"max-height":"100px"}},{default:l(()=>[(c(!0),m(U,null,W(d.warehouses,($,ke)=>(c(),m("div",{key:ke},g($.name),1))),128))]),_:2},1024)]),o("td",pt,g(d.user_type.kind),1),o("td",_t,[a(fe,{bordered:!1,type:d.status.value===1?"success":"error"},{default:l(()=>[h(g(d.status.label=="active"?"Aktif":"Tidak Aktif"),1)]),_:2},1032,["type"])]),o("td",mt,[a(he,{placement:"bottom-end",options:e(C),"show-arrow":!0,onSelect:$=>ne($,d.id,d.name)},{default:l(()=>[a(k,{tertiary:""},{icon:l(()=>[a(e(N),null,{default:l(()=>[a(e(Xe))]),_:1})]),_:1})]),_:2},1032,["options","onSelect"])])]))),128)):(c(),m("tr",ft,gt))])]}),_:1})]),_:1})),o("div",vt,[a(ve,{page:e(u).page,"onUpdate:page":[t[7]||(t[7]=i=>e(u).page=i),_],"page-count":e(v).total_page,"page-slot":10,"show-size-picker":e(v).total_data>10,"page-sizes":[10,20,30,40,50],"onUpdate:pageSize":ae},null,8,["page","page-count","show-size-picker"])])])],64)):(c(),w(ye,{key:2}))])]),a(be,{show:e(s).show,"onUpdate:show":t[8]||(t[8]=i=>e(s).show=i),icon:e(s).icon,"icon-color":e(s).iconColor,"hide-icon":e(s).hideIcon,title:e(s).title,subtitle:e(s).subtitle},{default:l(()=>[a(I,{justify:"center"},{default:l(()=>[e(s).type=="success"?(c(),w(k,{key:0,color:"#828282",class:"button-tnt",onClick:B(_,["prevent"])},{default:l(()=>[h(" Tutup ")]),_:1},8,["onClick"])):R("",!0),e(s).type=="delete"?(c(),m(U,{key:1},[a(k,{loading:e(b),color:"#828282",class:"button-tnt",onClick:B(oe,["prevent"])},{default:l(()=>[h(" Tidak ")]),_:1},8,["loading","onClick"]),a(k,{loading:e(b),color:"#EB5757",class:"button-tnt",style:{"padding-left":"25px","padding-right":"25px"},onClick:B(se,["prevent"])},{default:l(()=>[h(" Iya ")]),_:1},8,["loading","onClick"])],64)):R("",!0)]),_:1})]),_:1},8,["show","icon","icon-color","hide-icon","title","subtitle"]),a(Ke,{show:e(y),"onUpdate:show":t[9]||(t[9]=i=>Ne(y)?y.value=i:null),user_id:e(f).id},null,8,["show","user_id"])],64)}}});export{Vt as default};
