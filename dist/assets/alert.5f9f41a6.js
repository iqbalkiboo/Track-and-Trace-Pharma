import{d as N,E as W,r as k,o as y,h as R,w as a,a as t,t as p,M as se,f as X,c as D,k as e,i as s,F as U,g as G,q as w,S as M,a5 as Y,a6 as Z,H as le,a7 as oe,a8 as re,s as ee,a9 as te,v as O,K as ue,aa as ae,ab as ne,L as J,ac as de,ad as _e,ae as pe,a2 as j,a3 as ie,b as ce,u as me,j as V,af as ge,ag as fe}from"./index.21c0d750.js";import{h as T}from"./moment.62d3fb0a.js";import{_ as ye}from"./t-loading.vue_vue_type_script_setup_true_lang.71bf4981.js";import{g as F}from"./getCompanyId.7d0eb93b.js";const be={style:{"overflow-x":"scroll","max-width":"800px"}},ve=N({__name:"t-modal-alert-api-req-and-res",props:{show:{type:Boolean,default:!1},data:{default:{}}},emits:["update:show"],setup(b){return W(),k({}),k(!1),(i,m)=>{const g=se;return y(),R(g,{"mask-closable":!1,show:i.show,preset:"card",role:"dialog",size:"huge",bordered:!1,style:{width:"800px","max-width":"100%","border-radius":"10px"},"onUpdate:show":m[0]||(m[0]=c=>i.$emit("update:show",c))},{default:a(()=>[t("div",be,[t("pre",null,p(i.data),1)])]),_:1},8,["show"])}}}),he=t("thead",null,[t("tr",null,[t("th",{style:{"text-align":"center"}},"No"),t("th",null,"Tanggal Dibuat"),t("th",{style:{"text-align":"center"}},"Tipe"),t("th",{style:{"text-align":"center"}},"Refrensi"),t("th",{style:{"text-align":"center"}},"Status"),t("th",null,"Path"),t("th",{style:{"text-align":"center"}},"Request"),t("th",{style:{"text-align":"center"}},"Response")])],-1),xe={style:{"text-align":"center"}},ke={style:{"text-align":"center"}},we={style:{"text-align":"center"}},qe={style:{"text-align":"center"}},De={key:1},$e=t("td",{colspan:"10",style:{"text-align":"center"}}," Belum ada data tersedia ",-1),Re=[$e],Be=N({__name:"t-alert-api",props:{data:{default:()=>({})},params:{default:()=>({})},isBtnLoading:{type:Boolean}},emits:["update:params","update:tab"],setup(b,{emit:i}){const m=b,g=k({}),c=k({}),o=k(!1),r=k([{label:"Sukses",value:"true"},{label:"Error",value:"false"}]);X(()=>{g.value=m.params});function _(v){i("update:tab",v)}function n(){g.value.status,i("update:params",g.value)}function h(v,u){o.value=!o.value,v==="req"&&(c.value=u.request),v==="res"&&(c.value=u.response)}return(v,u)=>{const x=Y,d=Z,l=le,B=oe,A=re,S=ee,L=te,C=O,E=ue,P=ae,H=ne,K=ve;return y(),D(U,null,[e(C,{vertical:"",size:14},{default:a(()=>[e(d,{type:"line",value:s(g).type,"onUpdate:value":[u[0]||(u[0]=q=>s(g).type=q),_],"tab-style":"border-radius: 10px"},{default:a(()=>[e(x,{disabled:m.isBtnLoading,name:"",tab:"Semua"},null,8,["disabled"]),e(x,{disabled:m.isBtnLoading,name:"dakota",tab:"Dakota"},null,8,["disabled"]),e(x,{disabled:m.isBtnLoading,name:"easygo",tab:"Easygo"},null,8,["disabled"]),e(x,{disabled:m.isBtnLoading,name:"bpom",tab:"Bpom"},null,8,["disabled"])]),_:1},8,["value"]),e(A,{gutter:"16"},{default:a(()=>[e(B,{span:6},{default:a(()=>[e(l,{placeholder:"Status",options:s(r),clearable:"",value:s(g).status,"onUpdate:value":[u[1]||(u[1]=q=>s(g).status=q),n],style:{"max-width":"100%"}},null,8,["options","value"])]),_:1})]),_:1}),e(H,{"x-scrollable":""},{default:a(()=>[e(P,{"single-line":!1,style:{"margin-top":"10px"}},{default:a(()=>{var q,f;return[he,t("tbody",null,[((q=m.data)==null?void 0:q.list.length)>0?(y(!0),D(U,{key:0},G((f=m.data)==null?void 0:f.list,($,Q)=>(y(),D("tr",{key:Q},[t("td",xe,p(v.params.limit*(v.params.page-1)+(Q+1)),1),t("td",null,p(s(T)($.CreatedAt).format("yyyy-MM-DD, h:mm:ss")),1),t("td",ke,p($.vendor),1),t("td",we,[e(C,{align:"center"},{default:a(()=>[e(S,null,{default:a(()=>{var z;return[w(p((z=$.reference)==null?void 0:z.id),1)]}),_:2},1024),e(L,{type:"info"},{default:a(()=>{var z;return[w(p((z=$.reference)==null?void 0:z.from),1)]}),_:2},1024)]),_:2},1024)]),t("td",qe,[e(L,{bordered:!1,type:$.status?"primary":"error",round:""},{default:a(()=>[w(p($.status?"success":"error"),1)]),_:2},1032,["type"])]),t("td",null,p($.endpoint),1),t("td",null,[e(C,{align:"center",justify:"center"},{default:a(()=>[e(E,{onClick:z=>h("req",$),type:"primary",strong:"",secondary:"",size:"tiny",text:""},{default:a(()=>[w("Show Request")]),_:2},1032,["onClick"])]),_:2},1024)]),t("td",null,[e(C,{align:"center",justify:"center"},{default:a(()=>[e(E,{onClick:z=>h("res",$),type:"primary",strong:"",secondary:"",size:"tiny",text:""},{default:a(()=>[w("Show Response")]),_:2},1032,["onClick"])]),_:2},1024)])]))),128)):(y(),D("tr",De,Re))])]}),_:1})]),_:1})]),_:1}),e(K,{show:s(o),"onUpdate:show":u[2]||(u[2]=q=>M(o)?o.value=q:null),data:s(c)},null,8,["show","data"])],64)}}}),ze=t("thead",null,[t("tr",null,[t("th",{style:{"text-align":"center"}},"No"),t("th",null,"No DO"),t("th",null,"Alamat Kejadian"),t("th",{style:{"text-align":"center"}},"Status DO"),t("th",null,"Kejadian"),t("th",null,"Plat Nomor"),t("th",null,"Tipe Data"),t("th",null,"Suhu"),t("th",null,"Tanggal Kejadian")])],-1),Me={style:{"text-align":"center"}},Ce={style:{"text-align":"center"}},Te={key:1},Ae=t("td",{colspan:"10",style:{"text-align":"center"}}," Belum ada data tersedia ",-1),Se=[Ae],Ue=N({__name:"t-log-tracker-table",props:{data:{default:()=>({})},params:{default:()=>({})}},setup(b){const i=b;return(m,g)=>{const c=te,o=ae,r=ne,_=J,n=O;return y(),R(n,{vertical:"",size:18},{default:a(()=>[e(_,{"content-style":{padding:"15px",backgroundColor:"#eee",borderRadius:"10px"},style:{"border-radius":"10px"}},{default:a(()=>[e(r,{"x-scrollable":""},{default:a(()=>[e(o,{"single-line":!1},{default:a(()=>{var h,v;return[ze,t("tbody",null,[((h=i.data)==null?void 0:h.list.length)>0?(y(!0),D(U,{key:0},G((v=i.data)==null?void 0:v.list,(u,x)=>(y(),D("tr",{key:x},[t("td",Me,p(m.params.limit*(m.params.page-1)+(x+1)),1),t("td",null,p(u.do_code),1),t("td",null,p(u.address),1),t("td",Ce,[e(c,{bordered:!1,type:"primary",round:""},{default:a(()=>[w(p(u.description_do_status),1)]),_:2},1024)]),t("td",null,p(u.description_data_type),1),t("td",null,p(u.plate_number),1),t("td",null,p(u.data_type),1),t("td",null,p(u.current_temperature),1),t("td",null,p(s(T)(u.even_date).format("yyyy-MM-DD HH:mm:ss")),1)]))),128)):(y(),D("tr",Te,Se))])]}),_:1})]),_:1})]),_:1})]),_:1})}}}),Ne=N({__name:"t-log-alert-card",props:{data:{default:()=>({})}},setup(b){const i=b;function m(g){const c=T(new Date).format("yyyy-MM-DD"),o=T(g).format("yyyy-MM-DD"),r=T(o).diff(c,"days");return r>0?r:"Invalid date"}return(g,c)=>{const o=ee,r=de,_=_e,n=pe,h=J,v=O;return y(),R(v,{vertical:"",size:18},{default:a(()=>[(y(!0),D(U,null,G(i.data.list,(u,x)=>(y(),R(h,{"content-style":{padding:"15px",backgroundColor:"#eee",borderRadius:"10px"},style:{"border-radius":"10px"},key:x},{default:a(()=>[e(n,{cols:"3","item-responsive":"",responsive:"screen"},{default:a(()=>[e(_,{span:"3"},{default:a(()=>[e(r,{style:{margin:"0 0 8px"}},{default:a(()=>[e(o,{strong:"",style:{"font-size":"14px"}},{default:a(()=>{var d;return[w(p((d=u.product)==null?void 0:d.long_name),1)]}),_:2},1024)]),_:2},1024)]),_:2},1024),e(_,{span:"3 s:2"},{default:a(()=>[e(n,{"x-gap":8,"y-gap":8,cols:"2","item-responsive":"",responsive:"screen"},{default:a(()=>[e(_,{span:"2 s:1"},{default:a(()=>[e(r,{style:{margin:"0"}},{default:a(()=>[e(o,null,{default:a(()=>[w(" Batch Number : "+p(u.batch_number),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(_,{span:"2 s:1"},{default:a(()=>[e(r,{style:{margin:"0"}},{default:a(()=>[e(o,null,{default:a(()=>{var d;return[w(" Day Before Expired : "+p(u?g.$filters.toNumber(m((d=u.date)==null?void 0:d.expired_date)):""),1)]}),_:2},1024)]),_:2},1024)]),_:2},1024),e(_,{span:"2 s:1"},{default:a(()=>[e(r,{style:{margin:"0"}},{default:a(()=>[e(o,null,{default:a(()=>{var d;return[w(" Expired Date : "+p(s(T)((d=u.date)==null?void 0:d.expired_date).format("yyyy-MM-DD")),1)]}),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})}}});j.interceptors.request.use(ie.auth);const I={async getAlert(b){return b.company_id=F,(await j.get("/penerimaan/v1/list",{params:b})).data},async getAlertResponseApi(b){return b.company_id=F,(await j.get("/api-partial/v1/api-log/list",{params:b})).data},async getAlertTracker(b){return b.company_id=F,(await j.get("/log/v1/vehicle/list",{params:b})).data}},Le={class:"body-tnt"},Ee={style:{display:"flex","justify-content":"center"}},Ke=N({__name:"alert",setup(b){const i=ce(),m=me(),g=W(),c=k(!0),o=k(!1),r=k({}),_=k(""),n=k({status:null,sort:"desc",sort_field:"created_at",q:"",type:"",page:1,limit:10});X(()=>{_.value="produksi",h()});async function h(){if(i.query.tab&&(_.value=String(i.query.tab)),c.value=!0,o.value=!0,_.value=="produksi")n.value.is_expired=1,await I.getAlert(n.value).then(d=>{r.value=d.data,c.value=!1,o.value=!1}).catch(d=>{c.value=!1,o.value=!1;const l=d.response.data;g.error(l.message)});else{delete n.value.is_expired;const d=i.query["tab-child"];n.value.type=d,_.value==="tracker"&&(delete n.value.q,delete n.value.status,delete n.value.type,delete n.value.sort_field,await I.getAlertTracker(n.value).then(l=>{r.value=l.data,c.value=!1,o.value=!1}).catch(l=>{c.value=!1,o.value=!1;const B=l.response.data;g.error(B.message)})),_.value==="api"&&(n.value.q=d,n.value.sort="created_at",n.value.dir="desc",await I.getAlertResponseApi(n.value).then(l=>{r.value=l.data,c.value=!1,o.value=!1}).catch(l=>{c.value=!1,o.value=!1;const B=l.response.data;g.error(B.message)}))}}function v(d){m.push({query:{tab:d}})}function u(d){n.value.page=1,n.value.limit=d,h()}function x(d){const l=i.query.tab;m.push({query:{tab:l,"tab-child":d}})}return(d,l)=>{const B=ge,A=O,S=Y,L=Z,C=ye,E=Ne,P=Ue,H=Be,K=fe,q=J;return y(),D("div",Le,[e(A,{vertical:"",size:14},{default:a(()=>[e(A,{vertical:"",size:0},{default:a(()=>[e(B,{style:{"margin-bottom":"0"}},{default:a(()=>[w("Alert")]),_:1})]),_:1}),e(L,{type:"bar",value:s(_),"onUpdate:value":[l[0]||(l[0]=f=>M(_)?_.value=f:null),v],"tab-style":"border-radius: 10px"},{default:a(()=>[e(S,{disabled:s(o),name:"produksi",tab:"Produksi"},null,8,["disabled"]),e(S,{disabled:s(o),name:"tracker",tab:"Tracker"},null,8,["disabled"]),e(S,{disabled:s(o),name:"api",tab:"Api"},null,8,["disabled"])]),_:1},8,["value"]),e(q,{style:{"border-radius":"10px"}},{default:a(()=>[e(A,{vertical:"",size:18},{default:a(()=>[s(c)?(y(),R(C,{key:0})):(y(),D(U,{key:1},[s(_)==="produksi"?(y(),R(E,{key:0,data:s(r),"onUpdate:data":l[1]||(l[1]=f=>M(r)?r.value=f:null)},null,8,["data"])):V("",!0),s(_)==="tracker"?(y(),R(P,{key:1,data:s(r),"onUpdate:data":l[2]||(l[2]=f=>M(r)?r.value=f:null),params:s(n),"onUpdate:params":l[3]||(l[3]=f=>M(n)?n.value=f:null)},null,8,["data","params"])):V("",!0),s(_)==="api"?(y(),R(H,{key:2,data:s(r),"onUpdate:data":l[4]||(l[4]=f=>M(r)?r.value=f:null),params:s(n),"onUpdate:params":[l[5]||(l[5]=f=>M(n)?n.value=f:null),h],"alert-api-tab":s(n),"is-btn-loading":s(o),"onUpdate:tab":x},null,8,["data","params","alert-api-tab","is-btn-loading"])):V("",!0)],64)),t("div",Ee,[e(K,{page:s(n).page,"onUpdate:page":[l[6]||(l[6]=f=>s(n).page=f),h],"page-size":s(n).limit,"onUpdate:pageSize":[l[7]||(l[7]=f=>s(n).limit=f),u],"page-count":s(r).total_page,"page-slot":7,"show-size-picker":s(r).total_data>10,"page-sizes":[10,20,30,40,50]},null,8,["page","page-size","page-count","show-size-picker"])])]),_:1})]),_:1})]),_:1})])}}});export{Ke as default};
