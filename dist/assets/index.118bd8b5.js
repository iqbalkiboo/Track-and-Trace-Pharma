import{g as J,a as he,s as ve,b as be,c as ye}from"./reception.0ba4dd71.js";import{d as ae,r as _,o as f,h as x,w as a,k as e,q as l,t as i,c as k,F as q,g as Q,s as ke,v as te,L as we,H as Me,K as ne,M as Ne,b as Pe,u as Se,E as Ce,f as De,p as X,a as t,ah as Ie,i as Y,N as Z,j as $e,af as Be,am as Oe,an as ze,ak as xe,a9 as Re,y as je,aa as qe,ab as Le,ag as Qe,Q as ee}from"./index.21c0d750.js";import{_ as Ve}from"./t-scan-modal.vue_vue_type_script_setup_true_lang.af24c4ce.js";import{_ as Te}from"./t-loading.vue_vue_type_script_setup_true_lang.71bf4981.js";import{E as Ue}from"./EllipsisVertical.56989e7a.js";import{S as Ae}from"./SearchOutline.47b929a4.js";import{A as Ee}from"./AddOutline.a2e673de.js";import{L as Fe}from"./LocationOutline.22b247fa.js";import"./getCompanyId.7d0eb93b.js";const Ge=ae({__name:"t-manifest-modal",props:{show:{type:Boolean},data:{},loading:{type:Boolean}},emits:["update:show","hideModal","click:submit"],setup(V,{emit:w}){const r=V,C=_(!1),O=_(null),v=_(),b=_(0),D=_(1),I=_([]);function M(){b.value!=0?b.value=0:w("update:show",!1)}async function $(){b.value==0?(await N(),r.data.is_set_location?w("click:submit",{warehouse_building_id:v.value,is_set_location:r.data.is_set_location}):b.value=1):w("click:submit",{warehouse_building_id:v.value,is_set_location:r.data.is_set_location})}async function N(){var s,u,P;C.value=!0;const o=await J({limit:1,page:D.value,sort:"desc",sort_field:"created_at",company_id:""}),p=await J({limit:o.data.total_data,page:D.value,sort:"desc",sort_field:"created_at",warehouse_id:(P=(u=(s=r==null?void 0:r.data)==null?void 0:s.do)==null?void 0:u.destination)==null?void 0:P.id,company_id:""});C.value=!1,O.value=p.data,p.data.list.forEach(y=>{I.value.push({label:y.name,value:y.id})})}return(o,p)=>{const s=ke,u=te,P=we,y=Me,R=ne,L=Ne;return f(),x(L,{show:r.show,"onUpdate:show":p[3]||(p[3]=n=>o.$emit("update:show",n))},{default:a(()=>[e(P,{style:{width:"700px","--n-border-radius":"10px"},"content-style":"padding: 15px 20px 28px 20px;",bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{default:a(()=>[e(u,{vertical:""},{default:a(()=>[e(u,{vertical:"",align:"center",size:0},{default:a(()=>[e(u,{size:3},{default:a(()=>[e(s,null,{default:a(()=>[l(" ID Manifest : ")]),_:1}),e(s,null,{default:a(()=>{var n;return[l(i((n=o.data)==null?void 0:n.manifest.code),1)]}),_:1})]),_:1}),e(u,{size:3},{default:a(()=>[e(s,null,{default:a(()=>[l(" ID DO : ")]),_:1}),e(s,null,{default:a(()=>{var n;return[l(i((n=o.data)==null?void 0:n.do.code),1)]}),_:1})]),_:1}),e(u,{size:3},{default:a(()=>[e(s,null,{default:a(()=>[l(" Tujuan : ")]),_:1}),e(s,null,{default:a(()=>{var n,S;return[l(i(((S=(n=o.data)==null?void 0:n.do.destination)==null?void 0:S.name)||"-"),1)]}),_:1})]),_:1})]),_:1}),b.value==0?(f(),x(u,{key:0,vertical:""},{default:a(()=>[e(u,{size:0,vertical:""},{default:a(()=>[e(u,{size:2},{default:a(()=>[e(s,null,{default:a(()=>[l("Qty Packing : ")]),_:1}),e(s,null,{default:a(()=>{var n;return[l(i(o.$filters.toNumber((n=o.data)==null?void 0:n.total.packing)),1)]}),_:1})]),_:1}),e(u,{size:2},{default:a(()=>[e(s,null,{default:a(()=>[l("Qty SKU : ")]),_:1}),e(s,null,{default:a(()=>{var n;return[l(i(o.$filters.toNumber((n=o.data)==null?void 0:n.total.product)),1)]}),_:1})]),_:1}),e(u,{size:2},{default:a(()=>[e(s,null,{default:a(()=>[l("Qty Pesan : ")]),_:1}),e(s,null,{default:a(()=>{var n;return[l(i(o.$filters.toNumber((n=o.data)==null?void 0:n.total.qty)),1)]}),_:1})]),_:1})]),_:1}),e(u,{vertical:""},{default:a(()=>{var n,S;return[(f(!0),k(q,null,Q((S=(n=o.data)==null?void 0:n.products)!=null?S:[],h=>(f(),x(P,{key:h.id},{default:a(()=>[e(u,{vertical:"",size:0},{default:a(()=>[e(u,{size:3},{default:a(()=>[e(s,null,{default:a(()=>[l("Produk : ")]),_:1}),e(s,null,{default:a(()=>[l(i(h.name),1)]),_:2},1024)]),_:2},1024),e(u,{size:3},{default:a(()=>[e(s,null,{default:a(()=>[l("ID Produk : ")]),_:1}),e(s,null,{default:a(()=>[l(i(h.code),1)]),_:2},1024)]),_:2},1024),e(u,{size:3},{default:a(()=>[e(s,null,{default:a(()=>[l("Asal Produk : ")]),_:1}),e(s,null,{default:a(()=>[l(i(h.superholding.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]}),_:1})]),_:1})):(f(),x(u,{key:1,vertical:""},{default:a(()=>[e(y,{disabled:o.loading,options:I.value,value:v.value,"onUpdate:value":p[0]||(p[0]=n=>v.value=n),filterable:"",placeholder:"Pilih Warehouse"},null,8,["disabled","options","value"]),e(u)]),_:1})),e(u,{justify:"center"},{default:a(()=>[e(R,{disabled:o.loading||C.value,type:"primary",ghost:"",class:"button-tnt",onClick:p[1]||(p[1]=n=>M())},{default:a(()=>[l(" Batalkan ")]),_:1},8,["disabled"]),e(R,{loading:o.loading||C.value,type:"primary",class:"button-tnt",onClick:p[2]||(p[2]=n=>$())},{default:a(()=>[l(" Lanjutkan ")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])}}}),He={class:"body-tnt"},Ke={class:"card-tnt"},We={key:1,class:"table-tnt"},Je=t("thead",null,[t("tr",null,[t("th",{style:{"text-align":"center"}},"No"),t("th",null,"ID Manifest"),t("th",null,"NO GR"),t("th",null,"NO PO"),t("th",null,"ID DO"),t("th",null,"Produk"),t("th",null,"Qty Packing"),t("th",null,"Qty Pesan"),t("th",null,"Tujuan"),t("th",null,"Status"),t("th",null,"Aksi")])],-1),Xe={"data-label":"No",style:{"text-align":"center"}},Ye={"data-label":"ID Manifest"},Ze={"data-label":"NO GR"},ea={"data-label":"NO PO"},aa={"data-label":"ID DO"},ta={"data-label":"Produk"},na={"data-label":"Qty Packing"},la={"data-label":"Qty Pesan"},oa={"data-label":"Tujuan"},sa={"data-label":"Tujuan"},ua={"data-label":"Aksi"},ia={key:1},da=t("td",{colspan:"20",style:{"text-align":"center"}}," Belum ada data tersedia ",-1),_a=[da],ca={class:"table-footer"},wa=ae({__name:"index",setup(V){const w=Pe(),r=Se(),C=Ce(),O=_(!1),v=_(!1),b=_(""),D=_(!1),I=_(!1),M=_(!1),$=_(null),N=_(null),o=_({page:1,limit:10,sort:"created_at",dir:"desc"});De(()=>{w.query.page||r.replace({query:{page:1}}),o.value.page=parseInt(w.query.page),p()});async function p(){D.value=!0;const c=await he(o.value).finally(()=>{D.value=!1});$.value=c.data}function s(c){r.push({query:{...w.query,page:c}})}async function u(c){b.value="",I.value=!0;const d=await ve({manifest_code:c,company_id:""}).finally(()=>{I.value=!1,v.value=!0,h.value=!1}).catch(()=>{v.value=!1,h.value=!0});N.value=d.data,v.value=!0,h.value=!1,C.success("Data manifest ditemukan.")}async function P(c){var d,B,j;M.value=!0,await be({reception_id:(d=N.value)==null?void 0:d.id,company_id:""}).finally(()=>{M.value=!1}),M.value=!0,c.is_set_location||await ye({reception_id:(B=N.value)==null?void 0:B.id,warehouse_building_id:c.warehouse_building_id,company_id:""}).finally(()=>{M.value=!1}),r.push({name:"penerimaan-reception-id",params:{id:(j=N.value)==null?void 0:j.id}})}const y=c=>()=>ee(Z,null,{default:()=>ee(c)}),R=[{label:"Detail Data",key:"detail",icon:y(Ae)},{label:"Form Penerimaan",key:"form",icon:y(Ee)},{label:"Lacak Manifest",key:"lacak",icon:y(Fe)}];function L(c,d,B){switch(c){case"detail":r.push({name:"penerimaan-reception-id",params:{id:d}});break;case"form":r.push({name:"penerimaan-reception-id-form",params:{id:d}});break;case"lacak":r.push({path:`/lacak/manifest/${B}`});break}}function n(c){c.preventDefault(),O.value=!0}function S(){O.value=!1}const h=_(!1);function le(){h.value=!0}return(c,d)=>{var A,E;const B=Be,j=Oe,oe=ze,se=xe,ra=X("add"),T=ne,U=te,ue=Te,ie=Re,de=je,_e=qe,ce=Le,re=Qe,pe=X("modal-import-excel"),fe=Ve,me=Ge;return f(),k(q,null,[t("div",He,[e(B,{style:{"margin-bottom":"4px"}},{default:a(()=>[l("Penerimaan")]),_:1}),e(oe,null,{default:a(()=>[e(j,null,{default:a(()=>[l("Penerimaan")]),_:1})]),_:1}),t("div",Ke,[e(U,{align:"center",justify:"space-between"},{default:a(()=>[e(U,{align:"center"},{default:a(()=>[e(se,{placeholder:"Cari DO/Nama Product",style:{width:"400px","max-width":"100%"}}),$e("",!0)]),_:1}),e(T,{onClick:Ie(le,["prevent"]),class:"button-tnt",type:"primary"},{default:a(()=>[l("Scan Manifest")]),_:1},8,["onClick"])]),_:1}),D.value?(f(),x(ue,{key:0})):(f(),k("div",We,[e(ce,{"x-scrollable":""},{default:a(()=>[e(_e,{"single-line":!1},{default:a(()=>{var m,F,G;return[Je,t("tbody",null,[((F=(m=$.value)==null?void 0:m.list)==null?void 0:F.length)>0?(f(!0),k(q,{key:0},Q((G=$.value)==null?void 0:G.list,(g,ge)=>{var H,K,W;return f(),k("tr",{key:g.id},[t("td",Xe,i((o.value.page-1)*o.value.limit+ge+1),1),t("td",Ye,i((H=g.manifest)==null?void 0:H.code),1),t("td",Ze,i((K=g.finish_info)==null?void 0:K.gr_number),1),t("td",ea,i((W=g.do)==null?void 0:W.po_number),1),t("td",aa,i(g.do.code),1),t("td",ta,[t("ul",null,[(f(!0),k(q,null,Q(g.products,z=>(f(),k("li",{key:z.id},i(z.code)+" - "+i(z.name),1))),128))])]),t("td",na,i(g.total.packing),1),t("td",la,i(g.total.qty),1),t("td",oa,i(g.do.destination.name),1),t("td",sa,[e(ie,{bordered:!1,type:"success"},{default:a(()=>[l(i(g.status),1)]),_:2},1024)]),t("td",ua,[e(de,{placement:"bottom-end",options:R,onSelect:z=>L(z,g.id,g.manifest.id)},{default:a(()=>[e(T,{tertiary:""},{icon:a(()=>[e(Y(Z),null,{default:a(()=>[e(Y(Ue))]),_:1})]),_:1})]),_:2},1032,["onSelect"])])])}),128)):(f(),k("tr",ia,_a))])]}),_:1})]),_:1}),t("div",ca,[e(re,{page:o.value.page,"onUpdate:page":[d[0]||(d[0]=m=>o.value.page=m),d[1]||(d[1]=m=>s(m))],"page-count":(E=(A=$.value)==null?void 0:A.total_page)!=null?E:1,"page-slot":5},null,8,["page","page-count"])])]))])]),e(pe,{"is-show-modal":O.value,onHideModal:S},null,8,["is-show-modal"]),e(fe,{code:b.value,"onUpdate:code":d[2]||(d[2]=m=>b.value=m),show:h.value,"onUpdate:show":d[3]||(d[3]=m=>h.value=m),loading:I.value,title:"Scan Manifest",onScanned:u},null,8,["code","show","loading"]),e(me,{loading:M.value,show:v.value,"onUpdate:show":d[4]||(d[4]=m=>v.value=m),data:N.value,"onClick:submit":P},null,8,["loading","show","data"])],64)}}});export{wa as default};
