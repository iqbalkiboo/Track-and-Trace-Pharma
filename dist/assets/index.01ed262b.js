import{_ as _e}from"./t-feedback.vue_vue_type_script_setup_true_lang.83eb0b14.js";import{_ as pe}from"./t-loading.vue_vue_type_script_setup_true_lang.71bf4981.js";import{d as me,b as fe,u as he,E as ge,r as d,a1 as ye,f as be,p as ke,o as _,c as m,a as o,i as e,k as a,F as x,w as n,q as c,t as u,j as C,h as N,g as ve,ah as we,N as A,af as xe,a9 as Ce,v as Ne,s as Se,a7 as De,ac as qe,ar as Be,L as $e,a8 as ze,K as Ie,y as Oe,aa as Te,ab as Ee,Q as V}from"./index.21c0d750.js";import{h as K}from"./moment.62d3fb0a.js";import{s as I}from"./serialisasi-external.c8482290.js";import{_ as Me}from"./modal-input-building.vue_vue_type_script_setup_true_lang.cee62a3e.js";import{E as Pe}from"./EllipsisVertical.56989e7a.js";import{C as Fe}from"./CheckmarkCircleOutline.8fddcae1.js";import{S as j}from"./SearchOutline.47b929a4.js";import"./getCompanyId.7d0eb93b.js";import"./master-warehouse.353b4b3b.js";const Qe={class:"body-tnt"},Ae={key:0,class:"card-tnt"},Ve={class:"card-tnt"},Ke={class:"table-tnt",style:{"margin-top":"0"}},je=o("thead",null,[o("tr",null,[o("th",null,"No"),o("th",null,"Kode Produk"),o("th",null,"Nama Produk"),o("th",null,"Batch"),o("th",null,"Exp Date"),o("th",{style:{"text-align":"center"}},"Qty DO"),o("th",{style:{"text-align":"center"}},"Qty Terkonfirmasi"),o("th",{style:{"text-align":"center"}},"Aksi")])],-1),Le={"data-label":"No"},He={"data-label":"Kode Produk"},Ue={"data-label":"Nama Produk"},Ye={"data-label":"Batch"},Ge={"data-label":"Exp Date"},Je={"data-label":"Qty DO",style:{"text-align":"center"}},Re={"data-label":"Qty Terkonfirmasi",style:{"text-align":"center"}},We={"data-label":"Aksi",style:{"text-align":"center"}},Xe={key:1},Ze=o("td",{colspan:"8",style:{"text-align":"center"}}," Belum ada data tersedia ",-1),et=[Ze],tt={class:"bottom-action-button"},at={class:"action-item"},ft=me({__name:"index",setup(nt){const S=fe(),D=he(),q=ge(),k=d(!0),p=d(!1),s=d({}),B=d({}),v=d({search:"",status:"",sort:"desc",dir:"created_at",page:1,limit:1e4});d({});const L=d();L.value={reason:{required:!0,message:"Alasan tidak boleh kosong",trigger:["input","blur"]}};const f=d({show:!1,form:{},loading:p}),l=d({show:d(!1),type:"",icon:ye(),iconColor:"",hideIcon:!1,title:"",subtitle:"",align:"center"}),O=i=>()=>V(A,null,{default:()=>V(i)}),H=[{label:"Scan",key:"scan",icon:O(j)}],U=[{label:"Detail",key:"detail",icon:O(j)}];be(()=>{T()});async function T(){k.value=!0,await Y(),await G(),k.value=!1}async function Y(){const i=S.params.id;await I.getDetailSerialize(i).then(r=>{s.value=r.data}).catch(r=>{const h=r.response.data;q.error(h.message)})}async function G(){v.value.import_serialization_id=S.params.id,await I.getSerializeProduct(v.value).then(i=>{B.value=i.data}).catch(i=>{const r=i.response.data;q.error(r.message)})}d(0);function J(i){D.push({name:"penerimaan-serialisasi-external-id-detail-produk",query:{product_id:i}})}function R(i,r){switch(i){case"scan":D.push({name:"penerimaan-serialisasi-external-id-scan",query:{product_id:r}});break;case"detail":D.push({name:"penerimaan-serialisasi-external-id-scan",query:{product_id:r}});break}}function W(){(s==null?void 0:s.value.total_current_qty)<(s==null?void 0:s.value.total_qty)?Z():E()}function E(){f.value.show=!0,$()}function M(){f.value.show=!1}function X(){p.value=!0;const i={import_serialization_id:S.params.id,warehouse_building_id:f.value.form.building};I.approveSerializeExternal(i).then(()=>{p.value=!1,M(),T(),f.value.form={},setTimeout(()=>{l.value.title="Berhasil Approve",l.value.subtitle=s.value.vendor_no+" berhasil diapprove",ee()},300)}).catch(r=>{p.value=!1;const h=r.response.data;q.error(h.message)})}function Z(){l.value.type="confirm",l.value.hideIcon=!0,l.value.title="Konfirmasi",l.value.subtitle=`Anda belum melakukan scan pada semua serialisasi. Terima ${s==null?void 0:s.value.total_current_qty} serialisasi saja?`,l.value.show=!0}function ee(){l.value.type="success",l.value.hideIcon=!1,l.value.iconColor="#219653",l.value.icon=Fe,l.value.show=!0}function $(){l.value.show=!1}return(i,r)=>{var F;const h=pe,te=xe,ae=Ce,w=Ne,z=Se,P=De,ne=qe,oe=Be,se=$e,le=ze,g=Ie,ie=Oe,re=Te,ce=Ee,ue=ke("router-link"),de=_e;return _(),m(x,null,[o("div",Qe,[e(k)?(_(),m("div",Ae,[a(h)])):(_(),m(x,{key:1},[a(w,{justify:"space-between"},{default:n(()=>[a(te,{style:{"margin-bottom":"0","margin-top":"5px"}},{default:n(()=>[c("No DO Vendor : "+u(e(s).vendor_no),1)]),_:1}),a(ae,{round:"",bordered:!1,strong:"",type:e(s).status==="complete"?"success":e(s).status==="pending"?"warning":e(s).status==="cancel"?"error":"default",size:"large"},{default:n(()=>[c(u(i.$filters.toStatus(e(s).status)),1)]),_:1},8,["type"])]),_:1}),a(le,{gutter:"16",style:{"margin-top":"14px"}},{default:n(()=>[a(P,{span:12},{default:n(()=>[a(w,{vertical:"",size:0},{default:n(()=>[a(z,null,{default:n(()=>[c("Tanggal DO : "+u(e(K)(e(s).created_at).format("yyyy-MM-DD")),1)]),_:1}),a(z,null,{default:n(()=>[c("No PO : "+u(e(s).code),1)]),_:1})]),_:1})]),_:1}),a(P,{span:12},{default:n(()=>[a(w,{vertical:"",size:10,align:"end"},{default:n(()=>[a(se,{style:{width:"250px","text-align":"center","border-radius":"15px",background:"#eee"}},{default:n(()=>[a(ne,{style:{"font-size":"14px"}},{default:n(()=>[c("Qty Terkonfirmasi/Qty DO :")]),_:1}),a(oe,{style:{"margin-top":"0","margin-bottom":"0"}},{default:n(()=>{var t,y;return[c(u(i.$filters.toNumber((t=e(s))==null?void 0:t.total_current_qty)+"/"+i.$filters.toNumber((y=e(s))==null?void 0:y.total_qty)),1)]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o("div",Ve,[C("",!0),o("div",Ke,[e(k)?(_(),N(h,{key:0})):(_(),N(ce,{key:1,"x-scrollable":""},{default:n(()=>[a(re,{"single-line":!1},{default:n(()=>[je,o("tbody",null,[e(B).list.length>0?(_(!0),m(x,{key:0},ve(e(B).list,(t,y)=>{var Q;return _(),m("tr",{key:y},[o("td",Le,u(e(v).limit*(e(v).page-1)+(y+1)),1),o("td",He,[a(z,{type:"primary",strong:"",style:{cursor:"pointer","text-decoration":"underline"},onClick:we(b=>J(t==null?void 0:t.id),["prevent"])},{default:n(()=>{var b;return[c(u((b=t==null?void 0:t.product)==null?void 0:b.item_code),1)]}),_:2},1032,["onClick"])]),o("td",Ue,u((Q=t==null?void 0:t.product)==null?void 0:Q.short_name),1),o("td",Ye,u(i.$filters.isEmpty(t==null?void 0:t.batch)),1),o("td",Ge,u(e(K)(t==null?void 0:t.expired_date).format("yyyy-MM-DD")),1),o("td",Je,u(i.$filters.toNumber(t==null?void 0:t.qty)),1),o("td",Re,u(i.$filters.toNumber(t==null?void 0:t.current_qty)),1),o("td",We,[a(ie,{placement:"bottom-end",options:t.is_full?U:H,onSelect:b=>R(b,t==null?void 0:t.id)},{default:n(()=>[a(g,{tertiary:""},{icon:n(()=>[a(e(A),null,{default:n(()=>[a(e(Pe))]),_:1})]),_:1})]),_:2},1032,["options","onSelect"])])])}),128)):(_(),m("tr",Xe,et))])]),_:1})]),_:1}))])])],64)),o("div",tt,[o("div",at,[a(ue,{to:{name:"penerimaan-serialisasi-external"},class:"text-decoration-none"},{default:n(()=>[a(g,{loading:e(p),color:"#828282",class:"button-tnt"},{default:n(()=>[c("Kembali")]),_:1},8,["loading"])]),_:1}),e(s).status&&e(s).status!=="cancel"&&e(s).status!=="complete"?(_(),N(g,{key:0,disabled:((F=e(s))==null?void 0:F.total_current_qty)<1,loading:e(p),type:"primary",class:"button-tnt",onClick:W},{default:n(()=>[c(" Approve ")]),_:1},8,["disabled","loading"])):C("",!0)])])]),a(Me,{show:e(f).show,value:e(f).form,loading:e(p),"onClick:close":M,"onClick:confirm":X},null,8,["show","value","loading"]),a(de,{show:e(l).show,"onUpdate:show":r[1]||(r[1]=t=>e(l).show=t),icon:e(l).icon,"hide-icon":e(l).hideIcon,title:e(l).title,subtitle:e(l).subtitle,align:e(l).align},{default:n(()=>[a(w,{justify:"center"},{default:n(()=>[e(l).type=="confirm"?(_(),m(x,{key:0},[a(g,{loading:e(p),color:"#828282",class:"button-tnt",onClick:$},{default:n(()=>[c(" Tutup ")]),_:1},8,["loading"]),a(g,{loading:e(p),type:"primary",class:"button-tnt",onClick:E},{default:n(()=>[c(" Yakin ")]),_:1},8,["loading"])],64)):C("",!0),e(l).type=="success"?(_(),N(g,{key:1,color:"#828282",class:"button-tnt",onClick:$},{default:n(()=>[c(" Tutup ")]),_:1})):C("",!0)]),_:1})]),_:1},8,["show","icon","hide-icon","title","subtitle","align"])],64)}}});export{ft as default};
