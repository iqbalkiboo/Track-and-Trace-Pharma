import{_ as _e}from"./t-permission-modal.bdf6acbc.js";import{_ as fe}from"./t-feedback.vue_vue_type_script_setup_true_lang.83eb0b14.js";import{_ as ge}from"./t-loading.vue_vue_type_script_setup_true_lang.71bf4981.js";import{d as he,b as be,E as ke,r as p,a1 as we,f as Ce,e as ye,aF as ie,p as Pe,o as h,c as G,a as y,k as l,w as i,q as m,t as re,i as a,h as C,j as b,F as W,ah as Ve,af as De,am as xe,an as Ue,ak as Ne,I as Ee,s as Me,H as Fe,N as Te,K as Be,v as Ke,L as Ae,J as Le}from"./index.21c0d750.js";import{c as K}from"./constant.549d5c21.js";import{o as A}from"./option.2657b089.js";import{m as Ie}from"./master-threepl.f4c7982d.js";import{m as H}from"./master-warehouse.353b4b3b.js";import"./TrashOutline.31dd934b.js";import"./Add.4f3b52cf.js";import{C as $e}from"./CheckmarkCircleOutline.8fddcae1.js";import{A as qe}from"./AlertCircleOutline.19cf574c.js";import"./getCompanyId.7d0eb93b.js";import"./getHoldingId.48f570fc.js";const Se={class:"body-tnt"},Oe={class:"card-tnt"},Re=y("div",{class:"divider-horizontal-tnt",style:{"border-color":"#DFDFDF","margin-top":"5px"}},null,-1),je=y("div",{class:"divider-horizontal-tnt",style:{"border-color":"#DFDFDF","margin-top":"5px"}},null,-1);const ze={class:"bottom-action-button"},Ge={class:"action-item"},dt=he({__name:"plant-area",setup(We){const L=be(),k=ke(),se=p(),U=p(!1),f=p(!1),v=p(""),I=p([]),$=p([]),q=p([]),S=p([]),O=p([]),J=p(null),n=p({status:1,account:{}}),ue=p([{label:"Aktif",value:1},{label:"Tidak Aktif",value:0}]),Y=p(),r=p({show:p(!1),icon:we(),iconColor:"",hideIcon:!1,title:"",subtitle:"",type:""}),P=p({show:!1});Ce(()=>{se.value=ye.getAuth(),L.params.crud=="create"?(v.value="create",ie.isGranted(K.accessPrivileges.company+".create")?Q():P.value.show=!0):(v.value="update",ie.isGranted(K.accessPrivileges.company+".update")?Q():P.value.show=!0)});function ce(){P.value.show=!1}async function Q(){if(v.value=="update"){U.value=!0;const e=L.params.id;await X(),await Z(),await ee(),await te(),await ae(),await H.getDetailWarehouse(e).then(t=>{de(t.data),U.value=!1}).catch(t=>{U.value=!1;const s=t.response.data;k.error(s.message)})}else await X(),await ae()}async function X(){n.value.province=null;const e={limit:1e3};await A.getProvinces(e).then(t=>{I.value=[],t.data.list.forEach(u=>{I.value.push({label:u.name,value:u.id})})}).catch(t=>{const s=t.response.data;k.error(s.message)})}async function Z(){n.value.district=null;const e={limit:1e3,province_id:n.value.province};await A.getDistricts(e).then(t=>{$.value=[],t.data.list.forEach(u=>{$.value.push({label:u.name,value:u.id})})}).catch(t=>{const s=t.response.data;k.error(s.message)})}async function ee(){n.value.subDistrict=null;const e={limit:1e3,district_id:n.value.district};await A.getSubDistricts(e).then(t=>{q.value=[],t.data.list.forEach(u=>{q.value.push({label:u.name,value:u.id})})}).catch(t=>{const s=t.response.data;k.error(s.message)})}async function te(){n.value.urbanVillage=null;const e={limit:1e3,sub_district_id:n.value.subDistrict};await A.getUrbanVillages(e).then(t=>{S.value=[],t.data.list.forEach(u=>{S.value.push({label:u.name,value:u.id})})}).catch(t=>{const s=t.response.data;k.error(s.message)})}async function ae(){n.value.threepl=null;const e={limit:1e3};await Ie.getThreepl(e).then(t=>{O.value=[],t.data.list.forEach(u=>{O.value.push({label:u.name,value:u.id})})}).catch(t=>{const s=t.response.data;k.error(s.message)})}function He(){n.value.printer.push({printer_name:"",id:"",url:""})}async function ne(e){var t;e.preventDefault(),await((t=J.value)==null?void 0:t.validate().then(()=>{ve()}).catch(()=>{k.error("Form tidak valid, tolong periksa kembali")}))}function pe(){f.value=!0;const e=new FormData;if(e.append("name",n.value.name),e.append("description",n.value.description),e.append("province_id",n.value.province),e.append("district_id",n.value.district),e.append("sub_district_id",n.value.subDistrict),e.append("urban_village_id",n.value.urbanVillage),e.append("address",n.value.address),e.append("langitude",n.value.longitude),e.append("latitude",n.value.latitude),e.append("pic_name",n.value.pic),e.append("pic_phone",n.value.picContact),e.append("erp_code",n.value.erpCode),e.append("status",n.value.status),e.append("bpom",`{"account":{"username":"${n.value.account.username}","password":"${n.value.account.password}"}}`),n.value.threepl.forEach(t=>{e.append("pl_id[]",t)}),v.value=="create")H.createWarehouse(e).then(()=>{f.value=!1,me(),w(),setTimeout(()=>{le()},300)}).catch(t=>{const s=t.response.data;f.value=!1,w(),setTimeout(()=>{oe(s)},300)});else{const t=L.params.id;H.updateWarehouse(t,e).then(()=>{f.value=!1,w(),setTimeout(()=>{le()},300)}).catch(s=>{const u=s.response.data;f.value=!1,w(),setTimeout(()=>{oe(u)},300)})}}function de(e){var s,u,V,N,E,d,c,D,g,R,_,M,j,F,T,B,o,z;const t=p([]);e["3pl"].forEach(x=>{t.value.push(x.id)}),n.value={name:e==null?void 0:e.name,description:e==null?void 0:e.description,province:(u=(s=e==null?void 0:e.address)==null?void 0:s.province)==null?void 0:u.id,district:(N=(V=e==null?void 0:e.address)==null?void 0:V.district)==null?void 0:N.id,subDistrict:(d=(E=e==null?void 0:e.address)==null?void 0:E.sub_district)==null?void 0:d.id,urbanVillage:(D=(c=e==null?void 0:e.address)==null?void 0:c.urban_village)==null?void 0:D.id,address:(g=e==null?void 0:e.address)==null?void 0:g.detail,longitude:String((R=e==null?void 0:e.location)==null?void 0:R.coordinates[1]),latitude:String((_=e==null?void 0:e.location)==null?void 0:_.coordinates[0]),pic:(M=e==null?void 0:e.pic)==null?void 0:M.value,picContact:(j=e==null?void 0:e.pic)==null?void 0:j.contact,erpCode:e==null?void 0:e.erp_code,threepl:t==null?void 0:t.value,status:(F=e==null?void 0:e.status)==null?void 0:F.value,account:{username:(B=(T=e==null?void 0:e.bpom)==null?void 0:T.account)==null?void 0:B.username,password:(z=(o=e==null?void 0:e.bpom)==null?void 0:o.account)==null?void 0:z.password}}}function me(){n.value={name:"",description:"",province:null,district:null,subDistrict:null,urbanVillage:"",address:"",longitude:"",latitude:"",pic:"",picContact:"",erpCode:"",threepl:null,status:1,accoount:{username:"",password:""}}}function w(){r.value.show=!1}function ve(){r.value.type="confirm",r.value.hideIcon=!0,r.value.title="Konfirmasi",v.value=="create"?r.value.subtitle="Apakah Anda yakin untuk menambah data plant/cabang?":r.value.subtitle="Apakah Anda yakin untuk mengubah data plant/cabang?",r.value.show=!0}function le(){r.value.type="success",r.value.hideIcon=!1,r.value.iconColor="#219653",r.value.icon=$e,v.value=="create"?(r.value.title="Berhasil Tambah Data",r.value.subtitle="Data plant/cabang berhasil ditambahkan"):(r.value.title="Berhasil Ubah Data",r.value.subtitle="Data plant/cabang berhasil diubah"),r.value.show=!0}function oe(e){r.value.type="failed",r.value.hideIcon=!1,r.value.iconColor="#EB5757",r.value.icon=qe,r.value.title="Gagal",Object.keys(e.validation).length>0?r.value.subtitle=e.validation:r.value.subtitle=e.message,r.value.show=!0}return Y.value={name:{required:!0,message:"Nama plant/cabang tidak boleh kosong",trigger:["input","blur"]},description:{required:!0,message:"Keterangan tidak boleh kosong",trigger:["input","blur"]},province:{required:!0,message:"Provinsi tidak boleh kosong",trigger:["input","blur"]},district:{required:!0,message:"Kota/Kabupaten tidak boleh kosong",trigger:["input","blur"]},subDistrict:{required:!0,message:"Kecamatan tidak boleh kosong",trigger:["input","blur"]},urbanVillage:{required:!0,message:"Kelurahan tidak boleh kosong",trigger:["input","blur"]},address:{required:!0,message:"Keterangan alamat tidak boleh kosong",trigger:["input","blur"]},longitude:{required:!0,validator(e,t){if(!t)return new Error("Longitude tidak boleh kosong");if(t.includes(","))return new Error("Longitude tidak boleh menggunakan tanda koma");if(!/^[-]?[0-9]*\.?[0-9]*$/.test(t))return new Error("Longitude harus angka atau tidak valid")},trigger:["input","blur"]},latitude:{required:!0,validator(e,t){if(!t)return new Error("Latitude tidak boleh kosong");if(t.includes(","))return new Error("Latitude tidak boleh menggunakan tanda koma");if(!/^[-]?[0-9]*\.?[0-9]*$/.test(t))return new Error("Latitude harus angka atau tidak valid")},trigger:["input","blur"]},pic:{required:!0,message:"PIC tidak boleh kosong",trigger:["input","blur"]},picContact:{required:!0,validator(e,t){if(t)if(/^\d*$/.test(t)){if(t.length<8)return new Error("Kontak PIC kurang dari 8 angka")}else return new Error("Kontak PIC harus angka");else return new Error("Kontak PIC tidak boleh kosong");return!0},trigger:["input","blur"]},erpCode:{required:!0,message:"Kode ERP tidak boleh kosong",trigger:["input","blur"]},threepl:{type:"array",required:!0,message:"3PL tidak boleh kosong",trigger:["blur","input"]},status:{type:"number",required:!0,message:"Status tidak boleh kosong",trigger:["input","blur"]}},(e,t)=>{const s=De,u=Pe("router-link"),V=xe,N=Ue,E=ge,d=Ne,c=Ee,D=Me,g=Fe,R=Te,_=Be,M=Ke,j=Ae,F=Le,T=fe,B=_e;return h(),G(W,null,[y("div",Se,[l(s,{style:{"margin-bottom":"4px"}},{default:i(()=>[m(re(a(v)=="create"?"Tambah Plant/Cabang":"Edit Plant/Cabang"),1)]),_:1}),l(N,null,{default:i(()=>[l(V,null,{default:i(()=>[l(u,{to:"/setting/master-perusahaan",class:"text-decoration-none"},{default:i(()=>[m(" Master Perusahaan ")]),_:1})]),_:1}),l(V,null,{default:i(()=>[m(re(a(v)=="create"?"Tambah Plant/Cabang":"Edit Plant/Cabang"),1)]),_:1})]),_:1}),y("div",Oe,[a(U)?(h(),C(E,{key:0})):(h(),C(F,{key:1,ref_key:"formRef",ref:J,class:"form-tnt","show-require-mark":!1,"label-width":80,model:a(n),rules:a(Y)},{default:i(()=>[l(c,{label:"Nama Plant/Cabang",path:"name"},{default:i(()=>[l(d,{value:a(n).name,"onUpdate:value":t[0]||(t[0]=o=>a(n).name=o),placeholder:"Masukkan nama plant/cabang"},null,8,["value"])]),_:1}),l(c,{label:"Keterangan",path:"description"},{default:i(()=>[l(d,{value:a(n).description,"onUpdate:value":t[1]||(t[1]=o=>a(n).description=o),placeholder:"Masukkan keterangan"},null,8,["value"])]),_:1}),Re,l(D,{style:{display:"block","font-weight":"500",margin:"10px 0 15px 0"}},{default:i(()=>[m("Alamat Plant/Cabang")]),_:1}),l(c,{label:"Provinsi",path:"province"},{default:i(()=>[l(g,{value:a(n).province,"onUpdate:value":[t[2]||(t[2]=o=>a(n).province=o),Z],options:a(I),filterable:"",placeholder:"Pilih provinsi"},null,8,["value","options"])]),_:1}),l(c,{label:"Kota/Kabupaten",path:"district"},{default:i(()=>[l(g,{value:a(n).district,"onUpdate:value":[t[3]||(t[3]=o=>a(n).district=o),ee],options:a($),filterable:"",placeholder:"Pilih kota/kabupaten"},null,8,["value","options"])]),_:1}),l(c,{label:"Kecamatan",path:"subDistrict"},{default:i(()=>[l(g,{value:a(n).subDistrict,"onUpdate:value":[t[4]||(t[4]=o=>a(n).subDistrict=o),te],options:a(q),filterable:"",placeholder:"Pilih kecamatan"},null,8,["value","options"])]),_:1}),l(c,{label:"Kelurahan",path:"urbanVillage"},{default:i(()=>[l(g,{value:a(n).urbanVillage,"onUpdate:value":t[5]||(t[5]=o=>a(n).urbanVillage=o),options:a(S),filterable:"",placeholder:"Pilih kelurahan"},null,8,["value","options"])]),_:1}),l(c,{label:"Keterangan Alamat (Nama jalan dan No. Bangunan)",path:"address"},{default:i(()=>[l(d,{value:a(n).address,"onUpdate:value":t[6]||(t[6]=o=>a(n).address=o),placeholder:"Masukkan keterangan alamat"},null,8,["value"])]),_:1}),l(c,{label:"Longitude",path:"longitude"},{default:i(()=>[l(d,{value:a(n).longitude,"onUpdate:value":t[7]||(t[7]=o=>a(n).longitude=o),placeholder:"Masukkan longitude"},null,8,["value"])]),_:1}),l(c,{label:"Latitude",path:"latitude"},{default:i(()=>[l(d,{value:a(n).latitude,"onUpdate:value":t[8]||(t[8]=o=>a(n).latitude=o),placeholder:"Masukkan latitude"},null,8,["value"])]),_:1}),l(c,{label:"PIC",path:"pic"},{default:i(()=>[l(d,{value:a(n).pic,"onUpdate:value":t[9]||(t[9]=o=>a(n).pic=o),placeholder:"Masukkan PIC"},null,8,["value"])]),_:1}),l(c,{label:"Kontak PIC",path:"picContact"},{default:i(()=>[l(d,{value:a(n).picContact,"onUpdate:value":t[10]||(t[10]=o=>a(n).picContact=o),placeholder:"Masukkan kontak PIC"},null,8,["value"])]),_:1}),l(c,{label:"Kode ERP",path:"erpCode"},{default:i(()=>[l(d,{value:a(n).erpCode,"onUpdate:value":t[11]||(t[11]=o=>a(n).erpCode=o),placeholder:"Masukkan kode ERP"},null,8,["value"])]),_:1}),l(c,{label:"Pilih 3PL",path:"threepl"},{default:i(()=>[l(g,{multiple:"",value:a(n).threepl,"onUpdate:value":t[12]||(t[12]=o=>a(n).threepl=o),options:a(O),filterable:"",placeholder:"Pilih 3PL"},null,8,["value","options"])]),_:1}),l(c,{path:"status",label:"Status"},{default:i(()=>[l(g,{value:a(n).status,"onUpdate:value":t[13]||(t[13]=o=>a(n).status=o),options:a(ue),placeholder:"Pilih Status Plant/Cabang",style:{width:"100%"}},null,8,["value","options"])]),_:1}),je,l(D,{style:{display:"block","font-weight":"500",margin:"10px 0 15px 0"}},{default:i(()=>[m("Akun BPOM")]),_:1}),l(c,{label:"Username"},{default:i(()=>[l(d,{value:a(n).account.username,"onUpdate:value":t[14]||(t[14]=o=>a(n).account.username=o),placeholder:"Masukkan kode ERP"},null,8,["value"])]),_:1}),l(c,{label:"Password"},{default:i(()=>[l(d,{type:"password","show-password-on":"click",value:a(n).account.password,"onUpdate:value":t[15]||(t[15]=o=>a(n).account.password=o),placeholder:"Masukkan kode ERP"},null,8,["value"])]),_:1}),b("",!0),b("",!0),b("",!0)]),_:1},8,["model","rules"]))]),y("div",ze,[y("div",Ge,[l(u,{to:"/setting/master-perusahaan",class:"text-decoration-none"},{default:i(()=>[l(_,{color:"#828282",class:"button-tnt"},{default:i(()=>[m("Kembali")]),_:1})]),_:1}),a(v)==="create"&&e.$filters.isGranted(a(K).accessPrivileges.company+".create")?(h(),C(_,{key:0,color:"#219653",class:"button-tnt",loading:a(f),onClick:ne},{default:i(()=>[m(" Simpan ")]),_:1},8,["loading"])):b("",!0),a(v)==="update"&&e.$filters.isGranted(a(K).accessPrivileges.company+".update")?(h(),C(_,{key:1,color:"#219653",class:"button-tnt",loading:a(f),onClick:ne},{default:i(()=>[m(" Simpan ")]),_:1},8,["loading"])):b("",!0)])])]),l(T,{show:a(r).show,"onUpdate:show":t[16]||(t[16]=o=>a(r).show=o),icon:a(r).icon,"icon-color":a(r).iconColor,"hide-icon":a(r).hideIcon,title:a(r).title,subtitle:a(r).subtitle},{default:i(()=>[l(M,{justify:"center"},{default:i(()=>[a(r).type=="confirm"?(h(),G(W,{key:0},[l(_,{loading:a(f),color:"#828282",class:"button-tnt",onClick:w},{default:i(()=>[m(" Tutup ")]),_:1},8,["loading"]),l(_,{loading:a(f),color:"#219653",class:"button-tnt",style:{"padding-left":"25px","padding-right":"25px"},onClick:Ve(pe,["prevent"])},{default:i(()=>[m(" Yakin ")]),_:1},8,["loading","onClick"])],64)):b("",!0),a(r).type=="success"?(h(),G(W,{key:1},[a(v)=="create"?(h(),C(_,{key:0,color:"#828282",class:"button-tnt",onClick:w},{default:i(()=>[m(" Tambah Lainya ")]),_:1})):b("",!0),l(u,{to:{name:"setting-master-perusahaan"},class:"text-decoration-none"},{default:i(()=>[l(_,{color:"#219653",class:"button-tnt"},{default:i(()=>[m(" Kembali ke Beranda ")]),_:1})]),_:1})],64)):b("",!0),a(r).type=="failed"?(h(),C(_,{key:2,color:"#828282",class:"button-tnt",onClick:w},{default:i(()=>[m(" Tutup ")]),_:1})):b("",!0)]),_:1})]),_:1},8,["show","icon","icon-color","hide-icon","title","subtitle"]),l(B,{show:a(P).show,"onUpdate:show":t[17]||(t[17]=o=>a(P).show=o),"onClick:close":ce},null,8,["show"])],64)}}});export{dt as default};
