import{_ as xe}from"./t-feedback.vue_vue_type_script_setup_true_lang.83eb0b14.js";import{_ as Ce}from"./t-loading.vue_vue_type_script_setup_true_lang.71bf4981.js";import{d as De,r as p,E as Oe,u as Ne,b as Be,f as Te,o as b,c as O,a as N,k as e,w as t,q as s,t as m,i as o,h as $e,F as $,g as Se,j as J,S as Ue,af as ze,am as Le,an as Me,N as Ve,K as Pe,v as Fe,ak as je,ad as Ae,aj as Ie,H as Re,ae as qe,s as Ee,a9 as Ke,a7 as We,a8 as Ge,y as He,ag as Qe,a$ as Je,aM as Ye,I as Xe,J as Ze}from"./index.21c0d750.js";import{r as S}from"./render-icon.8c81e0de.js";import{h as et}from"./moment.62d3fb0a.js";import{a as F}from"./agregasi.9b2e850f.js";import{t as _,h as Y}from"./feedback.0313b46e.js";import{m as tt}from"./master-warehouse.353b4b3b.js";import{A as X}from"./AddOutline.a2e673de.js";import{E as at}from"./EllipsisVertical.56989e7a.js";import{G as nt}from"./GitMergeOutline.f1e3120f.js";import{L as ot}from"./ListOutline.d860ea46.js";import{C as lt}from"./CloseOutline.cda7564f.js";import{L as st}from"./LocationOutline.22b247fa.js";import"./CheckmarkCircleOutline.8fddcae1.js";import"./getCompanyId.7d0eb93b.js";const ut="/assets/sample_customer.ecf296d0.xlsx",it="/assets/sample_crossdocking.9ac9d045.xlsx",ct={class:"body-tnt"},rt={class:"card-tnt"},dt={key:1},_t=N("td",{colspan:"6",style:{"text-align":"center"}}," Belum ada data tersedia ",-1),pt=[_t],ft={style:{"margin-bottom":"12px"}},mt=["href"],Lt=De({__name:"index",setup(gt){const i=p({dir:"desc",sort:"created_at",page:1,limit:10,status:"",do_type:"",code:"",destination:""}),h=Oe(),g=p(!0),f=p(!1),U=p({}),w=p(""),x=Ne(),j=p([]),B=Be(),k=p(!1),A=p(0),z=p({}),I=p(null),R=p(""),Z=p([{label:"Perlu Agregasi",value:"perlu_agregasi"},{label:"Ready to Delivery",value:"ready_to_delivery"},{label:"On Delivery",value:"on_delivery"},{label:"Finish",value:"finish"},{label:"Cancel",value:"cancel"}]);function ee(a,n){switch(a){case"detail":x.push({name:"pengiriman-agregasi-type-id",params:{id:n}});break;case"tambah":x.push({name:"pengiriman-agregasi-type-id-add",params:{id:n}});break;case"lacak":x.push({name:"lacak-do-id",params:{id:n}});break;case"cancel":R.value=n,oe();break;case"list":x.push({name:"pengiriman-id-list-manifest",params:{id:n}});break}}Te(()=>{i.value.page=parseInt(B.query.p)||1;const a="crossdocking",n="customer";B.params.type===a?(w.value=a,i.value.do_type=a):B.params.type===n?(w.value=n,i.value.do_type=n):x.push("/"),y(),ie()});function te(a){i.value.limit=a,y()}function ae(a){x.push({query:{...B.query,p:a}})}const q=p(0),E=p(0);async function y(){g.value=!0,f.value=!0,await F.getDO(i.value).then(a=>{E.value=a.data.total_page,q.value=a.data.total_data,U.value=a.data.list.map(n=>({...n,watch_product:!1})),g.value=!1,f.value=!1}).catch(a=>{if(g.value=!1,f.value=!1,a.response){const c=a.response.data;h.error(c.message)}const n=a.response.data;h.error(n.message)})}function ne(a){const n=[{label:"Lihat Agregasi",key:"tambah",icon:S(nt)},{label:"List Manifest",key:"list",icon:S(ot)},{label:"Batalkan",key:"cancel",icon:S(lt)},{label:"Lacak DO",key:"lacak",icon:S(st)}];return a=="cancel"||a==="finish"?n.filter(c=>c.key==="tambah"||c.key==="lacak"):n}function oe(){_.value.type="cencel",_.value.hideIcon=!0,_.value.iconColor="#219653",_.value.title="Batalkan",_.value.subtitle="Apakah Anda yakin untuk membatalkan DO?",_.value.show=!0}async function le(a){await F.cencelDO(a).then(()=>{g.value=!1,f.value=!1,y(),Y(),_.value.show=!1,h.success("Berhasil membatalkan DO")}).catch(()=>{g.value=!1,f.value=!1,_.value.show=!1})}async function se(a){var c;["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].indexOf(String((c=a.file.file)==null?void 0:c.type))===-1?h.error("File yang diupload bukan excel, silakan upload ulang"):(z.value.name=a.file.name,z.value.file=a.file.file,A.value=a.fileList.length)}async function ue(){var a;f.value=!0,await((a=I.value)==null?void 0:a.validate().then(()=>{const n=new FormData;n.append("type",w.value),n.append("file",z.value.file),F.importDO(n).then(()=>{y(),k.value=!1,f.value=!0,h.success("Berhasil import delivery order")}).catch(c=>{if(c.response){const T=c.response.data;h.error(T.message)}f.value=!1,k.value=!1})}).catch(()=>{h.error("Form tidak valid, tolong periksa kembali")}))}async function ie(){g.value=!0,await tt.getWarehouse({limit:1e3,sort:"desc"}).then(a=>{var n;g.value=!1,j.value=(n=a.data)==null?void 0:n.list.map(c=>({label:c.name,value:c.id}))}).catch(a=>{g.value=!1,a.response.data})}function yt(a){return a.map(c=>c.name).join(",")}const K=p(0);function L(){i.value.page=1,clearTimeout(K.value),K.value=setTimeout(function(){y()},600)}function ce(a){i.value.date=a||null,y()}function re(a){i.value.destination=a||null,y()}function de(a){i.value.status=a||null,y()}return(a,n)=>{const c=ze,T=Le,_e=Me,M=Ve,C=Pe,r=Fe,V=je,D=Ae,pe=Ie,W=Re,fe=qe,me=Ce,u=Ee,ge=Ke,v=We,G=Ge,ye=He,ve=Qe,he=Je,ke=Ye,H=Xe,be=Ze,Q=xe;return b(),O($,null,[N("div",ct,[e(c,{style:{"margin-bottom":"4px"}},{default:t(()=>[s("Delivery Order")]),_:1}),e(_e,null,{default:t(()=>[e(T,null,{default:t(()=>[s("Agregasi")]),_:1}),e(T,null,{default:t(()=>[s(m(o(w)),1)]),_:1})]),_:1}),N("div",rt,[e(r,{justify:"space-between"},{default:t(()=>[e(C,{color:"#219653",class:"button-tnt",onClick:n[0]||(n[0]=l=>k.value=!0)},{icon:t(()=>[e(M,null,{default:t(()=>[e(o(X))]),_:1})]),default:t(()=>[s(" Upload DO ")]),_:1})]),_:1}),e(fe,{cols:"6","x-gap":"12",style:{"margin-top":"1rem"}},{default:t(()=>[e(D,null,{default:t(()=>[e(V,{value:o(i).code,"onUpdate:value":[n[1]||(n[1]=l=>o(i).code=l),L],clearable:"",placeholder:"Cari Kode DO"},null,8,["value"])]),_:1}),e(D,null,{default:t(()=>[e(V,{value:o(i).product_code,"onUpdate:value":[n[2]||(n[2]=l=>o(i).product_code=l),L],clearable:"",placeholder:"Cari Kode Product"},null,8,["value"])]),_:1}),e(D,null,{default:t(()=>[e(V,{value:o(i).erp_code,"onUpdate:value":[n[3]||(n[3]=l=>o(i).erp_code=l),L],clearable:"",placeholder:"Cari Kode Tujuan"},null,8,["value"])]),_:1}),e(D,null,{default:t(()=>[e(pe,{"value-format":"yyyy-MM-dd",clearable:"",onUpdateFormattedValue:ce,placeholder:"Tanggal DO",type:"date"})]),_:1}),e(D,null,{default:t(()=>[e(W,{options:o(j),"onUpdate:value":re,clearable:"",filterable:"",placeholder:"Pilih Tujuan"},null,8,["options"])]),_:1}),e(D,null,{default:t(()=>[e(W,{options:o(Z),"onUpdate:value":de,clearable:"",filterable:"",placeholder:"Pilih Status"},null,8,["options"])]),_:1})]),_:1}),e(r,{vertical:"",size:10,style:{"margin-top":"24px"}},{default:t(()=>[o(g)?(b(),$e(me,{key:0})):(b(),O($,{key:1},[o(U).length>0?(b(!0),O($,{key:0},Se(o(U),(l,we)=>(b(),O("div",{class:"card-tnt card-box-tnt",style:{padding:"1rem","margin-top":"0","border-radius":"12px",background:"#eee"},key:we},[e(r,{justify:"space-between"},{default:t(()=>[e(r,{vertical:"",size:0},{default:t(()=>[e(r,null,{default:t(()=>[e(u,{strong:""},{default:t(()=>[s("Kode DO :")]),_:1}),e(u,null,{default:t(()=>[s(m(l.code),1)]),_:2},1024)]),_:2},1024),e(r,null,{default:t(()=>[e(u,{strong:""},{default:t(()=>[s("Tujuan :")]),_:1}),e(u,null,{default:t(()=>{var d;return[s(m((d=l.customer)==null?void 0:d.name),1)]}),_:2},1024),e(u,null,{default:t(()=>{var d;return[s("("+m((d=l.customer)==null?void 0:d.erp_code)+")",1)]}),_:2},1024)]),_:2},1024),e(r,null,{default:t(()=>[e(u,{strong:""},{default:t(()=>[s("Tanggal DO")]),_:1}),e(u,null,{default:t(()=>[s(m(o(et)(l==null?void 0:l.do_date).format("yyyy-MM-DD")),1)]),_:2},1024)]),_:2},1024),J("",!0)]),_:2},1024),e(ge,{round:"",type:l.status==="cancel"?"error":l.status==="selesai"?"success":"info"},{default:t(()=>[s(m(a.$filters.toStatus(l.status)),1)]),_:2},1032,["type"])]),_:2},1024),e(G,{gutter:"10"},{default:t(()=>[e(v,{span:22,style:{"margin-top":"10px"}},{default:t(()=>[e(G,{gutter:"10"},{default:t(()=>[e(v,{span:4},{default:t(()=>[e(r,{vertical:"",align:"start",size:0},{default:t(()=>[e(u,{strong:""},{default:t(()=>[s("No PO")]),_:1}),e(u,null,{default:t(()=>[s(m(l.po_number),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(v,{span:4},{default:t(()=>[e(r,{vertical:"",align:"start",size:0},{default:t(()=>[e(u,{strong:""},{default:t(()=>[s("Nama Building")]),_:1}),e(u,null,{default:t(()=>[s(m(l.origin.warehouse_building.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(v,{span:4},{default:t(()=>[e(r,{vertical:"",size:0},{default:t(()=>[e(u,{strong:""},{default:t(()=>[s("No Invoice")]),_:1}),e(u,null,{default:t(()=>[s(m(a.$filters.isEmpty(l.no_invoice)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(v,{span:4},{default:t(()=>[e(r,{vertical:"",align:"center",size:0},{default:t(()=>[e(u,{strong:""},{default:t(()=>[s("Pesan / Qty Packing")]),_:1}),e(u,null,{default:t(()=>{var d,P;return[s(m(`${(d=l.total)==null?void 0:d.qty_request} / ${(P=l.total)==null?void 0:P.qty_packed}`),1)]}),_:2},1024)]),_:2},1024)]),_:2},1024),e(v,{span:4},{default:t(()=>[e(r,{vertical:"",align:"center",size:0},{default:t(()=>[e(u,{strong:""},{default:t(()=>[s("Belum dipack")]),_:1}),e(u,null,{default:t(()=>{var d;return[s(m((d=l.total)==null?void 0:d.qty_remaining),1)]}),_:2},1024)]),_:2},1024)]),_:2},1024),e(v,{span:4},{default:t(()=>[e(r,{vertical:"",align:"center",size:0},{default:t(()=>[e(u,{strong:""},{default:t(()=>[s("Qty Manifest")]),_:1}),e(u,null,{default:t(()=>{var d;return[s(m(a.$filters.toNumber((d=l.total)==null?void 0:d.manifest)),1)]}),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(v,{span:2,align:"end",style:{"margin-top":"10px"}},{default:t(()=>[e(ye,{placement:"bottom-end","show-arrow":"",options:ne(l.status),onSelect:d=>ee(d,l.id)},{default:t(()=>[e(C,{tertiary:""},{icon:t(()=>[e(M,null,{default:t(()=>[e(o(at))]),_:1})]),_:1})]),_:2},1032,["options","onSelect"])]),_:2},1024)]),_:2},1024)]))),128)):(b(),O("tr",dt,pt))],64)),e(r,{justify:"center"},{default:t(()=>[e(ve,{page:o(i).page,"onUpdate:page":[n[4]||(n[4]=l=>o(i).page=l),ae],"page-count":o(E),"page-slot":10,"show-size-picker":o(q)>10,"page-sizes":[10,20,30,40,50],"onUpdate:pageSize":te},null,8,["page","page-count","show-size-picker"])]),_:1})]),_:1})])]),e(Q,{title:o(w)==="crossdocking"?"Tambah DO Tipe Crossdocking":"Tambah DO Tipe Customer",show:o(k),"onUpdate:show":n[6]||(n[6]=l=>Ue(k)?k.value=l:null),hideIcon:""},{default:t(()=>[e(be,{class:"form-tnt",ref_key:"formRef",ref:I},{default:t(()=>[e(H,{label:"Upload File","show-feedback":!1},{default:t(()=>[e(ke,{"directory-dnd":"",onChange:se},{default:t(()=>[e(he,null,{default:t(()=>[N("div",ft,[e(M,{size:"48",style:{opacity:"0.6"},depth:3},{default:t(()=>[e(o(X))]),_:1})]),e(u,{style:{"font-size":"16px",opacity:"0.7"}},{default:t(()=>[s(" klik atau tarik file ke area upload ini ")]),_:1})]),_:1})]),_:1})]),_:1}),e(H,{label:"","show-feedback":!0,"show-label":!1},{default:t(()=>[N("a",{href:o(w)==="crossdocking"?o(it):o(ut),class:"text_link"},"download contoh file",8,mt)]),_:1})]),_:1},512),e(r,null,{default:t(()=>[e(C,{loading:o(f),onClick:n[5]||(n[5]=l=>k.value=!1),type:"tertiary",class:"button-tnt"},{default:t(()=>[s("Batalkan ")]),_:1},8,["loading"]),e(C,{disabled:o(A)===0,loading:o(f),type:"primary",onClick:ue,class:"button-tnt"},{default:t(()=>[s("Tambahkan ")]),_:1},8,["disabled","loading"])]),_:1})]),_:1},8,["title","show"]),e(Q,{show:o(_).show,"onUpdate:show":n[8]||(n[8]=l=>o(_).show=l),icon:o(_).icon,"icon-color":o(_).iconColor,"hide-icon":o(_).hideIcon,title:o(_).title,subtitle:o(_).subtitle},{default:t(()=>[e(r,{justify:"center"},{default:t(()=>[o(_).type=="cencel"?(b(),O($,{key:0},[e(C,{loading:o(f),color:"#828282",secondary:"",strong:"",class:"button-tnt",onClick:o(Y)},{default:t(()=>[s(" Tutup ")]),_:1},8,["loading","onClick"]),e(C,{loading:o(f),type:"primary",secondary:"",strong:"",class:"button-tnt",style:{"padding-left":"25px","padding-right":"25px"},onClick:n[7]||(n[7]=l=>le(o(R)))},{default:t(()=>[s(" Yakin ")]),_:1},8,["loading"])],64)):J("",!0)]),_:1})]),_:1},8,["show","icon","icon-color","hide-icon","title","subtitle"])],64)}}});export{Lt as default};
