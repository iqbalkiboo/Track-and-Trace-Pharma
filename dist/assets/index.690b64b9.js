import{_ as Q}from"./t-permission-modal.bdf6acbc.js";import{_ as W}from"./t-feedback.vue_vue_type_script_setup_true_lang.83eb0b14.js";import{_ as X}from"./t-loading.vue_vue_type_script_setup_true_lang.71bf4981.js";import{d as Z,b as ee,E as ae,r,a1 as te,f as ne,e as oe,aF as q,p as le,o as m,c as F,a as C,k as t,w as n,q as u,i as a,h as b,j as k,F as B,ah as se,as as ie,am as ue,an as re,ak as ce,I as pe,J as de,K as me,v as _e}from"./index.21c0d750.js";import{c as P}from"./constant.549d5c21.js";import{p as M}from"./principal.7a723d63.js";import{A as fe}from"./AlertCircleOutline.19cf574c.js";import{C as ve}from"./CheckmarkCircleOutline.8fddcae1.js";import"./getCompanyId.7d0eb93b.js";import"./getHoldingId.48f570fc.js";const he={class:"body-tnt"},be={class:"card-tnt"},ke={class:"bottom-action-button"},ge={class:"action-item"},Ne=Z({__name:"index",setup(we){const x=ee(),G=ae(),g=r(),p=r(""),w=r(!1),s=r(!1),i=r({}),K=r(),N=r(),e=r({show:r(!1),icon:te(),iconColor:"",hideIcon:!1,title:"",subtitle:"",type:""});N.value={name:{required:!0,message:"Nama Principal tidak boleh kosong",trigger:"blur"},description:{required:!0,message:"Deskripsi tidak boleh kosong",trigger:"blur"},erp_code:{required:!0,message:"Kode Principal tidak boleh kosong",trigger:"blur"}};const h=r({show:!1});ne(()=>{g.value=oe.getAuth(),x.params.crud=="create"?(p.value="create",q.isGranted(P.accessPrivileges.principal+".create")?V():h.value.show=!0):(p.value="update",q.isGranted(P.accessPrivileges.principal+".update")?V():h.value.show=!0)});function $(){h.value.show=!1}async function V(){if(p.value=="update"){w.value=!0,s.value=!0;const l=x.params.id;await M.getDetailPrincipal(l).then(o=>{j(o.data),w.value=!1,s.value=!1}).catch(o=>{w.value=!1,s.value=!1;const f=o.response.data;G.error(f.message)})}}function S(){s.value=!0;let l="";g.value.xxtype==="5up3r4dm1n"?l=g.value["xx-usertype-access"].holding_id:l=g.value.users.user_type.id;const o={holding_id:l,name:i.value.name,description:i.value.description,erp_code:i.value.erp_code};if(p.value=="create")M.createPrincipal(o).then(()=>{s.value=!1,A(),_(),setTimeout(()=>{U()},300)}).catch(f=>{const v=f.response.data;s.value=!1,_(),setTimeout(()=>{I(v)},300)});else{const f=x.params.id;M.updatePrincipal(f,o).then(()=>{s.value=!1,A(),_(),setTimeout(()=>{U()},300)}).catch(v=>{const y=v.response.data;s.value=!1,_(),setTimeout(()=>{I(y)},300)})}}function j(l){i.value={name:l.name,description:l.description,erp_code:l.erp_code}}function A(){i.value={name:"",description:"",erp_code:""}}async function R(l){var o;l.preventDefault(),await((o=K.value)==null?void 0:o.validate()),E()}function _(){e.value.show=!1}function E(){e.value.type="confirm",e.value.hideIcon=!0,e.value.title="Konfirmasi",p.value=="create"?e.value.subtitle="Apakah Anda yakin untuk menambah principal?":e.value.subtitle="Apakah Anda yakin untuk mengubah principal?",e.value.show=!0}function I(l){e.value.type="failed",e.value.hideIcon=!1,e.value.iconColor="#EB5757",e.value.icon=fe,e.value.title="Gagal",Object.keys(l.validation).length>0?e.value.subtitle=l.validation:e.value.subtitle=l.message,e.value.show=!0}function U(){e.value.type="success",e.value.hideIcon=!1,e.value.iconColor="#219653",e.value.icon=ve,p.value=="create"?(e.value.title="Berhasil Tambah Data",e.value.subtitle="Data principal berhasil ditambahkan"):(e.value.title="Berhasil Ubah Data",e.value.subtitle="Data principal berhasil diubah"),e.value.show=!0}return(l,o)=>{const f=ie,v=le("router-link"),y=ue,L=re,O=X,D=ce,T=pe,z=de,d=me,H=_e,J=W,Y=Q;return m(),F(B,null,[C("div",he,[t(f,{style:{"margin-bottom":"4px"}},{default:n(()=>[u("Tambah Principal")]),_:1}),t(L,null,{default:n(()=>[t(y,null,{default:n(()=>[t(v,{to:"/setting/master-principal",class:"text-decoration-none"},{default:n(()=>[u(" Principal ")]),_:1})]),_:1}),t(y,null,{default:n(()=>[u("Tambah Principal")]),_:1})]),_:1}),C("div",be,[a(w)?(m(),b(O,{key:0})):(m(),b(z,{key:1,ref_key:"formRef",ref:K,class:"form-tnt","show-require-mark":!1,"label-width":80,model:a(i),rules:a(N)},{default:n(()=>[t(T,{label:"Nama Principal",path:"name"},{default:n(()=>[t(D,{value:a(i).name,"onUpdate:value":o[0]||(o[0]=c=>a(i).name=c),placeholder:"Masukkan Nama Principal"},null,8,["value"])]),_:1}),t(T,{label:"Kode Principal",path:"erp_code"},{default:n(()=>[t(D,{value:a(i).erp_code,"onUpdate:value":o[1]||(o[1]=c=>a(i).erp_code=c),placeholder:"Masukkan Kode Principal"},null,8,["value"])]),_:1}),t(T,{label:"Deskripsi",path:"description"},{default:n(()=>[t(D,{value:a(i).description,"onUpdate:value":o[2]||(o[2]=c=>a(i).description=c),placeholder:"Ketikkan Deskripsi Principal",type:"textarea",autosize:{minRows:3,maxRows:5}},null,8,["value"])]),_:1})]),_:1},8,["model","rules"]))]),C("div",ke,[C("div",ge,[t(v,{to:"/setting/master-principal",class:"text-decoration-none"},{default:n(()=>[t(d,{color:"#828282",class:"button-tnt"},{default:n(()=>[u(" Kembali ")]),_:1})]),_:1}),a(p)==="create"&&l.$filters.isGranted(a(P).accessPrivileges.principal+".create")?(m(),b(d,{key:0,color:"#219653",class:"button-tnt",loading:a(s),onClick:R},{default:n(()=>[u(" Simpan ")]),_:1},8,["loading"])):k("",!0),a(p)==="update"&&l.$filters.isGranted(a(P).accessPrivileges.principal+".update")?(m(),b(d,{key:1,color:"#219653",class:"button-tnt",loading:a(s),onClick:R},{default:n(()=>[u(" Simpan ")]),_:1},8,["loading"])):k("",!0)])])]),t(J,{show:a(e).show,"onUpdate:show":o[3]||(o[3]=c=>a(e).show=c),icon:a(e).icon,"icon-color":a(e).iconColor,"hide-icon":a(e).hideIcon,title:a(e).title,subtitle:a(e).subtitle},{default:n(()=>[t(H,{justify:"center"},{default:n(()=>[a(e).type=="confirm"?(m(),F(B,{key:0},[t(d,{loading:a(s),color:"#828282",class:"button-tnt",onClick:_},{default:n(()=>[u(" Tutup ")]),_:1},8,["loading"]),t(d,{loading:a(s),color:"#219653",class:"button-tnt",style:{"padding-left":"25px","padding-right":"25px"},onClick:se(S,["prevent"])},{default:n(()=>[u(" Yakin ")]),_:1},8,["loading","onClick"])],64)):k("",!0),a(e).type=="success"?(m(),F(B,{key:1},[t(d,{color:"#828282",class:"button-tnt",onClick:_},{default:n(()=>[u(" Tambah Lainya ")]),_:1}),t(v,{to:{name:"setting-master-principal"},class:"text-decoration-none"},{default:n(()=>[t(d,{color:"#219653",class:"button-tnt"},{default:n(()=>[u(" Kembali ke Beranda ")]),_:1})]),_:1})],64)):k("",!0),a(e).type=="failed"?(m(),b(d,{key:2,color:"#828282",class:"button-tnt",onClick:_},{default:n(()=>[u(" Tutup ")]),_:1})):k("",!0)]),_:1})]),_:1},8,["show","icon","icon-color","hide-icon","title","subtitle"]),t(Y,{show:a(h).show,"onUpdate:show":o[4]||(o[4]=c=>a(h).show=c),"onClick:close":$},null,8,["show"])],64)}}});export{Ne as default};
