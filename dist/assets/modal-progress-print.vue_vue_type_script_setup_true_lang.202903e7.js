import{d as I,E as z,r as g,G as B,o as L,h as M,w as o,k as i,q as f,t as y,i as l,ah as v,a as j,s as A,br as $,K as N,v as V,L as E,M as G}from"./index.21c0d750.js";import{s as m}from"./serialisasi.378d5040.js";const K=j("h3",{style:{display:"block","font-weight":"500","margin-bottom":"8px"}}," Cetak QR Code Level 1 ",-1),T=I({__name:"modal-progress-print",props:{show:{type:Boolean,default:!1},serializeLevelDataRes:{},serialArr:{},detailProductDataRes:{}},emits:["cancelClick","confirmClick","update:show"],setup(b,{emit:k}){const _=b,c=z(),p=g(0),s=g(!1),h=g(null),d=g("stop");B(()=>_.show,n=>{n?(w(),h.value=setInterval(()=>{const t={printer_key:localStorage.getItem("select-printer")};m.postReportDriverPrinter(t).then(a=>{const r=a.data.message.length,u=_.serialArr.length;p.value=r/u*100,r===u&&clearInterval(h.value)})},6e3)):h.value&&clearInterval(h.value)});const w=async()=>{const n=localStorage.getItem("select-printer"),e=_.detailProductDataRes.serialize.print,t={printer_key:n,product:_.detailProductDataRes.item_code,serializes:_.serialArr,datas:{show_field_name_in_qr_code:e.show_field_name_in_qr_code,show_content_label_in_qr_code:{status:e.show_content_label_in_qr_code.status,attributes:{nie:e.show_content_label_in_qr_code.attributes.nie,batch:e.show_content_label_in_qr_code.attributes.batch,expired_date:e.show_content_label_in_qr_code.attributes.expired_date,mfg_date:e.show_content_label_in_qr_code.attributes.mfg_date,het:e.show_content_label_in_qr_code.attributes.het,serial_number:e.show_content_label_in_qr_code.attributes.serial_number}},format_date:"Date"}};await m.postPrintDriverPrinter(t).catch(a=>{if(a.response){const r=a.response.data;c.error(r.message)}})},P=async()=>{const e={printer_key:localStorage.getItem("select-printer")};await m.postPauseDriverPrinter(e).then(()=>{k("confirmClick")}).catch(t=>{if(t.response){const a=t.response.data;c.error(a.message)}}).finally(()=>{s.value=!1})};async function D(){const e={printer_key:localStorage.getItem("select-printer")};s.value=!0,await m.postPauseDriverPrinter(e).then(()=>{c.success("Berhasil Menjeda"),d.value="resume"}).catch(t=>{if(t.response){const a=t.response.data;c.error(a.message)}}).finally(()=>{s.value=!1})}function C(){d.value==="stop"&&D(),d.value==="resume"&&x()}async function x(){const e={printer_key:localStorage.getItem("select-printer")};s.value=!0,await m.postResumeDriverPrinter(e).then(()=>{c.success("Berhasil Lanjutkan"),d.value="stop"}).catch(t=>{if(t.response){const a=t.response.data;c.error(a.message)}}).finally(()=>{s.value=!1})}return(n,e)=>{const t=A,a=$,r=N,u=V,q=E,R=G;return L(),M(R,{show:n.show,onUpdateShow:e[0]||(e[0]=S=>n.$emit("update:show",S))},{default:o(()=>[i(q,{style:{width:"790px","--n-border-radius":"10px"},"content-style":"padding: 10px 28px 28px 28px;",bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{default:o(()=>[i(u,{vertical:""},{default:o(()=>[K,i(t,{style:{display:"block","font-size":"12px","margin-bottom":"5px"}},{default:o(()=>[f(y(`Cetak ${n.serialArr.length} dari ${n.serializeLevelDataRes.list.length}`),1)]),_:1}),i(a,{type:"line",color:"#2D9CDB",percentage:l(p),"indicator-placement":"inside",processing:""},null,8,["percentage"]),i(u,{justify:"center",style:{"margin-top":"24px"}},{default:o(()=>[i(r,{color:"#828282",class:"button-tnt",onClick:v(C,["prevent"]),loading:l(s),disabled:l(p)>=100},{default:o(()=>[f(y(l(d)==="stop"?"Menjeda":"Lanjutkan"),1)]),_:1},8,["onClick","loading","disabled"]),i(r,{type:l(p)>=100?"primary":"error",class:"button-tnt",loading:l(s),onClick:v(P,["prevent"])},{default:o(()=>[f(y(l(p)>=100?"Selesai":"Batalkan Cetak"),1)]),_:1},8,["type","loading","onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])}}});export{T as _};
