import{_ as Ce}from"./t-permission-modal.bdf6acbc.js";import{_ as Be}from"./t-feedback.vue_vue_type_script_setup_true_lang.83eb0b14.js";import{_ as Fe}from"./t-loading.vue_vue_type_script_setup_true_lang.71bf4981.js";import{d as Ne,b as Se,E as Ee,r as c,Q as g,N as M,f as qe,e as Ie,aF as Z,a1 as Ve,p as $e,o as v,c as C,a as B,k as n,w as i,q as p,t as ee,i as a,h as P,F,j as w,ah as ae,af as Ke,am as Ae,an as je,as as Ge,H as Oe,I as He,ak as We,aj as Re,J as Ye,K as Le,v as Je}from"./index.21c0d750.js";import{c as N}from"./constant.549d5c21.js";import{m as O}from"./index.c20e8c5b.js";import{p as ze}from"./principal.7a723d63.js";import{t as Qe}from"./type.86a7443c.js";import{u as Xe}from"./uom.5e6088e0.js";import{h as S}from"./moment.62d3fb0a.js";import{_ as Ze}from"./modal-add-uom.vue_vue_type_script_setup_true_lang.660a5952.js";import{_ as ea}from"./modal-add-principal.vue_vue_type_script_setup_true_lang.ffdeb50f.js";import{_ as aa}from"./modal-add-type.vue_vue_type_script_setup_true_lang.f997e626.js";import{A as T}from"./Add.4f3b52cf.js";import{C as ta}from"./CheckmarkCircleOutline.8fddcae1.js";import{A as oa}from"./AlertCircleOutline.19cf574c.js";import"./getHoldingId.48f570fc.js";import"./getCompanyId.7d0eb93b.js";const na={class:"body-tnt"},la={class:"card-tnt"},ia={class:"bottom-action-button"},ra={class:"action-item"},Ua=Ne({__name:"index",setup(ua){const E=Se(),D=Ee(),x=c(),_=c(""),m=c(!1),q=c(!1),I=c(!1),V=c(!1),$=c(),o=c({}),H=c(null),W=c();W.value={principal_id:{required:!0,message:"Principal tidak boleh kosong",trigger:["input","blur"]},product_type_id:{required:!0,message:"Tipe Produk tidak boleh kosong",trigger:["input","blur"]},short_name:{required:!0,message:"Nama Singkat tidak boleh kosong",trigger:["input","blur"]},long_name:{required:!0,message:"Nama Panjang tidak boleh kosong",trigger:["input","blur"]},unit_of_mearusement:{required:!0,message:"Unit of Measurement tidak boleh kosong",trigger:["input","blur"]},item_code:{required:!0,message:"Kode Item tidak boleh kosong",trigger:["input","blur"]},nie_number:{required:!0,message:"NIE tidak boleh kosong",trigger:"blur"},nie_expired_date:{required:!0,message:"Tanggal Kedaluwarsa tidak boleh kosong",trigger:["blur","change"]},gross_weight:{required:!0,validator(t,e){return e?e.includes(",")?new Error("Berat Kotor tidak boleh menggunakan tanda koma"):/^[-]?[0-9]*\.?[0-9]*$/.test(e)?!0:new Error("Berat Kotor harus angka atau tidak valid"):new Error("Berat Kotor tidak boleh kosong")},trigger:["input","blur"]},master_coli:{required:!0,validator(t,e){return e?e.includes(",")?new Error("Master Coli tidak boleh menggunakan tanda koma"):/^[-]?[0-9]*\.?[0-9]*$/.test(e)?!0:new Error("Master Coli harus angka atau tidak valid"):new Error("Master Coli tidak boleh kosong")},trigger:["input","blur"]},volume:{required:!0,validator(t,e){return e?e.includes(",")?new Error("Volume tidak boleh menggunakan tanda koma"):/^[-]?[0-9]*\.?[0-9]*$/.test(e)?!0:new Error("Volume harus angka atau tidak valid"):new Error("Volume tidak boleh kosong")},trigger:["input","blur"]},gross_value:{required:!0,message:"Gross tidak boleh kosong",trigger:["input","blur"]},gross_unit:{required:!0,message:"Gross tidak boleh kosong",trigger:["input","blur"]},volume_value:{required:!0,message:"Volume tidak boleh kosong",trigger:["input","blur"]},volume_unit:{required:!0,message:"Volume tidak boleh kosong",trigger:["input","blur"]}};const K=c([{key:"add",value:"add",label:()=>g("span",{style:{color:"#0B8F9D",fontWeight:600}},[g(M,{component:T}),"Tambah Unit of Measurement"])}]),A=c([{key:"add",value:"add",label:()=>g("span",{style:{color:"#0B8F9D",fontWeight:600}},[g(M,{component:T}),"Tambah Principal"])}]),j=c([{key:"add",value:"add",label:()=>g("span",{style:{color:"#0B8F9D",fontWeight:600}},[g(M,{component:T}),"Tambah Tipe Produk"])}]),U=c({show:!1});qe(()=>{x.value=Ie.getAuth(),E.params.crud=="create"?(_.value="create",Z.isGranted(N.accessPrivileges.product+".create")?R():U.value.show=!0):(_.value="update",Z.isGranted(N.accessPrivileges.product+".update")?R():U.value.show=!0)});function te(){U.value.show=!1}function R(){oe(),Y(),L(),J("")}async function oe(){if(_.value=="update"){m.value=!0;const t=E.params.id;await O.getDetailProduct(t).then(e=>{ke(e.data),m.value=!1}).catch(e=>{m.value=!1;const s=e.response.data;D.error(s.message)})}}async function Y(t){m.value=!0;const e={limit:1e4};await ze.getPrincipal(e).then(s=>{A.value=[{key:"add",value:"add",label:()=>g("span",{style:{color:"#0B8F9D",fontWeight:600}},[g(M,{component:T}),"Tambah Principal"])}];const u=s.data.data.list;u.forEach(d=>{A.value.push({key:d.name,label:d.name+" - "+d.erp_code,value:d.id})}),t==="after_create"&&(o.value.principal_id=u[s.data.data.list.length-1].id),m.value=!1,l.value.show=!1}).catch(s=>{m.value=!1;const u=s.response.data;D.error(u.message)})}async function L(t){m.value=!0;const e={limit:1e4};await Qe.getType(e).then(s=>{j.value=[{key:"add",value:"add",label:()=>g("span",{style:{color:"#0B8F9D",fontWeight:600}},[g(M,{component:T}),"Tambah Tipe Produk"])}];const u=s.data.data.list;u.forEach(d=>{j.value.push({key:d.name,label:d.name+" - "+d.erp_code,value:d.id})}),t==="after_create"&&(o.value.product_type_id=u[s.data.data.list.length-1].id),m.value=!1,l.value.show=!1}).catch(s=>{m.value=!1;const u=s.response.data;D.error(u.message)})}async function J(t){m.value=!0;const e={limit:1e4};await Xe.getUom(e).then(s=>{K.value=[{key:"add",value:"add",label:()=>g("span",{style:{color:"#0B8F9D",fontWeight:600}},[g(M,{component:T}),"Tambah Unit of Measurement"])}];const u=s.data.data.list;u.forEach(d=>{K.value.push({key:d.name,label:d.name+" - "+d.code,value:d.id})}),t==="after_create"&&(o.value.unit_of_mearusement=u[s.data.data.list.length-1].id),m.value=!1,l.value.show=!1}).catch(s=>{m.value=!1;const u=s.response.data;D.error(u.message)})}function ne(t){t&&($.value=o.value.userType)}function le(t){t&&($.value=o.value.userType)}function ie(t){t&&($.value=o.value.userType)}function re(t){t=="add"&&de()}function ue(t){t=="add"&&ce()}function se(t){t=="add"&&me()}function de(){q.value=!0}function ce(){I.value=!0}function me(){V.value=!0}function pe(){q.value=!1}function _e(){I.value=!1}function fe(){V.value=!1}function ge(t){const e=S(new Date).format("yyyy-MM-DD"),s=S(t).format("yyyy-MM-DD"),u=S(s).diff(e,"months");u>0?o.value.nie_different_date=String(u):o.value.nie_different_date="0"}const k=c(!1),l=c({show:c(!1),icon:Ve(),iconColor:"",hideIcon:!1,title:"",subtitle:"",type:""});function b(){l.value.show=!1}async function z(t){var e;t.preventDefault(),await((e=H.value)==null?void 0:e.validate().then(()=>{be()}).catch(()=>{D.error("Form tidak valid, tolong periksa kembali")}))}function he(){k.value=!0;let t="";x.value.xxtype==="5up3r4dm1n"?t=x.value["xx-usertype-access"].holding_id:t=x.value.users.user_type.id;const e={holding_id:t,principal_id:o.value.principal_id,product_type_id:o.value.product_type_id,short_name:o.value.short_name,long_name:o.value.long_name,unit_of_mearusement:o.value.unit_of_mearusement,item_code:o.value.item_code,nie:{number:o.value.nie_number,expired_date:o.value.nie_expired_date,different_date:Number(o.value.nie_different_date)},gross_weight:Number(o.value.gross_weight),master_coli:Number(o.value.master_coli),volume:Number(o.value.volume)};_.value==="create"?O.createProduct(e).then(()=>{k.value=!1,ve(),b(),setTimeout(()=>{Q()},300)}).catch(s=>{const u=s.response.data;k.value=!1,b(),setTimeout(()=>{X(u)},300)}):O.updateProduct(E.params.id,e).then(()=>{k.value=!1,b(),setTimeout(()=>{Q()},300)}).catch(s=>{const u=s.response.data;k.value=!1,b(),setTimeout(()=>{X(u)},300)})}function ve(){o.value={principal_id:null,product_type_id:null,short_name:"",long_name:"",unit_of_mearusement:null,item_code:"",nie_number:"",nie_expired_date:null,nie_different_date:"",gross_weight:"",master_coli:"",volume:"",gross_value:"",gross_unit:"",volume_value:"",volume_unit:""}}function ke(t){o.value={principal_id:t.principal.id,product_type_id:t.product_types.id,short_name:t.short_name,long_name:t.long_name,unit_of_mearusement:t.uom.id,item_code:t.item_code,nie_number:t.nie.number,nie_expired_date:S(t.nie.expired_date).format("YYYY-MM-DD"),nie_different_date:t.nie.different_date,gross_weight:String(t.gross_weight),master_coli:String(t.master_coli),volume:String(t.volume)}}function be(){l.value.type="confirm",l.value.hideIcon=!0,l.value.title="Konfirmasi",_.value==="create"?l.value.subtitle="Apakah Anda yakin untuk menambah produk?":l.value.subtitle="Apakah Anda yakin untuk mengubah produk?",l.value.show=!0}function Q(){l.value.type="success",l.value.hideIcon=!1,l.value.iconColor="#219653",l.value.icon=ta,_.value==="create"?(l.value.title="Berhasil Tambah Data",l.value.subtitle="Data master produk berhasil ditambahkan"):(l.value.title="Berhasil Ubah Data",l.value.subtitle="Data master produk berhasil diubah"),l.value.show=!0}function X(t){l.value.type="failed",l.value.hideIcon=!1,l.value.iconColor="#EB5757",l.value.icon=oa,l.value.title="Gagal",Object.keys(t.validation).length>0?l.value.subtitle=t.validation:l.value.subtitle=t.message,l.value.show=!0}return(t,e)=>{const s=Ke,u=$e("router-link"),d=Ae,ye=je,we=Fe,Me=Ge,G=Oe,f=He,y=We,Pe=Re,Te=Ye,h=Le,De=Je,Ue=Be,xe=Ce;return v(),C(F,null,[B("div",na,[n(s,{style:{"margin-bottom":"4px"}},{default:i(()=>[p(ee(a(_)==="create"?"Tambah":"Ubah")+" Produk",1)]),_:1}),n(ye,null,{default:i(()=>[n(d,null,{default:i(()=>[n(u,{to:"/setting/master-produk",class:"text-decoration-none"},{default:i(()=>[p(" Master Produk ")]),_:1})]),_:1}),n(d,null,{default:i(()=>[p(ee(a(_)==="create"?"Tambah":"Ubah")+" Produk",1)]),_:1})]),_:1}),B("div",la,[a(m)?(v(),P(we,{key:0})):(v(),C(F,{key:1},[n(Me,{style:{"font-size":"16px","margin-top":"24px"}},{default:i(()=>[p("Tambah Produk Manual")]),_:1}),n(Te,{ref_key:"formRef",ref:H,class:"form-tnt","show-require-mark":!1,"label-width":80,model:a(o),rules:a(W)},{default:i(()=>[n(f,{label:"Principal",path:"principal_id"},{default:i(()=>[n(G,{value:a(o).principal_id,"onUpdate:value":[e[0]||(e[0]=r=>a(o).principal_id=r),ue],options:a(A),disabled:a(m),filterable:"",placeholder:"Pilih Principal","onUpdate:show":le},null,8,["value","options","disabled"])]),_:1}),n(f,{label:"Tipe Produk (Material Group)",path:"product_type_id"},{default:i(()=>[n(G,{value:a(o).product_type_id,"onUpdate:value":[e[1]||(e[1]=r=>a(o).product_type_id=r),se],options:a(j),disabled:a(m),filterable:"",placeholder:"Pilih Tipe Produk","onUpdate:show":ie},null,8,["value","options","disabled"])]),_:1}),n(f,{label:"Nama Singkat (Short Text)",path:"short_name"},{default:i(()=>[n(y,{value:a(o).short_name,"onUpdate:value":e[2]||(e[2]=r=>a(o).short_name=r),placeholder:"Masukkan Nama Singkat"},null,8,["value"])]),_:1}),n(f,{label:"Nama Panjang (Long Text)",path:"long_name"},{default:i(()=>[n(y,{value:a(o).long_name,"onUpdate:value":e[3]||(e[3]=r=>a(o).long_name=r),placeholder:"Masukkan Nama Panjang"},null,8,["value"])]),_:1}),n(f,{label:"Unit of Measurement",path:"unit_of_mearusement"},{default:i(()=>[n(G,{value:a(o).unit_of_mearusement,"onUpdate:value":[e[4]||(e[4]=r=>a(o).unit_of_mearusement=r),re],options:a(K),placeholder:"Masukkan Unit of Measurement",filterable:"","onUpdate:show":ne},null,8,["value","options"])]),_:1}),n(f,{label:"Kode Item",path:"item_code"},{default:i(()=>[n(y,{disabled:a(_)=="update",value:a(o).item_code,"onUpdate:value":e[5]||(e[5]=r=>a(o).item_code=r),placeholder:"Masukkan Kode Item"},null,8,["disabled","value"])]),_:1}),n(f,{label:"Nomor Ijin Edar (NIE)",path:"nie_number"},{default:i(()=>[n(y,{value:a(o).nie_number,"onUpdate:value":e[6]||(e[6]=r=>a(o).nie_number=r),placeholder:"Masukkan NIE"},null,8,["value"])]),_:1}),n(f,{label:"Tanggal Kedaluwarsa (NIE)",path:"nie_expired_date"},{default:i(()=>[n(Pe,{"formatted-value":a(o).nie_expired_date,"onUpdate:formattedValue":e[7]||(e[7]=r=>a(o).nie_expired_date=r),type:"date","value-format":"yyyy-MM-dd",placeholder:"Tentukan Tanggal","onUpdate:value":ge},null,8,["formatted-value"])]),_:1}),n(f,{label:"Selisih Bulan NIE"},{default:i(()=>[n(y,{disabled:"",value:a(o).nie_different_date,"onUpdate:value":e[8]||(e[8]=r=>a(o).nie_different_date=r),placeholder:"Tentukan Jumlah Bulan"},{suffix:i(()=>[p(" bulan ")]),_:1},8,["value"])]),_:1}),n(f,{label:"Berat (gram)",path:"gross_weight"},{default:i(()=>[n(y,{value:a(o).gross_weight,"onUpdate:value":e[9]||(e[9]=r=>a(o).gross_weight=r),placeholder:"Masukkan Berat Kotor",style:{width:"100%"}},null,8,["value"])]),_:1}),n(f,{label:"Master Coli (gram)",path:"master_coli"},{default:i(()=>[n(y,{value:a(o).master_coli,"onUpdate:value":e[10]||(e[10]=r=>a(o).master_coli=r),placeholder:"Masukkan Master Coli",style:{width:"100%"}},null,8,["value"])]),_:1}),n(f,{label:"Volume (cm\xB3)",path:"volume"},{default:i(()=>[n(y,{value:a(o).volume,"onUpdate:value":e[11]||(e[11]=r=>a(o).volume=r),placeholder:"Masukkan Volume"},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])],64))]),B("div",ia,[B("div",ra,[n(u,{to:"/setting/master-produk",class:"text-decoration-none"},{default:i(()=>[n(h,{color:"#828282",class:"button-tnt"},{default:i(()=>[p(" Kembali ")]),_:1})]),_:1}),n(u,{to:{name:"setting-master-produk-id"},class:"text-decoration-none"},{default:i(()=>[n(h,{type:"warning",class:"button-tnt",style:{width:"120px"},loading:a(k)},{default:i(()=>[p(" Detail Data ")]),_:1},8,["loading"])]),_:1}),a(_)==="create"&&t.$filters.isGranted(a(N).accessPrivileges.product+".create")?(v(),P(h,{key:0,color:"#219653",class:"button-tnt",onClick:z},{default:i(()=>[p(" Simpan ")]),_:1})):w("",!0),a(_)==="update"&&t.$filters.isGranted(a(N).accessPrivileges.product+".update")?(v(),P(h,{key:1,color:"#219653",class:"button-tnt",onClick:z},{default:i(()=>[p(" Simpan ")]),_:1})):w("",!0)])])]),n(aa,{"is-show-modal":a(V),onFetchData:e[12]||(e[12]=r=>L("after_create")),onHideModal:fe},null,8,["is-show-modal"]),n(Ze,{"is-show-modal":a(q),onFetchData:e[13]||(e[13]=r=>J("after_create")),onHideModal:pe},null,8,["is-show-modal"]),n(ea,{"is-show-modal":a(I),onFetchData:e[14]||(e[14]=r=>Y("after_create")),onHideModal:_e},null,8,["is-show-modal"]),n(Ue,{show:a(l).show,"onUpdate:show":e[15]||(e[15]=r=>a(l).show=r),icon:a(l).icon,"icon-color":a(l).iconColor,"hide-icon":a(l).hideIcon,title:a(l).title,subtitle:a(l).subtitle},{default:i(()=>[n(De,{justify:"center"},{default:i(()=>[a(l).type=="confirm"?(v(),C(F,{key:0},[n(h,{loading:a(k),color:"#828282",class:"button-tnt",onClick:ae(b,["prevent"])},{default:i(()=>[p(" Batalkan ")]),_:1},8,["loading","onClick"]),n(h,{loading:a(k),color:"#219653",class:"button-tnt",style:{"padding-left":"25px","padding-right":"25px"},onClick:ae(he,["prevent"])},{default:i(()=>[p(" Yakin ")]),_:1},8,["loading","onClick"])],64)):w("",!0),a(l).type=="success"?(v(),C(F,{key:1},[a(_)=="create"?(v(),P(h,{key:0,color:"#828282",class:"button-tnt",onClick:b},{default:i(()=>[p(" Tambah Lainya ")]),_:1})):w("",!0),a(_)=="update"?(v(),P(h,{key:1,color:"#828282",class:"button-tnt",onClick:b},{default:i(()=>[p(" Tutup ")]),_:1})):w("",!0),n(u,{to:{name:"setting-master-produk"},class:"text-decoration-none"},{default:i(()=>[n(h,{color:"#219653",class:"button-tnt"},{default:i(()=>[p(" Kembali ke Beranda ")]),_:1})]),_:1})],64)):w("",!0),a(l).type=="failed"?(v(),P(h,{key:2,color:"#828282",class:"button-tnt",onClick:b},{default:i(()=>[p(" Tutup ")]),_:1})):w("",!0)]),_:1})]),_:1},8,["show","icon","icon-color","hide-icon","title","subtitle"]),n(xe,{show:a(U).show,"onUpdate:show":e[16]||(e[16]=r=>a(U).show=r),"onClick:close":te},null,8,["show"])],64)}}});export{Ua as default};
