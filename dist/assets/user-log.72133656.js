import{h as j}from"./moment.62d3fb0a.js";import{d as S,o as m,h as M,w as l,k as n,a as s,c as k,F as I,g as K,t as y,i as a,aa as O,ab as W,L as B,v as T,a2 as q,a3 as A,b as G,u as J,E as Q,r as f,f as X,q as Y,S as L,af as Z,a5 as ee,a6 as te,H as ae,a7 as ne,a8 as se,ag as oe}from"./index.21c0d750.js";import{_ as le}from"./t-loading.vue_vue_type_script_setup_true_lang.71bf4981.js";import{g as re}from"./getCompanyId.7d0eb93b.js";import{m as ue}from"./master-user.75b9491b.js";import"./getSuperholdingId.94511ad9.js";import"./getHoldingId.48f570fc.js";const ie=s("thead",null,[s("tr",null,[s("th",{style:{width:"2rem","text-align":"center"}},"No"),s("th",{style:{width:"10rem"}},"Tanggal"),s("th",null,"Type"),s("th",null,"Sub Type"),s("th",null,"Keterangan")])],-1),_e={style:{"text-align":"center"}},pe={key:1},de=s("td",{colspan:"5",style:{"text-align":"center"}}," Belum ada data tersedia ",-1),ce=[de],me=S({__name:"t-user-log",props:{data:{default:()=>({})},params:{default:()=>({})}},setup(v){const g=v;return(h,x)=>{const _=O,p=W,d=B,u=T;return m(),M(u,{vertical:"",size:18},{default:l(()=>[n(d,{"content-style":{padding:"15px",backgroundColor:"#eee",borderRadius:"10px"},style:{"border-radius":"10px"}},{default:l(()=>[n(p,{"x-scrollable":""},{default:l(()=>[n(_,{"single-line":!1},{default:l(()=>{var b,t;return[ie,s("tbody",null,[((b=g.data)==null?void 0:b.list.length)>0?(m(!0),k(I,{key:0},K((t=g.data)==null?void 0:t.list,(i,U)=>(m(),k("tr",{key:U},[s("td",_e,y(h.params.limit*(h.params.page-1)+(U+1)),1),s("td",null,y(a(j)(i.created_at).format("yyyy-MM-DD-ss, HH:mm:ss")),1),s("td",null,y(i.type),1),s("td",null,y(i.sub_type),1),s("td",null,y(i.description),1)]))),128)):(m(),k("tr",pe,ce))])]}),_:1})]),_:1})]),_:1})]),_:1})}}});q.interceptors.request.use(A.auth);const ge={async getUserLog(v){return v.company_id=re,(await q.get("/user/v1/log/list",{params:v})).data}},fe={class:"body-tnt"},ve={style:{display:"flex","justify-content":"center"}},ze=S({__name:"user-log",setup(v){const g=G(),h=J(),x=Q(),_=f(!0),p=f(!1),d=f({}),u=f(""),b=f([]),t=f({search:"",sort:"desc",sort_field:"created_at",user_id:null,provider:null,page:1,limit:10});X(()=>{u.value="all",U(),i()});async function i(){g.query.tab&&(u.value=String(g.query.tab),u.value!=="all"?t.value.provider=u.value:t.value.provider=null),_.value=!0,p.value=!0,await ge.getUserLog(t.value).then(r=>{d.value=r.data,_.value=!1,p.value=!1}).catch(r=>{_.value=!1,p.value=!1;const e=r.response.data;x.error(e.message)})}async function U(){_.value=!0;const r={limit:1e3};await ue.getUser(r).then(e=>{e.data.list.forEach(c=>{b.value.push({label:c.name+" ("+c.email+")",value:c.id})})}).catch(e=>{_.value=!1;const c=e.response.data;x.error(c.message)})}function C(r){h.push({query:{tab:r}})}function N(r){t.value.page=1,t.value.limit=r,i()}return(r,e)=>{const c=Z,w=T,z=ee,R=te,$=ae,D=ne,H=se,E=le,V=me,F=oe,P=B;return m(),k("div",fe,[n(w,{vertical:"",size:14},{default:l(()=>[n(w,{vertical:"",size:0},{default:l(()=>[n(c,{style:{"margin-bottom":"0"}},{default:l(()=>[Y("User Log")]),_:1})]),_:1}),n(R,{type:"bar",value:a(u),"onUpdate:value":[e[0]||(e[0]=o=>L(u)?u.value=o:null),C],"tab-style":"border-radius: 10px"},{default:l(()=>[n(z,{disabled:a(p),name:"all",tab:"Semua"},null,8,["disabled"]),n(z,{disabled:a(p),name:"web",tab:"Web"},null,8,["disabled"]),n(z,{disabled:a(p),name:"mobile",tab:"Mobile"},null,8,["disabled"])]),_:1},8,["value"]),n(P,{style:{"border-radius":"10px"}},{default:l(()=>[n(w,{vertical:"",size:18},{default:l(()=>[n(H,{gutter:"16"},{default:l(()=>[n(D,{span:6},{default:l(()=>[n($,{value:a(t).user_id,"onUpdate:value":[e[1]||(e[1]=o=>a(t).user_id=o),e[2]||(e[2]=o=>i())],options:a(b),filterable:"",clearable:"",placeholder:"Pilih User",class:"select-tnt"},null,8,["value","options"])]),_:1})]),_:1}),a(_)?(m(),M(E,{key:0})):(m(),M(V,{key:1,data:a(d),"onUpdate:data":e[3]||(e[3]=o=>L(d)?d.value=o:null),params:a(t),"onUpdate:params":e[4]||(e[4]=o=>L(t)?t.value=o:null)},null,8,["data","params"])),s("div",ve,[n(F,{page:a(t).page,"onUpdate:page":[e[5]||(e[5]=o=>a(t).page=o),i],"page-size":a(t).limit,"onUpdate:pageSize":[e[6]||(e[6]=o=>a(t).limit=o),N],"page-count":a(d).total_page,"page-slot":7,"show-size-picker":a(d).total_data>10,"page-sizes":[10,20,30,40,50]},null,8,["page","page-size","page-count","show-size-picker"])])]),_:1})]),_:1})]),_:1})])}}});export{ze as default};
