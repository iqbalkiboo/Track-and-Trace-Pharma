import{_ as ge}from"./t-modal-scan-serialisasi.vue_vue_type_script_setup_true_lang.9d726df6.js";import{_ as me}from"./t-product-location-modal.vue_vue_type_script_setup_true_lang.ce2f4aa0.js";import{_ as ve}from"./t-table-packing-penerimaan.vue_vue_type_script_setup_true_lang.eeb8e0cd.js";import{_ as ye}from"./t-loading.vue_vue_type_script_setup_true_lang.71bf4981.js";import{d as ke,E as he,b as be,u as we,r as _,W as xe,f as ze,p as Se,o as p,c as k,a as f,k as e,w as a,q as n,t as c,i as Ce,h as x,F as P,j as U,g as G,s as Pe,v as De,ad as Le,ae as Be,ar as Me,ak as je,K as Te,_ as $e,ab as Ie}from"./index.21c0d750.js";import{g as qe}from"./getCompanyId.7d0eb93b.js";import{d as Re,h as Ae,e as Ne,i as Ve,f as Ee,k as Fe,m as H}from"./reception.0ba4dd71.js";const Qe={class:"body-tnt"},Ke=f("div",null,null,-1),Ue={style:{"margin-top":"18px"}},Ge={class:"card-tnt",style:{border:"1px solid #e5e5e5","margin-top":"0",padding:"8px","text-align":"center"}},He={class:"card-tnt",style:{border:"1px solid #e5e5e5","margin-top":"0",padding:"8px","text-align":"center"}},Je={class:"card-tnt",style:{border:"1px solid #e5e5e5","margin-top":"0",padding:"8px","text-align":"center"}},Oe={class:"card-tnt",style:{border:"1px solid #e5e5e5","margin-top":"0",padding:"8px","text-align":"center"}},We={class:"card-tnt"},Xe=["onClick"],Ye=["onClick"],ia=ke({__name:"index",setup(Ze){const y=he(),j=be(),J=we(),h=_(!1),D=_(!1),u=_({}),L=_({}),T=_({}),b=_(null),B=_(),$=_([]),z=_(!1),S=_(!1);async function I(){D.value=!0,await O(),await q(),D.value=!1}async function O(){const s=await Re(j.params.id);u.value=s.data,B.value={page:1,limit:10,reception_id:u.value.id,company_id:""}}async function q(){if(B.value){const s=await Ae(B.value);L.value=s.data}}async function W(s){s.active=!s.active}async function X(s){s.active=!s.active,s.active&&(s.loading=!0,await Y(1,s),s.loading=!1)}async function Y(s,d){var o;const t=await Ne({page:(o=d.page)!=null?o:1,limit:10,product_code:d.code,reception_code:u==null?void 0:u.value.code});d.serialize=t.data.list,d.page=t.data.page,d.total_page=t.data.total_page}function Z(s,d){T.value=s,b.value=d,z.value=!0}async function ee(s){b.value?(await Ve({warehouse_building_id:s,reception_id:j.params.id,packing_code:T.value.packing.code,product_code:b.value.code,company_id:qe}),await q(),y.success("Lokasi produk berhasil diperbarui."),z.value=!1):y.error("Tidak ada produk yang dipilih!")}const M=_(!1),C=_(null);async function ae(s){h.value=!0;const d=await Ee(s).finally(()=>{h.value=!1});M.value=!0,C.value=d.data}async function te(s){h.value=!0;try{const d=await Fe(s);$.value=d.data,h.value=!1}catch(d){if(d.response){const t=d.response.data.message;y.error(t)}h.value=!1}}async function ne(s){await H({codes:[s],status:"approved"}),y.success("Serialize berhasil diupdate.")}async function oe(s){await H({codes:[s],status:"broken"}),y.success("Serialize berhasil diupdate.")}async function se(){return C.value?J.push({name:"penerimaan-id-code",params:{code:C.value.code}}):y.error("Data serialize tidak tersedia.")}async function le(){M.value=!1,S.value=!1}const ie=xe(()=>{var s,d;return(d=(s=u.value)==null?void 0:s.products)==null?void 0:d.reduce((t,o)=>t+o.qty,0)});return ze(()=>{I()}),(s,d)=>{var V,E,F,Q,K;const t=Pe,o=De,R=ye,g=Le,A=Be,de=Me,ce=je,m=Te,ue=Se("router-link"),re=ve,N=$e,_e=Ie,pe=me,fe=ge;return p(),k(P,null,[f("div",Qe,[e(o,{justify:"space-between"},{default:a(()=>[e(o,{vertical:"",size:0},{default:a(()=>[e(o,null,{default:a(()=>[e(t,null,{default:a(()=>[n("ID Manifest : ")]),_:1}),e(t,{strong:""},{default:a(()=>{var i;return[n(c((i=u.value.manifest)==null?void 0:i.code),1)]}),_:1})]),_:1}),e(o,null,{default:a(()=>[e(t,null,{default:a(()=>[n("ID DO : ")]),_:1}),e(t,{strong:""},{default:a(()=>{var i;return[n(c((i=u.value.do)==null?void 0:i.code),1)]}),_:1})]),_:1}),e(o,null,{default:a(()=>[e(t,null,{default:a(()=>[n("Total Item : ")]),_:1}),e(t,{strong:""},{default:a(()=>[n(c(Ce(ie)),1)]),_:1})]),_:1})]),_:1}),e(o,null,{default:a(()=>[e(t,null,{default:a(()=>[n("Tujuan : ")]),_:1}),e(t,{strong:""},{default:a(()=>{var i,w;return[n(c(((w=(i=u.value.do)==null?void 0:i.destination)==null?void 0:w.name)||"-"),1)]}),_:1})]),_:1}),Ke]),_:1}),D.value?(p(),x(R,{key:0})):(p(),k(P,{key:1},[f("div",Ue,[e(A,{cols:"4","item-responsive":"",responsive:"screen","x-gap":"26","y-gap":"16"},{default:a(()=>[e(g,{span:"4 m:1"},{default:a(()=>[f("div",Ge,[e(t,{style:{"font-size":"13px","margin-bottom":"0"}},{default:a(()=>{var i;return[n("Aproved ("+c(((i=u.value.total)==null?void 0:i.approved)||0)+")",1)]}),_:1})])]),_:1}),e(g,{span:"4 m:1"},{default:a(()=>[f("div",He,[e(t,{style:{"font-size":"13px","margin-bottom":"0"}},{default:a(()=>{var i;return[n("Broken ("+c(((i=u.value.total)==null?void 0:i.broken)||0)+")",1)]}),_:1})])]),_:1}),e(g,{span:"4 m:1"},{default:a(()=>[f("div",Je,[e(t,{style:{"font-size":"13px","margin-bottom":"0"}},{default:a(()=>{var i;return[n("Missing ("+c(((i=u.value.total)==null?void 0:i.missing)||0)+")",1)]}),_:1})])]),_:1}),e(g,{span:"4 m:1"},{default:a(()=>[f("div",Oe,[e(t,{style:{"font-size":"13px","margin-bottom":"0"}},{default:a(()=>[n("Pending ("+c(L.value.pending||0)+")",1)]),_:1})])]),_:1})]),_:1})]),f("div",We,[e(o,{justify:"space-between",align:"center"},{default:a(()=>[e(o,{vertical:""},{default:a(()=>[e(de,{style:{"margin-bottom":"0"}},{default:a(()=>[n(" Daftar Packing ")]),_:1}),e(ce,{placeholder:"ID Kemasan/Product"})]),_:1}),u.value.status!="received"?(p(),x(o,{key:0},{default:a(()=>[e(ue,{to:{name:"penerimaan-reception-id-bulk"}},{default:a(()=>[e(m,{type:"error",strong:"",secondary:"",class:"button-tnt"},{default:a(()=>[n("Bulk Aksi")]),_:1})]),_:1}),e(m,{type:"warning",onClick:d[0]||(d[0]=i=>S.value=!0),strong:"",secondary:"",class:"button-tnt"},{default:a(()=>[n("ScanQR")]),_:1})]),_:1})):U("",!0)]),_:1}),e(o,{vertical:"",size:16,style:{"margin-top":"1rem"}},{default:a(()=>{var i,w;return[(p(!0),k(P,null,G((w=(i=L.value)==null?void 0:i.list)!=null?w:[],r=>(p(),k("div",{class:"card-tnt",key:r.id,style:{padding:"1.2rem","margin-top":"0","border-radius":"12px","background-color":"#eee"}},[e(o,{wrap:!1,justify:"space-between",align:"center",style:{position:"relative"}},{default:a(()=>[e(o,{vertical:"",size:0},{default:a(()=>[e(o,{size:3},{default:a(()=>[e(t,null,{default:a(()=>[n("Packing Code : ")]),_:1}),e(t,{strong:""},{default:a(()=>[n(c(r.packing.code),1)]),_:2},1024)]),_:2},1024),e(o,{size:3},{default:a(()=>[e(t,null,{default:a(()=>[n(" Jenis Product : ")]),_:1}),e(t,{strong:""},{default:a(()=>{var l;return[n(c((l=r.total)==null?void 0:l.product),1)]}),_:2},1024)]),_:2},1024),e(o,{size:3},{default:a(()=>[e(t,null,{default:a(()=>[n("Qty Product :")]),_:1}),e(t,{strong:""},{default:a(()=>{var l;return[n(c((l=r.total)==null?void 0:l.qty),1)]}),_:2},1024)]),_:2},1024),e(o,{size:3},{default:a(()=>[e(t,null,{default:a(()=>[n("Qty Batch :")]),_:1}),e(t,{strong:""},{default:a(()=>{var l;return[n(c((l=r.products[0])==null?void 0:l.qty),1)]}),_:2},1024)]),_:2},1024)]),_:2},1024),e(o,{align:"center"},{default:a(()=>[e(t,{style:{"font-size":"0.8rem"}},{default:a(()=>{var l,v;return[n(c((((l=r.total)==null?void 0:l.approved)/((v=r.total)==null?void 0:v.qty)*100).toFixed(2))+"% Approved",1)]}),_:2},1024),f("div",{onClick:l=>W(r)},[e(m,{text:"",type:"primary"},{default:a(()=>[n(c(r.active?"Tampilkan Lebih Sedikit":"Tampilkan Detail"),1)]),_:2},1024)],8,Xe)]),_:2},1024)]),_:2},1024),e(N,{show:!!r.active},{default:a(()=>[e(_e,{"x-scrollable":""},{default:a(()=>[(p(!0),k(P,null,G(r.products,l=>(p(),x(o,{key:l.id,vertical:"",style:{padding:"1rem"}},{default:a(()=>[e(o,{justify:"space-between"},{default:a(()=>[e(o,{align:"center",justify:"space-between"},{default:a(()=>[e(o,{vertical:"",size:0},{default:a(()=>[e(o,{size:4,align:"center"},{default:a(()=>[e(o,null,{default:a(()=>[e(t,null,{default:a(()=>[n("Product : ")]),_:1}),e(t,{strong:"",style:{"margin-bottom":"0"}},{default:a(()=>[n(c(l.name)+" ("+c(l.approved)+"/"+c(l.qty)+") ",1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(o,{size:4,align:"center"},{default:a(()=>[e(o,null,{default:a(()=>[e(t,null,{default:a(()=>[n("Location : ")]),_:1}),e(t,{strong:""},{default:a(()=>[n(c(l.warehouse_building.code)+" - "+c(l.warehouse_building.name),1)]),_:2},1024)]),_:2},1024),u.value.status!="received"?(p(),k("div",{key:0,class:"text_link",onClick:v=>Z(r,l)}," edit ",8,Ye)):U("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(o,{justify:"space-between",style:{"margin-top":"0.5rem"}},{default:a(()=>[e(A,{cols:"3","item-responsive":"",responsive:"screen","x-gap":"26","y-gap":"16"},{default:a(()=>[e(g,{span:"3 m:1"},{default:a(()=>[e(m,{style:{padding:"10px 24px","font-size":"13px"},type:"primary",strong:"",secondary:""},{default:a(()=>[n(" Aproved ("+c(l.approved||0)+") ",1)]),_:2},1024)]),_:2},1024),e(g,{span:"3 m:1"},{default:a(()=>[e(m,{style:{padding:"10px 24px","font-size":"13px"},type:"warning",strong:"",secondary:""},{default:a(()=>[n(" Broken ("+c(l.broken||0)+") ",1)]),_:2},1024)]),_:2},1024),e(g,{span:"3 m:1"},{default:a(()=>[e(m,{style:{padding:"10px 24px","font-size":"13px"},type:"error",strong:"",secondary:""},{default:a(()=>[n(" Missing ("+c(l.missing||0)+") ",1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(m,{onClick:v=>X(l),text:"",type:"primary"},{default:a(()=>[n(c(l.active?"Tampilkan Lebih Sedikit":"Tampilkan Detail"),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),e(N,{show:!!l.active},{default:a(()=>[e(o,{vertical:""},{default:a(()=>{var v;return[l.loading?(p(),x(R,{key:0})):(p(),x(re,{key:1,product:l,reception_code:u.value.code,packing_code:(v=r.packing)==null?void 0:v.code,"data-res":$.value,"onGet:data":te},null,8,["product","reception_code","packing_code","data-res"]))]}),_:2},1024)]),_:2},1032,["show"])]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["show"])]))),128))]}),_:1})])],64))]),e(pe,{show:z.value,"onUpdate:show":d[1]||(d[1]=i=>z.value=i),name:(V=b.value)==null?void 0:V.name,code:(E=b.value)==null?void 0:E.code,warehouse_id:(K=(Q=(F=u.value)==null?void 0:F.do)==null?void 0:Q.destination)==null?void 0:K.id,"onClick:submit":ee},null,8,["show","name","code","warehouse_id"]),e(fe,{show:S.value,"onUpdate:show":d[2]||(d[2]=i=>S.value=i),result:M.value,data:C.value,"onClick:submit":ae,"onClick:continue":se,"onClick:broken":oe,"onClick:approve":ne,"onClick:close":le,"onClick:get":I},null,8,["show","result","data"])],64)}}});export{ia as default};
