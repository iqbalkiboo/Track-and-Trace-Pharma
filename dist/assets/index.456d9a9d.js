import{_ as ra}from"./t-loading.vue_vue_type_script_setup_true_lang.71bf4981.js";import{a2 as D,a3 as ua,d as _a,E as ca,r as u,f as pa,p as ma,o as g,c as v,k as a,w as t,q as b,a as o,i as n,ah as ha,F as O,h as ga,j as $,g as fa,t as m,af as va,am as ya,an as ba,ak as ka,I as wa,ad as Ca,H as Pa,ae as xa,J as Ba,K as Da,v as Ea,as as Ma,a7 as Na,a8 as Sa,aa as Ua,ab as Oa}from"./index.21c0d750.js";import{t as B}from"./feedback.0313b46e.js";import{g as F}from"./getHoldingId.48f570fc.js";import{e as R}from"./exportFromJSON.6e5672c8.js";import{o as j}from"./option.2657b089.js";import"./getCompanyId.7d0eb93b.js";D.interceptors.request.use(ua.auth);const I={async inventoryControl(f){return f.holding_id=F,(await D.post("/report/v1/inventory/control",f,{params:{holding_id:F}})).data},async getWarehouse(f){return(await D.get("/warehouse/v1/list",{params:f})).data},async getBuilding(f){return(await D.get("warehouse/v1/building/list",{params:f})).data}},Ia={class:"body-tnt"},Fa={class:"card-tnt"},Ha={key:0,class:"card-tnt"},Ka={class:"card-tnt"},Wa={class:"table-tnt",style:{"margin-top":"0"}},qa=o("thead",null,[o("tr",null,[o("th",null,"No"),o("th",null,"Plant/Cabang"),o("th",null,"Kode Produk"),o("th",null,"Deskripsi Produk"),o("th",null,"UoM"),o("th",null,"Exp Date"),o("th",null,"Principal"),o("th",null,"Wh Building"),o("th",{style:{"text-align":"right"}},"Stok Sekarang")])],-1),za={"data-label":"No"},La={"data-label":"Plant/Cabang"},Va={"data-label":"Kode Produk"},$a=o("td",{"data-label":"Deskripsi Produk"},m("?"),-1),Ra={"data-label":"UoM"},ja=o("td",{"data-label":"Exp Date"},m("?"),-1),Ja={"data-label":"Principal"},Ta={"data-label":"Wh Building"},Aa={"data-label":"Stok Sekarang",style:{"text-align":"right"}},Ga={key:1},Qa=o("td",{colspan:"8",style:{"text-align":"center"}}," Belum ada data tersedia ",-1),Xa=[Qa],se=_a({__name:"index",setup(f){const _=ca(),C=u(!1),c=u(!1),H=u(!1),K=u(null),s=u({}),E=u([]),M=u([]),N=u([]),S=u([]),k=u([]),W=u();W.value={warehouse_id:{required:!0,message:"Plant/Cabang tidak boleh kosong",trigger:["input","blur"]},company_id:{required:!0,message:"Company tidak boleh kosong",trigger:["input","blur"]}},pa(()=>{J()});async function J(){c.value=!0,T(),await A(),c.value=!1}async function T(){const r={limit:1e4};await j.getPrincipal(r).then(e=>{const l=e.data.list;E.value=[],l.forEach(i=>{E.value.push({key:i.name,label:i.name,value:i.id})}),B.value.show=!1}).catch(e=>{const l=e.response.data;_.error(l.message)})}async function A(){const r={limit:1e4,holding_id:F};await j.getCompany(r).then(e=>{const l=e.data.list;M.value=[],l.forEach(i=>{M.value.push({key:i.name,label:i.name,value:i.id})}),B.value.show=!1}).catch(e=>{const l=e.response.data;_.error(l.message)})}async function G(){const r={limit:1e4,company_id:s.value.company_id};await I.getWarehouse(r).then(e=>{const l=e.data.list;N.value=[],l.forEach(i=>{N.value.push({key:i.name,label:i.name,value:i.id})}),s.value.warehouse_id="",B.value.show=!1}).catch(e=>{const l=e.response.data;_.error(l.message)})}async function Q(){const r={limit:1e4,company_id:s.value.company_id,warehouse_id:s.value.warehouse_id};await I.getBuilding(r).then(e=>{const l=e.data.list;S.value=[],l.forEach(i=>{S.value.push({key:i.name,label:i.name,value:i.id})}),s.value.building_id="",B.value.show=!1}).catch(e=>{const l=e.response.data;_.error(l.message)})}function X(){var r;(r=K.value)==null||r.validate().then(()=>{C.value=!0,c.value=!0;const e={product_code:s.value.product_code,header_batch:s.value.header_batch,principal_id:s.value.principal_id,company_id:s.value.company_id,warehouse_id:s.value.warehouse_id,building_id:s.value.building_id};I.inventoryControl(e).then(l=>{C.value=!1,c.value=!1,k.value=l.data,H.value=!0}).catch(l=>{const i=l.response.data;_.error(i.message),C.value=!1,c.value=!1})}).catch(()=>{_.error("Form tidak valid, tolong periksa kembali")})}function Y(){const r=[];k.value.forEach((h,U)=>{var w,p;r.push({No:U+1,"Plant/Cabang":h.warehouse_name,"Kode Produk":h.product_code,"Deskripsi Produk":"?",UoM:(w=h.uom)==null?void 0:w.name,"Exp Date":"?",Principal:(p=h.principal)==null?void 0:p.name,"Wh Building":h.warehouse_building_code,"Stok Sekarang":h.stock_now})});const e=r,l="Laporan_Inventory_Data",i=R.types.csv;e&&R({data:e,fileName:l,exportType:i})}function Z(){G()}function aa(){Q()}return(r,e)=>{const l=va,i=ya,h=ba,U=ma("h-3"),w=ka,p=wa,y=Ca,P=Pa,ea=xa,ta=Ba,q=Da,x=Ea,na=ra,oa=Ma,sa=Na,la=Sa,ia=Ua,da=Oa;return g(),v("div",Ia,[a(l,{style:{"margin-bottom":"4px"}},{default:t(()=>[b("Inventory Control Data")]),_:1}),a(h,null,{default:t(()=>[a(i,null,{default:t(()=>[b("Inventory Control Data")]),_:1})]),_:1}),o("div",Fa,[a(x,{vertical:"",size:24},{default:t(()=>[a(U,{style:{"font-weight":"500","font-size":"16px"}},{default:t(()=>[b("Form Inventory Control Data")]),_:1}),a(ta,{ref_key:"formRef",ref:K,class:"form-tnt","show-require-mark":!1,"label-width":80,model:n(s),rules:n(W)},{default:t(()=>[a(ea,{cols:"4","item-responsive":"",responsive:"screen","x-gap":"26","y-gap":"0"},{default:t(()=>[a(y,{span:"4 m:2"},{default:t(()=>[a(p,{label:"Kode Produk (Optional)",path:"product_code"},{default:t(()=>[a(w,{value:n(s).product_code,"onUpdate:value":e[0]||(e[0]=d=>n(s).product_code=d),placeholder:"Masukkan Kode Produk",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1}),a(y,{span:"4 m:2"},{default:t(()=>[a(p,{label:"Header Batch",path:"header_batch"},{default:t(()=>[a(w,{value:n(s).header_batch,"onUpdate:value":e[1]||(e[1]=d=>n(s).header_batch=d),placeholder:"Masukkan Header Batch",style:{width:"100%"}},null,8,["value"])]),_:1})]),_:1}),a(y,{span:"4 m:2"},{default:t(()=>[a(p,{label:"Principal (Optional)",path:"principal_id"},{default:t(()=>[a(P,{disabled:n(c),value:n(s).principal_id,"onUpdate:value":e[2]||(e[2]=d=>n(s).principal_id=d),options:n(E),filterable:"",placeholder:"Pilih Principal",style:{width:"100%"}},null,8,["disabled","value","options"])]),_:1})]),_:1}),a(y,{span:"4 m:2"},{default:t(()=>[a(p,{label:"Company",path:"company_id"},{default:t(()=>[a(P,{disabled:n(c),value:n(s).company_id,"onUpdate:value":[e[3]||(e[3]=d=>n(s).company_id=d),Z],options:n(M),filterable:"",placeholder:"Pilih Company",style:{width:"100%"}},null,8,["disabled","value","options"])]),_:1})]),_:1}),a(y,{span:"4 m:2"},{default:t(()=>[a(p,{label:"Cabang/Plant",path:"warehouse_id"},{default:t(()=>[a(P,{disabled:n(c),value:n(s).warehouse_id,"onUpdate:value":[e[4]||(e[4]=d=>n(s).warehouse_id=d),aa],options:n(N),filterable:"",placeholder:"Pilih Cabang/Plant",style:{width:"100%"}},null,8,["disabled","value","options"])]),_:1})]),_:1}),a(y,{span:"4 m:2"},{default:t(()=>[a(p,{label:"Bulding (Optional)",path:"building_id"},{default:t(()=>[a(P,{value:n(s).building_id,"onUpdate:value":e[5]||(e[5]=d=>n(s).building_id=d),options:n(S),placeholder:"Pilih Bulding",style:{width:"100%"}},null,8,["value","options"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"]),a(x,{justify:"center"},{default:t(()=>[a(q,{loading:n(c),type:"primary",class:"button-tnt",onClick:ha(X,["prevent"])},{default:t(()=>[b(" Cari ")]),_:1},8,["loading","onClick"])]),_:1})]),_:1})]),n(C)?(g(),v("div",Ha,[a(na)])):(g(),v(O,{key:1},[n(H)?(g(),v(O,{key:0},[a(x,{vertical:"",size:0,style:{"margin-top":"24px"}},{default:t(()=>[a(oa,{style:{"font-weight":"500","font-size":"16px","margin-bottom":"0"}},{default:t(()=>[b(" Laporan Inventory Control Data ")]),_:1}),a(la,{gutter:"16",style:{"margin-top":"14px"}},{default:t(()=>[a(sa,{span:24},{default:t(()=>[n(k).length>0?(g(),ga(x,{key:0,vertical:"",size:0,align:"end"},{default:t(()=>[a(q,{type:"primary",class:"button-tnt",onClick:Y},{default:t(()=>[b(" Export Csv ")]),_:1})]),_:1})):$("",!0)]),_:1})]),_:1})]),_:1}),o("div",Ka,[o("div",Wa,[a(da,{"x-scrollable":""},{default:t(()=>[a(ia,{"single-line":!1},{default:t(()=>[qa,o("tbody",null,[n(k).length>0?(g(!0),v(O,{key:0},fa(n(k),(d,z)=>{var L,V;return g(),v("tr",{key:z},[o("td",za,m(z+1),1),o("td",La,m(d.warehouse_name),1),o("td",Va,m(d.product_code),1),$a,o("td",Ra,m((L=d.uom)==null?void 0:L.name),1),ja,o("td",Ja,m((V=d.principal)==null?void 0:V.name),1),o("td",Ta,m(d.warehouse_building_code),1),o("td",Aa,m(d.stock_now),1)])}),128)):(g(),v("tr",Ga,Xa))])]),_:1})]),_:1})])])],64)):$("",!0)],64))])}}});export{se as default};
