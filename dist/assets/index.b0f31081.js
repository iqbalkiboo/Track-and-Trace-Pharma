import{_ as ce}from"./t-permission-modal.bdf6acbc.js";import{_ as pe}from"./t-feedback.vue_vue_type_script_setup_true_lang.83eb0b14.js";import{_ as _e}from"./t-loading.vue_vue_type_script_setup_true_lang.71bf4981.js";import{d as me,b as ve,E as ge,r as d,a1 as he,f as be,e as fe,aF as J,p as ke,o as g,c as A,a as C,k as i,w as o,q as p,t as Y,i as a,h as y,j as P,F as S,ah as we,af as ye,am as Pe,an as Ee,ak as Ce,I as Ne,s as Ue,H as Ve,J as De,K as Me,v as qe}from"./index.21c0d750.js";import{c as U}from"./constant.549d5c21.js";import{m as I}from"./master-vendor.ed83cfb1.js";import{o as V}from"./option.2657b089.js";import{m as Ke}from"./master-warehouse.353b4b3b.js";import{C as Te}from"./CheckmarkCircleOutline.8fddcae1.js";import{A as xe}from"./AlertCircleOutline.19cf574c.js";import"./getHoldingId.48f570fc.js";import"./getCompanyId.7d0eb93b.js";const Ae={class:"body-tnt"},Se={class:"card-tnt"},Ie=C("div",{class:"divider-horizontal-tnt",style:{"border-color":"#dfdfdf","margin-top":"10px"}},null,-1),Fe={class:"bottom-action-button"},Le={class:"action-item"},Xe=me({__name:"index",setup($e){const D=ve(),b=ge(),Q=d(),N=d(!1),m=d(!1),_=d(""),M=d([]),q=d([]),K=d([]),T=d([]),F=d([]),X=d([{label:"Aktif",value:1},{label:"Tidak Aktif",value:0}]),l=d({show:d(!1),icon:he(),iconColor:"",hideIcon:!1,title:"",subtitle:"",type:""}),t=d({status:1}),L=d(),$=d();$.value={name:{required:!0,message:"Nama vendor tidak boleh kosong",trigger:["input","blur"]},province_id:{required:!0,message:"Provinsi tidak boleh kosong",trigger:["input","blur"]},district_id:{required:!0,message:"Kota/Kabupaten tidak boleh kosong",trigger:["input","blur"]},sub_district_id:{required:!0,message:"Kecamatan tidak boleh kosong",trigger:["input","blur"]},urban_village_id:{required:!0,message:"Kelurahan tidak boleh kosong",trigger:["input","blur"]},address:{required:!0,message:"Keterangan alamat tidak boleh kosong",trigger:["input","blur"]},longitude:{required:!0,validator(n,e){if(!e)return new Error("Longitude tidak boleh kosong");if(e.includes(","))return new Error("Longitude tidak boleh menggunakan tanda koma");if(!/^[-]?[0-9]*\.?[0-9]*$/.test(e))return new Error("Longitude harus angka atau tidak valid")},trigger:["input","blur"]},latitude:{required:!0,validator(n,e){if(!e)return new Error("Latitude tidak boleh kosong");if(e.includes(","))return new Error("Latitude tidak boleh menggunakan tanda koma");if(!/^[-]?[0-9]*\.?[0-9]*$/.test(e))return new Error("Latitude harus angka atau tidak valid")},trigger:["input","blur"]},warehouse_id:{type:"array",required:!0,message:"Nama plant/cabang tidak boleh kosong",trigger:["input","blur"]},erp_code:{required:!0,message:"Kode ERP tidak boleh kosong",trigger:["input","blur"]},pic_name:{required:!0,message:"Nama PIC tidak boleh kosong",trigger:["input","blur"]},pic_phone:{required:!0,validator(n,e){if(e)if(/^\d*$/.test(e)){if(e.length<8)return new Error("No. Hp kurang dari 8 angka")}else return new Error("No. Telp harus angka");else return new Error("No. Telp tidak boleh kosong");return!0},trigger:["input","blur"]},pic_email:{required:!0,validator(n,e){const u=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;if(e){if(!e.match(u))return new Error("Email tidak valid")}else return new Error("Email tidak boleh kosong");return!0},trigger:["input","blur"]},npwp:{required:!0,message:"NPWP tidak boleh kosong",trigger:["input","blur"]},status:{type:"number",required:!0,message:"Status tidak boleh kosong",trigger:["input","blur"]}};const E=d({show:!1});be(()=>{Q.value=fe.getAuth(),D.params.crud=="create"?(_.value="create",J.isGranted(U.accessPrivileges.vendor+".create")?B():E.value.show=!0):(_.value="update",J.isGranted(U.accessPrivileges.vendor+".update")?B():E.value.show=!0)});function ee(){E.value.show=!1}async function B(){if(_.value=="update"){N.value=!0;const n=D.params.id;await j(),await O(),await W(),await R(),await G(),await I.getDetailVendor(n).then(e=>{te(e.data),N.value=!1}).catch(e=>{N.value=!1;const u=e.response.data;b.error(u.message)})}else O(),j()}async function O(){t.value.province_id=null;const n={limit:1e3};await V.getProvinces(n).then(e=>{K.value=[],e.data.list.forEach(r=>{K.value.push({label:r.name,value:r.id})})}).catch(e=>{const u=e.response.data;b.error(u.message)})}async function W(){t.value.district_id=null;const n={limit:1e3,province_id:t.value.province_id};await V.getDistricts(n).then(e=>{M.value=[],e.data.list.forEach(r=>{M.value.push({label:r.name,value:r.id})})}).catch(e=>{const u=e.response.data;b.error(u.message)})}async function R(){t.value.sub_district_id=null;const n={limit:1e3,district_id:t.value.district_id};await V.getSubDistricts(n).then(e=>{q.value=[],e.data.list.forEach(r=>{q.value.push({label:r.name,value:r.id})})}).catch(e=>{const u=e.response.data;b.error(u.message)})}async function G(){t.value.urban_village_id=null;const n={limit:1e3,sub_district_id:t.value.sub_district_id};await V.getUrbanVillages(n).then(e=>{T.value=[],e.data.list.forEach(r=>{T.value.push({label:r.name,value:r.id})})}).catch(e=>{const u=e.response.data;b.error(u.message)})}async function j(){const n={limit:1e4};await Ke.getWarehouse(n).then(e=>{e.data.list.forEach(r=>{F.value.push({key:r.key,value:r.id,label:r.name})})}).catch(e=>{const u=e.response.data;b.error(u.message)})}function ae(){var u;m.value=!0;let n=[];t.value.warehouse_id.forEach(r=>{n.push(r)});let e={name:t.value.name,province_id:t.value.province_id,district_id:t.value.district_id,sub_district_id:t.value.sub_district_id,urban_village_id:t.value.urban_village_id,detail:t.value.address,latitude:parseInt(t.value.latitude),longitude:parseInt(t.value.longitude),erp_code:t.value.erp_code,pic_name:t.value.pic_name,pic_phone:t.value.pic_phone,pic_email:t.value.pic_email,npwp:(u=t.value)==null?void 0:u.npwp,status:t.value.status,warehouse_id:n};if(_.value=="create")I.createVendor(e).then(()=>{m.value=!1,ie(),f(),setTimeout(()=>{z()},300)}).catch(r=>{const k=r.response.data;m.value=!1,f(),setTimeout(()=>{H(k)},300)});else{const r=D.params.id;I.updateVendor(r,e).then(()=>{m.value=!1,f(),setTimeout(()=>{z()},300)}).catch(k=>{const x=k.response.data;m.value=!1,f(),setTimeout(()=>{H(x)},300)})}}function te(n){t.value={name:n.name,province_id:n.address.province.id,district_id:n.address.district.id,sub_district_id:n.address.sub_district.id,urban_village_id:n.address.urban_village.id,address:n.address.detail,latitude:String(n.location.coordinates[0]),longitude:String(n.location.coordinates[1]),erp_code:n.erp_code,pic_name:n.pic.name,pic_phone:n.pic.phone,pic_email:n.pic.email,status:n.status.value,npwp:n.npwp,warehouse_id:[]},n.warehouse.forEach(e=>{t.value.warehouse_id.push(e.id)})}function ie(){t.value={name:"",province_id:null,district_id:null,sub_district_id:null,urban_village_id:null,address:"",longitude:"",latitude:"",warehouse_id:[],erp_code:"",pic_name:"",pic_phone:"",pic_email:"",npwp:"",status:1}}function f(){l.value.show=!1}function ne(){l.value.type="confirm",l.value.hideIcon=!0,l.value.title="Konfirmasi",_.value=="create"?l.value.subtitle="Apakah Anda yakin untuk menambah data vendor?":l.value.subtitle="Apakah Anda yakin untuk mengubah data vendor?",l.value.show=!0}function z(){l.value.type="success",l.value.hideIcon=!1,l.value.iconColor="#219653",l.value.icon=Te,_.value=="create"?(l.value.title="Berhasil Tambah Data",l.value.subtitle="Data vendor berhasil ditambahkan"):(l.value.title="Berhasil Ubah Data",l.value.subtitle="Data vendor berhasil diubah"),l.value.show=!0}function H(n){l.value.type="failed",l.value.hideIcon=!1,l.value.iconColor="#EB5757",l.value.icon=xe,l.value.title="Gagal",Object.keys(n.validation).length>0?l.value.subtitle=n.validation:l.value.subtitle=n.message,l.value.show=!0}async function Z(n){var e;n.preventDefault(),await((e=L.value)==null?void 0:e.validate().then(()=>{ne()}).catch(()=>{b.error("Form tidak valid, tolong periksa kembali")}))}return(n,e)=>{const u=ye,r=ke("router-link"),k=Pe,x=Ee,le=_e,v=Ce,c=Ne,oe=Ue,w=Ve,se=De,h=Me,re=qe,ue=pe,de=ce;return g(),A(S,null,[C("div",Ae,[i(u,{style:{"margin-bottom":"4px"}},{default:o(()=>[p(Y(a(_)=="create"?"Tambah Vendor":"Edit Vendor"),1)]),_:1}),i(x,null,{default:o(()=>[i(k,null,{default:o(()=>[i(r,{to:"/setting/master-vendor",class:"text-decoration-none"},{default:o(()=>[p(" Master Vendor ")]),_:1})]),_:1}),i(k,null,{default:o(()=>[p(Y(a(_)=="create"?"Tambah vendor":"Edit vendor"),1)]),_:1})]),_:1}),C("div",Se,[a(N)?(g(),y(le,{key:0})):(g(),y(se,{key:1,ref_key:"formRef",ref:L,model:a(t),rules:a($),"show-require-mark":!1,class:"form-tnt"},{default:o(()=>[i(c,{path:"name",label:"Nama Vendor"},{default:o(()=>[i(v,{value:a(t).name,"onUpdate:value":e[0]||(e[0]=s=>a(t).name=s),placeholder:"Masukkan Nama Vendor"},null,8,["value"])]),_:1}),Ie,i(oe,{style:{display:"block","font-weight":"500",margin:"10px 0 15px 0"}},{default:o(()=>[p("Alamat")]),_:1}),i(c,{label:"Provinsi",path:"province_id"},{default:o(()=>[i(w,{value:a(t).province_id,"onUpdate:value":[e[1]||(e[1]=s=>a(t).province_id=s),W],options:a(K),filterable:"",placeholder:"Pilih provinsi"},null,8,["value","options"])]),_:1}),i(c,{label:"Kota/Kabupaten",path:"district_id"},{default:o(()=>[i(w,{value:a(t).district_id,"onUpdate:value":[e[2]||(e[2]=s=>a(t).district_id=s),R],options:a(M),filterable:"",placeholder:"Pilih kota/kabupaten"},null,8,["value","options"])]),_:1}),i(c,{label:"Kecamatan",path:"sub_district_id"},{default:o(()=>[i(w,{value:a(t).sub_district_id,"onUpdate:value":[e[3]||(e[3]=s=>a(t).sub_district_id=s),G],options:a(q),filterable:"",placeholder:"Pilih kecamatan"},null,8,["value","options"])]),_:1}),i(c,{label:"Kelurahan",path:"urban_village_id"},{default:o(()=>[i(w,{value:a(t).urban_village_id,"onUpdate:value":e[4]||(e[4]=s=>a(t).urban_village_id=s),options:a(T),filterable:"",placeholder:"Pilih kecamatan"},null,8,["value","options"])]),_:1}),i(c,{label:"Keterangan Alamat (Nama jalan dan No. Bangunan)",path:"address"},{default:o(()=>[i(v,{value:a(t).address,"onUpdate:value":e[5]||(e[5]=s=>a(t).address=s),placeholder:"Masukkan keterangan alamat"},null,8,["value"])]),_:1}),i(c,{label:"Longitude",path:"longitude"},{default:o(()=>[i(v,{value:a(t).longitude,"onUpdate:value":e[6]||(e[6]=s=>a(t).longitude=s),placeholder:"Masukkan longitude"},null,8,["value"])]),_:1}),i(c,{label:"Latitude",path:"latitude"},{default:o(()=>[i(v,{value:a(t).latitude,"onUpdate:value":e[7]||(e[7]=s=>a(t).latitude=s),placeholder:"Masukkan latitude"},null,8,["value"])]),_:1}),i(c,{path:"warehouse_id",label:"Nama Plant/Cabang"},{default:o(()=>[i(w,{multiple:"",value:a(t).warehouse_id,"onUpdate:value":e[8]||(e[8]=s=>a(t).warehouse_id=s),options:a(F),placeholder:"Pilih Plant/Cabang",style:{width:"100%"}},null,8,["value","options"])]),_:1}),i(c,{path:"erp_code",label:"Kode ERP"},{default:o(()=>[i(v,{value:a(t).erp_code,"onUpdate:value":e[9]||(e[9]=s=>a(t).erp_code=s),placeholder:"Masukkan Kode ERP"},null,8,["value"])]),_:1}),i(c,{path:"pic_name",label:"Nama PIC"},{default:o(()=>[i(v,{value:a(t).pic_name,"onUpdate:value":e[10]||(e[10]=s=>a(t).pic_name=s),placeholder:"Masukkan Nama PIC"},null,8,["value"])]),_:1}),i(c,{path:"pic_phone",label:"No. Telp PIC"},{default:o(()=>[i(v,{value:a(t).pic_phone,"onUpdate:value":e[11]||(e[11]=s=>a(t).pic_phone=s),placeholder:"Masukkan No. Telp"},null,8,["value"])]),_:1}),i(c,{path:"pic_email",label:"Email PIC"},{default:o(()=>[i(v,{value:a(t).pic_email,"onUpdate:value":e[12]||(e[12]=s=>a(t).pic_email=s),placeholder:"Masukkan Email"},null,8,["value"])]),_:1}),i(c,{path:"npwp",label:"NPWP"},{default:o(()=>[i(v,{value:a(t).npwp,"onUpdate:value":e[13]||(e[13]=s=>a(t).npwp=s),placeholder:"Masukkan NPWP"},null,8,["value"])]),_:1}),i(c,{path:"status",label:"Status"},{default:o(()=>[i(w,{value:a(t).status,"onUpdate:value":e[14]||(e[14]=s=>a(t).status=s),options:a(X),placeholder:"Pilih Status User",style:{width:"100%"}},null,8,["value","options"])]),_:1})]),_:1},8,["model","rules"]))]),C("div",Fe,[C("div",Le,[i(r,{to:{name:"setting-master-vendor"},class:"text-decoration-none"},{default:o(()=>[i(h,{color:"#828282",class:"button-tnt"},{default:o(()=>[p("Kembali")]),_:1})]),_:1}),a(_)==="create"&&n.$filters.isGranted(a(U).accessPrivileges.vendor+".create")?(g(),y(h,{key:0,color:"#219653",class:"button-tnt",loading:a(m),onClick:Z},{default:o(()=>[p(" Simpan ")]),_:1},8,["loading"])):P("",!0),a(_)==="update"&&n.$filters.isGranted(a(U).accessPrivileges.vendor+".update")?(g(),y(h,{key:1,color:"#219653",class:"button-tnt",loading:a(m),onClick:Z},{default:o(()=>[p(" Simpan ")]),_:1},8,["loading"])):P("",!0)])])]),i(ue,{show:a(l).show,"onUpdate:show":e[15]||(e[15]=s=>a(l).show=s),icon:a(l).icon,"icon-color":a(l).iconColor,"hide-icon":a(l).hideIcon,title:a(l).title,subtitle:a(l).subtitle},{default:o(()=>[i(re,{justify:"center"},{default:o(()=>[a(l).type=="confirm"?(g(),A(S,{key:0},[i(h,{loading:a(m),color:"#828282",class:"button-tnt",onClick:f},{default:o(()=>[p(" Tutup ")]),_:1},8,["loading"]),i(h,{loading:a(m),color:"#219653",class:"button-tnt",style:{"padding-left":"25px","padding-right":"25px"},onClick:we(ae,["prevent"])},{default:o(()=>[p(" Yakin ")]),_:1},8,["loading","onClick"])],64)):P("",!0),a(l).type=="success"?(g(),A(S,{key:1},[a(_)=="create"?(g(),y(h,{key:0,color:"#828282",class:"button-tnt",onClick:f},{default:o(()=>[p(" Tambah Lainya ")]),_:1})):P("",!0),i(r,{to:{name:"setting-master-vendor"},class:"text-decoration-none"},{default:o(()=>[i(h,{color:"#219653",class:"button-tnt"},{default:o(()=>[p(" Kembali ke Beranda ")]),_:1})]),_:1})],64)):P("",!0),a(l).type=="failed"?(g(),y(h,{key:2,color:"#828282",class:"button-tnt",onClick:f},{default:o(()=>[p(" Tutup ")]),_:1})):P("",!0)]),_:1})]),_:1},8,["show","icon","icon-color","hide-icon","title","subtitle"]),i(de,{show:a(E).show,"onUpdate:show":e[16]||(e[16]=s=>a(E).show=s),"onClick:close":ee},null,8,["show"])],64)}}});export{Xe as default};
