import{_ as ye}from"./t-feedback.vue_vue_type_script_setup_true_lang.83eb0b14.js";import{_ as ke}from"./t-loading.vue_vue_type_script_setup_true_lang.71bf4981.js";import{d as G,o as h,c as D,a as r,u as be,b as we,r as _,E as De,W as j,f as xe,p as Ce,i as a,h as F,F as A,k as e,w as t,q as s,ah as Me,t as p,g as Te,j as K,af as $e,am as je,an as Ae,a7 as Se,K as Ne,a8 as Be,s as Oe,v as Ve,aj as Ie,as as Pe,a9 as Ue,N as Le,H as qe,I as He,J as ze,_ as Fe,L as Ke,a4 as R}from"./index.21c0d750.js";import{g as E}from"./getCompanyId.7d0eb93b.js";import{a as B}from"./http.7151dc47.js";import{h as Re}from"./moment.62d3fb0a.js";import{a as O}from"./assign-driver.a4158cbc.js";import{t as u,h as Ee}from"./feedback.0313b46e.js";import{A as Ge}from"./Add.4f3b52cf.js";import"./CheckmarkCircleOutline.8fddcae1.js";const Je={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},We=r("path",{d:"M432 144l-28.67 275.74A32 32 0 0 1 371.55 448H140.46a32 32 0 0 1-31.78-28.26L80 144",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),Ye=r("rect",{x:"32",y:"64",width:"448",height:"80",rx:"16",ry:"16",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),Qe=r("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M312 240L200 352"},null,-1),Xe=r("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M312 352L200 240"},null,-1),Ze=[We,Ye,Qe,Xe],et=G({name:"TrashBinOutline",render:function(S,b){return h(),D("svg",Je,Ze)}}),tt={class:"body-tnt"},nt=r("span",null," ID Manifest : ",-1),at=r("span",null," ID DO : ",-1),lt=r("span",{style:{"margin-top":"5px","margin-right":"10px"}}," Target Tanggal Pengiriman : ",-1),ot=r("span",null," Total Packing : ",-1),st=r("span",null," Total Manifest : ",-1),it=r("span",null," NO PO : ",-1),rt=r("span",null," Tanggal DO : ",-1),ut=r("div",{style:{"margin-right":"20px"}},"Status :",-1),dt=r("span",{style:{"text-transform":"capitalize"}},"Siap Dikirim",-1),ct={style:{display:"flex","justify-content":"end"}},_t=r("span",null,"Tipe Kendaraan : ",-1),pt=r("span",null,"Pemilik : ",-1),ft=r("span",null," Sisa Volume : ",-1),mt=r("sup",null," 3 ",-1),vt=G({__name:"add-driver",setup(J){const S=be(),b=we(),C=_(""),m=_([{id:"",name:"",vehicle_category:null,vehicle:{id:null}}]),M=_({}),w=De(),y=_(!1),V=_(!1),T=_({target_delivery_date:null}),N=_({limit:1e4,company_id:E,status:1}),I=_({user_type:"driver",company_id:E,limit:1e4,status:1}),x=_({}),v=_({}),W=_([{driver:void 0,name:void 0,vehicle_id:void 0,status:!1}]);function Y(){u.value.type="assign",u.value.hideIcon=!0,u.value.iconColor="#219653",u.value.title="Assign",u.value.subtitle="Apakah Anda yakin untuk mengassign data driver?",u.value.show=!0}async function P(){y.value=!0,await O.getDetailManifest(b.params.id).then(async l=>{v.value=l.data,y.value=!1}).catch(l=>{y.value=!1;const o=l.response.data;m.error(o.message)})}const{data:Q}=B("/user/v1/list",{params:I}),{data:X}=B("vehicle/v1/list",{params:N});B(j(()=>`vehicle/v1/detail/${C.value}`),{params:N,queryOptions:{enabled:j(()=>!!C.value),onSuccess:l=>{x.value[C.value]=l==null?void 0:l.data}}});const Z=j(()=>{var l,o;return(o=(l=Q.value)==null?void 0:l.data.list.map(c=>({label:c.name,value:c.id,disabled:!1})))!=null?o:[]}),ee=j(()=>{var l,o;return(o=(l=X.value)==null?void 0:l.data.list.map(c=>({label:c.plate_number,value:c.id})))!=null?o:[]});async function te(){if(M.value.value)w.error(`Duplikat Driver ${M.value.label}`);else if(T.value.target_delivery_date){y.value=!0;const l={drivers:m.value.map(o=>{var c;return{id:o.id,vehicle_id:(c=o.vehicle)==null?void 0:c.id,status:!0}}),target_delivery_date:T.value.target_delivery_date,manifest_id:b.params.id};try{await O.postDriver(l),y.value=!1,u.value.show=!1,S.push({name:"pengiriman-loading-driver-id-detail",params:{id:b.params.id}})}catch(o){if(y.value=!1,o.response){const c=o.response.data;w.error(c.message)}}}else w.error("Harus Mengisi Target Tanggal Pengiriman")}function ne(l,o){l.status!=="assigned"?l.name?O.deleteDriver({driver_id:l.id,manifest_id:b.params.id}).then(()=>{w.success("Berhasil menghapus Driver"),W.value.splice(o,1),P()}).catch(()=>{w.error("Gagal menghapus Driver")}):m.value.splice(o,1):w.error("Tidak Dapat Menghapus, Status Tidak Assigned")}function ae(){m.value.push({id:"",name:"",vehicle_category:null,vehicle:{id:null}})}const le=l=>{I.value.q=l},oe=l=>{N.value.q=l},se=l=>{C.value=l},ie=l=>{for(let o=0;o<m.value.length-1;o++)if(m.value[o].id===l){M.value={value:!0,label:m.value[o].name};return}else M.value={value:!1}};function re(){localStorage.setItem("manifest_id",b.params.id);const l=S.resolve({path:"/print/loading-manifest"});window.open(l.href,"_blank")}return xe(()=>{P()}),(l,o)=>{const c=ke,ue=$e,U=je,de=Ae,$=Se,k=Ne,L=Be,f=Oe,i=Ve,ce=Ie,_e=Pe,pe=Ue,q=Le,H=qe,z=He,fe=ze,me=Fe,ve=Ke,ge=Ce("router-link"),he=ye;return h(),D(A,null,[r("div",tt,[a(y)?(h(),F(c,{key:0})):(h(),D(A,{key:1},[e(L,{cols:12,style:{display:"flex","justify-content":"space-between","align-items":"center"}},{default:t(()=>[e($,{span:12},{default:t(()=>[e(ue,{style:{"margin-bottom":"4px"}},{default:t(()=>[s("Add Driver")]),_:1}),e(de,null,{default:t(()=>[e(U,null,{default:t(()=>[s("Assign Driver")]),_:1}),e(U,null,{default:t(()=>[s("Add Driver")]),_:1})]),_:1})]),_:1}),e($,{span:12},{default:t(()=>[e(k,{ghost:"",type:"primary",class:"button-tnt",style:{float:"right"},onClick:Me(re,["prevent"])},{default:t(()=>[s(" Cetak Manifest ")]),_:1},8,["onClick"])]),_:1})]),_:1}),e(L,{cols:12,style:{display:"flex","justify-content":"space-between","align-items":"center","margin-top":"1rem"}},{default:t(()=>[e($,{span:12},{default:t(()=>[e(i,{vertical:"",size:0},{default:t(()=>[e(i,null,{default:t(()=>[nt,e(f,null,{default:t(()=>[s(p(a(v).code),1)]),_:1})]),_:1}),e(i,null,{default:t(()=>[at,e(f,null,{default:t(()=>{var n;return[s(p((n=a(v).do)==null?void 0:n.code),1)]}),_:1})]),_:1}),e(i,{horizontal:""},{default:t(()=>[lt,e(ce,{"formatted-value":a(T).target_delivery_date,"onUpdate:formattedValue":o[0]||(o[0]=n=>a(T).target_delivery_date=n)},null,8,["formatted-value"])]),_:1}),e(i,null,{default:t(()=>[ot,e(f,null,{default:t(()=>{var n;return[s(p((n=a(v).total)==null?void 0:n.packing),1)]}),_:1})]),_:1}),e(i,null,{default:t(()=>[st,e(f,null,{default:t(()=>{var n;return[s(p((n=a(v).total)==null?void 0:n.qty),1)]}),_:1})]),_:1}),e(i,null,{default:t(()=>[it,e(f,null,{default:t(()=>{var n;return[s(p((n=a(v).do)==null?void 0:n.po_number),1)]}),_:1})]),_:1}),e(i,null,{default:t(()=>[rt,e(f,null,{default:t(()=>[s(p(a(Re)(a(v).created_at).format("yyyy-MM-DD")),1)]),_:1})]),_:1})]),_:1})]),_:1}),e($,{span:12},{default:t(()=>[e(i,{vertical:""},{default:t(()=>[e(_e,{style:{"margin-bottom":"0"}},{default:t(()=>{var n,g;return[s(" Tujuan : "+p((g=(n=a(v).do)==null?void 0:n.destination)==null?void 0:g.name),1)]}),_:1}),e(f,null,{default:t(()=>{var n,g;return[s(p(l.$filters.setAddress((g=(n=a(v).do)==null?void 0:n.destination)==null?void 0:g.address)),1)]}),_:1})]),_:1}),e(i,{horizontal:"",style:{"margin-left":"40px","margin-top":"50px"},align:"center"},{default:t(()=>[ut,e(pe,{round:"",bordered:!1},{default:t(()=>[dt]),_:1})]),_:1})]),_:1})]),_:1}),(h(!0),D(A,null,Te(a(m),(n,g)=>(h(),D("div",{key:g},[e(ve,{style:{"margin-top":"2rem",background:"#f1f3f3",padding:"1.5rem","border-radius":"12px"}},{default:t(()=>[r("div",ct,[e(k,{onClick:d=>ne(n,g),type:"error",style:{display:"flex","justify-content":"end","align-items":"center"}},{icon:t(()=>[e(q,null,{default:t(()=>[e(a(et))]),_:1})]),default:t(()=>[s(" Delete ")]),_:2},1032,["onClick"])]),e(i,{vertical:""},{default:t(()=>[e(i,{vertical:""},{default:t(()=>[e(fe,null,{default:t(()=>[e(z,{label:"Nama Driver"},{default:t(()=>[e(H,{value:n.id,"onUpdate:value":[d=>n.id=d,d=>ie(n.id)],options:a(Z),filterable:"",onSearch:le,placeholder:""},null,8,["value","onUpdate:value","options"])]),_:2},1024),e(z,{label:"Plat No. Kendaraan"},{default:t(()=>[e(H,{value:n.vehicle.id,"onUpdate:value":[d=>n.vehicle.id=d,se],options:a(ee),filterable:"",onSearch:oe,placeholder:""},null,8,["value","onUpdate:value","options"])]),_:2},1024)]),_:2},1024),e(me,{show:!!a(x)[(n==null?void 0:n.vehicle.id)||"0"]},{default:t(()=>[e(i,{justify:"space-between",style:{"margin-top":"1.5rem"}},{default:t(()=>[e(i,{vertical:"",size:0},{default:t(()=>[e(i,null,{default:t(()=>[_t,e(f,null,{default:t(()=>{var d;return[s(p((d=a(x)[(n==null?void 0:n.vehicle.id)||"0"])==null?void 0:d.vehicle_categories.name),1)]}),_:2},1024)]),_:2},1024),e(i,null,{default:t(()=>[pt,e(f,null,{default:t(()=>{var d;return[s(p((d=a(x)[(n==null?void 0:n.vehicle.id)||"0"])==null?void 0:d.vehicle_categories.owner),1)]}),_:2},1024)]),_:2},1024)]),_:2},1024),e(i,null,{default:t(()=>[ft,e(f,null,{default:t(()=>{var d;return[s(p((d=a(x)[(n==null?void 0:n.vehicle.id)||"0"])==null?void 0:d.volume)+"cm",1),mt]}),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["show"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128)),e(i,{align:"center"},{default:t(()=>[e(k,{type:"primary",quaternary:"",onClick:ae,style:{"margin-top":"2rem"}},{default:t(()=>[e(q,{component:a(Ge)},null,8,["component"]),s(" Tambah Driver ")]),_:1})]),_:1}),a(m).length?(h(),F(i,{key:0,justify:"center",style:{"margin-top":"24px"}},{default:t(()=>[e(ge,{to:{name:"pengiriman-assign-driver"},class:"text-decoration-none"},{default:t(()=>[e(k,{type:"error",secondary:"",strong:"",class:"button-tnt"},{default:t(()=>[s("Kembali")]),_:1})]),_:1}),e(k,{class:"button-tnt",type:"primary",secondary:"",strong:"",onClick:Y},{default:t(()=>[s("Assign")]),_:1})]),_:1})):K("",!0)],64))]),e(he,{show:a(u).show,"onUpdate:show":o[1]||(o[1]=n=>a(u).show=n),icon:a(u).icon,"icon-color":a(u).iconColor,"hide-icon":a(u).hideIcon,title:a(u).title,subtitle:a(u).subtitle},{default:t(()=>[e(i,{justify:"center"},{default:t(()=>[a(u).type=="assign"?(h(),D(A,{key:0},[e(k,{loading:a(V),color:"#828282",secondary:"",strong:"",class:"button-tnt",onClick:a(Ee)},{default:t(()=>[s(" Tutup ")]),_:1},8,["loading","onClick"]),e(k,{loading:a(V),type:"primary",secondary:"",strong:"",class:"button-tnt",style:{"padding-left":"25px","padding-right":"25px"},onClick:te},{default:t(()=>[s(" Yakin ")]),_:1},8,["loading"])],64)):K("",!0)]),_:1})]),_:1},8,["show","icon","icon-color","hide-icon","title","subtitle"])],64)}}});typeof R=="function"&&R(vt);export{vt as default};
