import{_ as Y}from"./t-scan-modal.vue_vue_type_script_setup_true_lang.af24c4ce.js";import{_ as Z}from"./t-feedback.vue_vue_type_script_setup_true_lang.83eb0b14.js";import{p as $,_ as ee}from"./pengemasan.c1a27849.js";import{d as ne,b as te,u as ae,E as se,r as g,W as oe,f as le,o as L,c as D,k as e,w as n,q as o,t as f,i as l,F as j,g as ie,h as ue,S as z,aG as _e,am as re,an as ce,v as me,ar as de,ac as pe,s as fe,ad as ge,N as ve,K as ke,a9 as ye,ae as be,aS as he,y as we,aQ as Se,a4 as B}from"./index.21c0d750.js";import{A as Ie}from"./Add.4f3b52cf.js";import{E as $e}from"./EllipsisVertical.56989e7a.js";import"./CheckmarkCircleOutline.8fddcae1.js";import"./getCompanyId.7d0eb93b.js";import"./getHoldingId.48f570fc.js";const Ke=ne({__name:"[code]",setup(xe){const K=te(),N=ae(),r=se(),E=g([{label:"No"},{label:"ID Level 2"},{label:"Batch"},{label:"Aksi",style:{width:"3rem"}}]),M=oe(()=>[{label:"Hapus",key:"delete"}]),x=g(!1),u=g(),v=g(!1),y=g(""),_=g([]),b=g(!1);le(async()=>{await A(),F()});async function A(){const{data:s}=await $.detailKemasan({code:K.params.code,level:"2",reception_id:K.params.id});u.value=s}async function F(){var t,d,c;const{data:s}=await $.listItemKemas(u.value.id,{limit:(c=(d=(t=u.value)==null?void 0:t.serialize)==null?void 0:d.maximum)!=null?c:10});console.log({data:s}),_.value=s.list}async function H(s){var d,c,h,m;if(!s){r.error("Kode packing tidak boleh kosong");return}const{data:t}=await $.detailKemasan({code:s,level:"2",reception_id:K.params.id}).catch(p=>{let k=p.message;throw p.response.data&&(k=p.response.data.message),r.error(k),p}).finally(()=>{y.value=""});if(((c=(d=u.value)==null?void 0:d.serialize)==null?void 0:c.maximum)<=_.value.length){r.error("Kemasan penuh"),v.value=!1;return}if(t.status!="printed"){r.error("Label item belum tercetak");return}if(t.is_packed){r.error("Item sudah dikemas (items packed)");return}_.value.findIndex(p=>p.id==t.id)==-1?(r.success("Item berhasil ditambahkan"),_.value.push(t),((m=(h=u.value)==null?void 0:h.serialize)==null?void 0:m.maximum)==_.value.length&&(v.value=!1)):r.warning("Item sudah ditambahkan sebelumnya")}function R(s,t){_.value.splice(t,1)}async function U(){x.value=!0,await $.kemasItem({reception_detail_id:u.value.id,ids:_.value.map(s=>s.id)}).catch(s=>{let t=s.message;s.response.data&&(t=s.response.data.message),r.error(t)}).finally(()=>{x.value=!1}),r.success("Item berhasil dikemas"),N.push({name:"produksi-pengemasan-id"}),b.value=!0}function V(){N.push({name:"produksi-pengemasan-id"})}return(s,t)=>{const d=_e,c=re,h=ce,m=me,p=de,k=pe,Q=fe,C=ge,P=ve,w=ke,T=ye,q=be,S=he,G=we,O=Se,W=ee,J=Z,X=Y;return L(),D(j,null,[e(m,{vertical:"",size:24,style:{padding:"1rem"}},{default:n(()=>[e(m,{vertical:"",size:0},{default:n(()=>[e(d,{style:{"margin-bottom":"0"}},{default:n(()=>[o(" Packing Level 3")]),_:1}),e(h,null,{default:n(()=>[e(c,{onClick:t[0]||(t[0]=a=>s.$router.push("/pengemasan"))},{default:n(()=>[o("Pengemasan")]),_:1}),e(c,{onClick:t[1]||(t[1]=a=>s.$router.push({name:"produksi-pengemasan-id"}))},{default:n(()=>[o("Detail Pengemasan")]),_:1}),e(c,null,{default:n(()=>[o("Packing Tersier")]),_:1})]),_:1})]),_:1}),e(q,{cols:"2","item-responsive":"",responsive:"screen","x-gap":16,"y-gap":16},{default:n(()=>[e(C,{span:"2 s:1"},{default:n(()=>[e(m,{vertical:"",size:0},{default:n(()=>[e(d,{style:{"margin-bottom":"0"}},{default:n(()=>{var a;return[o(" ID Level 3: "+f((a=l(u))==null?void 0:a.code),1)]}),_:1}),e(p,{style:{"margin-bottom":"0"}},{default:n(()=>{var a,i;return[o(" Kode PK: "+f((i=(a=l(u))==null?void 0:a.reception)==null?void 0:i.pk_id),1)]}),_:1}),e(k,{style:{"margin-bottom":"0"}},{default:n(()=>{var a,i,I;return[o(f((I=(i=(a=l(u))==null?void 0:a.reception)==null?void 0:i.product)==null?void 0:I.long_name),1)]}),_:1}),e(k,{style:{"margin-bottom":"0"}},{default:n(()=>[e(Q,{strong:""},{default:n(()=>[o("Packer: ")]),_:1}),o(" Syihab ")]),_:1})]),_:1})]),_:1}),e(C,{span:"2 s:1"},{default:n(()=>[e(m,{justify:"end"},{default:n(()=>[e(w,{type:"warning",onClick:t[2]||(t[2]=a=>v.value=!0)},{default:n(()=>[e(P,{component:l(Ie)},null,8,["component"]),o(" Scan ID ")]),_:1})]),_:1})]),_:1}),e(C,{span:"2 s:1"},{default:n(()=>[e(T,{style:{width:"100%",padding:"1rem","justify-content":"center"},strong:""},{default:n(()=>[e(k,{style:{"text-align":"center"}},{default:n(()=>{var a,i;return[o(" Qty: "+f(l(_).length)+"/"+f((i=(a=l(u))==null?void 0:a.serialize)==null?void 0:i.maximum),1)]}),_:1})]),_:1})]),_:1})]),_:1}),e(W,{headers:l(E)},{default:n(()=>[(L(!0),D(j,null,ie(l(_),(a,i)=>(L(),ue(O,{key:a.id},{default:n(()=>[e(S,null,{default:n(()=>[o(f(i+1),1)]),_:2},1024),e(S,null,{default:n(()=>[o(f(a.code),1)]),_:2},1024),e(S,null,{default:n(()=>[o(f(a.reception.batch_number),1)]),_:2},1024),e(S,null,{default:n(()=>[e(G,{trigger:"click",options:l(M),onSelect:I=>R(I,i)},{default:n(()=>[e(w,{bordered:!1,circle:""},{default:n(()=>[e(P,{component:l($e)},null,8,["component"])]),_:1})]),_:2},1032,["options","onSelect"])]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["headers"]),e(m,{justify:"center"},{default:n(()=>[e(w,{loading:l(x),type:"primary",onClick:U},{default:n(()=>[o("Simpan")]),_:1},8,["loading"])]),_:1})]),_:1}),e(J,{show:l(b),"onUpdate:show":t[3]||(t[3]=a=>z(b)?b.value=a:null),title:"Selamat",subtitle:`${l(_).length} Item telah terkemas`},{default:n(()=>[e(m,{justify:"center"},{default:n(()=>[e(w,{type:"primary",onClick:V},{default:n(()=>[o("Selesai")]),_:1})]),_:1})]),_:1},8,["show","subtitle"]),e(X,{show:l(v),"onUpdate:show":t[4]||(t[4]=a=>z(v)?v.value=a:null),code:l(y),"onUpdate:code":t[5]||(t[5]=a=>z(y)?y.value=a:null),onScanned:H,title:"Packing Level 2"},null,8,["show","code"])],64)}}});typeof B=="function"&&B(Ke);export{Ke as default};
