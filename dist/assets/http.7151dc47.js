import{b2 as K,b3 as M,b4 as J,b5 as x,b6 as D,b7 as X,b8 as Y,b9 as Z,ba as q,bb as _,bc as j,bd as $,be as tt,au as et,bf as st,W as E,ay as B,G as g,bg as U,U as z,bh as V,V as W,i as v,bi as rt,bj as N,bk as it,bl as nt,e as ut}from"./index.21c0d750.js";class at extends K{constructor(t,e){super(),this.client=t,this.options=e,this.trackedProps=new Set,this.selectError=null,this.bindMethods(),this.setOptions(e)}bindMethods(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.currentQuery.addObserver(this),P(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return F(this.currentQuery,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return F(this.currentQuery,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.clearStaleTimeout(),this.clearRefetchInterval(),this.currentQuery.removeObserver(this)}setOptions(t,e){const s=this.options,n=this.currentQuery;if(this.options=this.client.defaultQueryOptions(t),M(s,this.options)||this.client.getQueryCache().notify({type:"observerOptionsUpdated",query:this.currentQuery,observer:this}),typeof this.options.enabled<"u"&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=s.queryKey),this.updateQuery();const r=this.hasListeners();r&&k(this.currentQuery,n,this.options,s)&&this.executeFetch(),this.updateResult(e),r&&(this.currentQuery!==n||this.options.enabled!==s.enabled||this.options.staleTime!==s.staleTime)&&this.updateStaleTimeout();const u=this.computeRefetchInterval();r&&(this.currentQuery!==n||this.options.enabled!==s.enabled||u!==this.currentRefetchInterval)&&this.updateRefetchInterval(u)}getOptimisticResult(t){const e=this.client.getQueryCache().build(this.client,t);return this.createResult(e,t)}getCurrentResult(){return this.currentResult}trackResult(t){const e={};return Object.keys(t).forEach(s=>{Object.defineProperty(e,s,{configurable:!1,enumerable:!0,get:()=>(this.trackedProps.add(s),t[s])})}),e}getCurrentQuery(){return this.currentQuery}remove(){this.client.getQueryCache().remove(this.currentQuery)}refetch({refetchPage:t,...e}={}){return this.fetch({...e,meta:{refetchPage:t}})}fetchOptimistic(t){const e=this.client.defaultQueryOptions(t),s=this.client.getQueryCache().build(this.client,e);return s.isFetchingOptimistic=!0,s.fetch().then(()=>this.createResult(s,e))}fetch(t){var e;return this.executeFetch({...t,cancelRefetch:(e=t.cancelRefetch)!=null?e:!0}).then(()=>(this.updateResult(),this.currentResult))}executeFetch(t){this.updateQuery();let e=this.currentQuery.fetch(this.options,t);return t!=null&&t.throwOnError||(e=e.catch(J)),e}updateStaleTimeout(){if(this.clearStaleTimeout(),x||this.currentResult.isStale||!D(this.options.staleTime))return;const e=X(this.currentResult.dataUpdatedAt,this.options.staleTime)+1;this.staleTimeoutId=setTimeout(()=>{this.currentResult.isStale||this.updateResult()},e)}computeRefetchInterval(){var t;return typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.currentResult.data,this.currentQuery):(t=this.options.refetchInterval)!=null?t:!1}updateRefetchInterval(t){this.clearRefetchInterval(),this.currentRefetchInterval=t,!(x||this.options.enabled===!1||!D(this.currentRefetchInterval)||this.currentRefetchInterval===0)&&(this.refetchIntervalId=setInterval(()=>{(this.options.refetchIntervalInBackground||Y.isFocused())&&this.executeFetch()},this.currentRefetchInterval))}updateTimers(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())}clearStaleTimeout(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)}clearRefetchInterval(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)}createResult(t,e){const s=this.currentQuery,n=this.options,r=this.currentResult,u=this.currentResultState,a=this.currentResultOptions,l=t!==s,o=l?t.state:this.currentQueryInitialState,h=l?this.currentResult:this.previousQueryResult,{state:c}=t;let{dataUpdatedAt:d,error:R,errorUpdatedAt:m,fetchStatus:b,status:y}=c,A=!1,T=!1,p;if(e._optimisticResults){const f=this.hasListeners(),S=!f&&P(t,e),G=f&&k(t,s,e,n);(S||G)&&(b=Z(t.options.networkMode)?"fetching":"paused",d||(y="loading")),e._optimisticResults==="isRestoring"&&(b="idle")}if(e.keepPreviousData&&!c.dataUpdatedAt&&h!=null&&h.isSuccess&&y!=="error")p=h.data,d=h.dataUpdatedAt,y=h.status,A=!0;else if(e.select&&typeof c.data<"u")if(r&&c.data===(u==null?void 0:u.data)&&e.select===this.selectFn)p=this.selectResult;else try{this.selectFn=e.select,p=e.select(c.data),p=q(r==null?void 0:r.data,p,e),this.selectResult=p,this.selectError=null}catch(f){this.selectError=f}else p=c.data;if(typeof e.placeholderData<"u"&&typeof p>"u"&&y==="loading"){let f;if(r!=null&&r.isPlaceholderData&&e.placeholderData===(a==null?void 0:a.placeholderData))f=r.data;else if(f=typeof e.placeholderData=="function"?e.placeholderData():e.placeholderData,e.select&&typeof f<"u")try{f=e.select(f),this.selectError=null}catch(S){this.selectError=S}typeof f<"u"&&(y="success",p=q(r==null?void 0:r.data,f,e),T=!0)}this.selectError&&(R=this.selectError,p=this.selectResult,m=Date.now(),y="error");const Q=b==="fetching",C=y==="loading",I=y==="error";return{status:y,fetchStatus:b,isLoading:C,isSuccess:y==="success",isError:I,isInitialLoading:C&&Q,data:p,dataUpdatedAt:d,error:R,errorUpdatedAt:m,failureCount:c.fetchFailureCount,failureReason:c.fetchFailureReason,errorUpdateCount:c.errorUpdateCount,isFetched:c.dataUpdateCount>0||c.errorUpdateCount>0,isFetchedAfterMount:c.dataUpdateCount>o.dataUpdateCount||c.errorUpdateCount>o.errorUpdateCount,isFetching:Q,isRefetching:Q&&!C,isLoadingError:I&&c.dataUpdatedAt===0,isPaused:b==="paused",isPlaceholderData:T,isPreviousData:A,isRefetchError:I&&c.dataUpdatedAt!==0,isStale:w(t,e),refetch:this.refetch,remove:this.remove}}updateResult(t){const e=this.currentResult,s=this.createResult(this.currentQuery,this.options);if(this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,M(s,e))return;this.currentResult=s;const n={cache:!0},r=()=>{if(!e)return!0;const{notifyOnChangeProps:u}=this.options;if(u==="all"||!u&&!this.trackedProps.size)return!0;const a=new Set(u!=null?u:this.trackedProps);return this.options.useErrorBoundary&&a.add("error"),Object.keys(this.currentResult).some(l=>{const o=l;return this.currentResult[o]!==e[o]&&a.has(o)})};(t==null?void 0:t.listeners)!==!1&&r()&&(n.listeners=!0),this.notify({...n,...t})}updateQuery(){const t=this.client.getQueryCache().build(this.client,this.options);if(t===this.currentQuery)return;const e=this.currentQuery;this.currentQuery=t,this.currentQueryInitialState=t.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(e==null||e.removeObserver(this),t.addObserver(this))}onQueryUpdate(t){const e={};t.type==="success"?e.onSuccess=!t.manual:t.type==="error"&&!_(t.error)&&(e.onError=!0),this.updateResult(e),this.hasListeners()&&this.updateTimers()}notify(t){j.batch(()=>{if(t.onSuccess){var e,s,n,r;(e=(s=this.options).onSuccess)==null||e.call(s,this.currentResult.data),(n=(r=this.options).onSettled)==null||n.call(r,this.currentResult.data,null)}else if(t.onError){var u,a,l,o;(u=(a=this.options).onError)==null||u.call(a,this.currentResult.error),(l=(o=this.options).onSettled)==null||l.call(o,void 0,this.currentResult.error)}t.listeners&&this.listeners.forEach(({listener:h})=>{h(this.currentResult)}),t.cache&&this.client.getQueryCache().notify({query:this.currentQuery,type:"observerResultsUpdated"})})}}function ct(i,t){return t.enabled!==!1&&!i.state.dataUpdatedAt&&!(i.state.status==="error"&&t.retryOnMount===!1)}function P(i,t){return ct(i,t)||i.state.dataUpdatedAt>0&&F(i,t,t.refetchOnMount)}function F(i,t,e){if(t.enabled!==!1){const s=typeof e=="function"?e(i):e;return s==="always"||s!==!1&&w(i,t)}return!1}function k(i,t,e,s){return e.enabled!==!1&&(i!==t||s.enabled===!1)&&(!e.suspense||i.state.status!=="error")&&w(i,e)}function w(i,t){return i.isStaleByTime(t.staleTime)}class lt extends K{constructor(t,e){super(),this.client=t,this.setOptions(e),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var e;const s=this.options;this.options=this.client.defaultMutationOptions(t),M(s,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this}),(e=this.currentMutation)==null||e.setOptions(this.options)}onUnsubscribe(){if(!this.hasListeners()){var t;(t=this.currentMutation)==null||t.removeObserver(this)}}onMutationUpdate(t){this.updateResult();const e={listeners:!0};t.type==="success"?e.onSuccess=!0:t.type==="error"&&(e.onError=!0),this.notify(e)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(t,e){return this.mutateOptions=e,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:typeof t<"u"?t:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){const t=this.currentMutation?this.currentMutation.state:$(),e={...t,isLoading:t.status==="loading",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset};this.currentResult=e}notify(t){j.batch(()=>{if(this.mutateOptions&&this.hasListeners()){if(t.onSuccess){var e,s,n,r;(e=(s=this.mutateOptions).onSuccess)==null||e.call(s,this.currentResult.data,this.currentResult.variables,this.currentResult.context),(n=(r=this.mutateOptions).onSettled)==null||n.call(r,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context)}else if(t.onError){var u,a,l,o;(u=(a=this.mutateOptions).onError)==null||u.call(a,this.currentResult.error,this.currentResult.variables,this.currentResult.context),(l=(o=this.mutateOptions).onSettled)==null||l.call(o,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context)}}t.listeners&&this.listeners.forEach(({listener:h})=>{h(this.currentResult)})})}}function H(i=""){var t;if(!((t=tt())==null?void 0:t.proxy))throw new Error("vue-query hooks can only be used inside setup() function.");const s=st(i),n=et(s);if(!n)throw new Error("No 'queryClient' found in Vue context, use 'VueQueryPlugin' to properly initialize the library.");return n}function ot(i,t,e={},s={}){var n;const r=E(()=>ht(t,e,s)),u=(n=r.value.queryClient)!=null?n:H(r.value.queryClientKey),a=E(()=>{const d=u.defaultQueryOptions(r.value);return d._optimisticResults=u.isRestoring.value?"isRestoring":"optimistic",d}),l=new i(u,a.value),o=B(l.getCurrentResult());let h=()=>{};g(u.isRestoring,d=>{d||(h(),h=l.subscribe(R=>{U(o,R)}))},{immediate:!0}),g(a,()=>{l.setOptions(a.value),U(o,l.getCurrentResult())},{deep:!0}),z(()=>{h()});const c=()=>new Promise(d=>{let R=()=>{};const m=()=>{if(a.value.enabled!==!1){const b=l.getOptimisticResult(a.value);b.isStale?(R(),d(l.fetchOptimistic(a.value))):(R(),d(b))}};m(),R=g(a,m,{deep:!0})});return{...V(W(o)),suspense:c}}function ht(i,t={},e={}){const s=v(i),n=v(t),r=v(e);let u=s;return rt(s)?typeof n=="function"?u={...r,queryKey:s,queryFn:n}:u={...n,queryKey:s}:u=s,N(u)}function L(i,t,e){const s=ot(at,i,t,e);return{...s,refetch:s.refetch.value,remove:s.remove.value}}function dt(i,t,e){var s;const n=E(()=>ft(i,t,e)),r=(s=n.value.queryClient)!=null?s:H(n.value.queryClientKey),u=new lt(r,r.defaultMutationOptions(n.value)),a=B(u.getCurrentResult()),l=u.subscribe(c=>{U(a,c)}),o=(c,d)=>{u.mutate(c,d).catch(()=>{})};return g(n,()=>{u.setOptions(r.defaultMutationOptions(n.value))},{deep:!0}),z(()=>{l()}),{...V(W(a)),mutate:o,mutateAsync:a.mutate,reset:a.reset}}function ft(i,t,e){const s=v(i),n=v(t);let r=s;return it(s)&&(typeof n=="function"?r={...v(e),mutationKey:s,mutationFn:n}:r={...n,mutationKey:s}),typeof s=="function"&&(r={...n,mutationFn:s}),N(r)}const O=nt.create({baseURL:"https://api.medtrack-dev.digital-healthcare.id"});O.interceptors.request.use(i=>{const e=ut.getAuth().token;return i.headers&&(i.headers.Authorization=`Bearer ${e}`),i});function vt(i,t){if(t){const{httpOptions:e,queryOptions:s,keys:n=[],params:r}=t;return L([i,r,...n],async()=>{var u;try{const{data:a}=await O.get(v(i),{...e,params:v(r)});return a}catch(a){Promise.reject((u=a==null?void 0:a.response)!=null?u:a)}},s)}return L([i],async()=>{var e;try{const{data:s}=await O.get(v(i));return s}catch(s){Promise.reject((e=s==null?void 0:s.response)!=null?e:s)}})}function Rt(i,t){return dt(e=>new Promise((s,n)=>O.request({url:i,method:t.method,...t.httpOptions,data:e}).then(r=>{s(r.data)}).catch(r=>{var u;n((u=r.response)!=null?u:r.message)})),{...t.queryOptions})}export{vt as a,Rt as u};
