import{_ as ft}from"./t-feedback.vue_vue_type_script_setup_true_lang.83eb0b14.js";import{_ as ht}from"./t-loading.vue_vue_type_script_setup_true_lang.71bf4981.js";import{d as J,E as Y,r as u,G as j,f as X,aI as gt,o as h,h as S,w as e,k as a,i as t,q as d,ak as yt,I as vt,K as Z,v as tt,J as kt,M as bt,b as wt,u as xt,a1 as Ct,p as Dt,c as x,a as n,F as L,t as c,g as Rt,N as W,j as P,af as Bt,s as Nt,a7 as $t,a9 as qt,ac as It,ar as St,L as Mt,a8 as At,y as Ft,aa as Lt,ab as Kt,Q as H}from"./index.21c0d750.js";import{h as G}from"./moment.62d3fb0a.js";import{r as I}from"./return.bfb09c74.js";import{m as Ot}from"./master-warehouse.353b4b3b.js";import{E as Et}from"./EllipsisVertical.56989e7a.js";import{C as Qt}from"./CheckmarkCircleOutline.8fddcae1.js";import{S as Vt}from"./SearchOutline.47b929a4.js";import"./getCompanyId.7d0eb93b.js";const zt=J({__name:"t-modal-input-reason",props:{show:{type:Boolean,default:!1},value:{default:()=>({})},loading:{type:Boolean,default:!1}},emits:["update:show","update:value","click:close","click:confirm"],setup(T,{emit:k}){const b=T,v=Y(),_=u(!1),p=u(null),o=u({}),C=u([]);u([]);const B=u();B.value={reason:{required:!0,message:"Alasan tidak boleh kosong",trigger:["input","blur"]}},j(o,m=>k("update:value",m),{deep:!0}),j(()=>b.show,m=>{m&&K()}),X(()=>{o.value=b.value}),gt(()=>{o.value=b.value});async function K(){_.value=!0,await y(),_.value=!1}async function y(){_.value=!0,o.value.building=null,C.value=[];const m={sort:"desc",sort_field:"created_at",page:1,limit:-1};await Ot.getWarehouse(m).then(g=>{g.data.list.forEach(w=>{C.value.push({key:w.key,value:w.id,label:w.name})}),_.value=!1}).catch(g=>{_.value=!1;const D=g.response.data;v.error(D.message)})}async function s(){var m;await((m=p.value)==null?void 0:m.validate().then(()=>{k("click:confirm",!0),k("update:value",o.value)}).catch(()=>{v.error("Form tidak valid, tolong periksa kembali")}))}return(m,g)=>{const D=yt,w=vt,O=Z,M=tt,E=kt,Q=bt;return h(),S(Q,{"mask-closable":!1,show:b.show,preset:"card",role:"dialog",size:"huge",bordered:!1,style:{width:"470px","max-width":"100%","border-radius":"10px"},"header-style":{paddingLeft:"30px",paddingRight:"30px",paddingBottom:"15px"},"content-style":{paddingLeft:"20px",paddingRight:"20px",paddingBottom:"20px"},"onUpdate:show":g[1]||(g[1]=N=>m.$emit("click:close",N))},{default:e(()=>[a(M,{vertical:"",style:{"padding-left":"10px","padding-right":"10px"}},{default:e(()=>[a(E,{ref_key:"formRef",ref:p,class:"form-tnt","show-require-mark":!1,"label-width":80,model:t(o),rules:t(B)},{default:e(()=>[a(w,{label:"Alasan",path:"reason"},{default:e(()=>[a(D,{value:t(o).reason,"onUpdate:value":g[0]||(g[0]=N=>t(o).reason=N),placeholder:"Masukkan Alasan",disabled:t(_)},null,8,["value","disabled"])]),_:1}),a(M,{justify:"center"},{default:e(()=>[a(O,{loading:t(_)||b.loading,type:"primary",class:"button-tnt",onClick:s},{default:e(()=>[d(" Simpan ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["show"])}}}),Pt={class:"body-tnt"},Tt={key:0,class:"card-tnt"},Ut={class:"card-tnt"},jt={class:"table-tnt",style:{"margin-top":"0"}},Wt=n("thead",null,[n("tr",null,[n("th",null,"No"),n("th",null,"Kode Produk"),n("th",null,"Nama Produk"),n("th",null,"Batch"),n("th",null,"Exp Date"),n("th",{style:{"text-align":"center"}},"Qty Konfirmasi"),n("th",{style:{"text-align":"center"}},"Qty Return"),n("th",{style:{"text-align":"center"}},"Aksi")])],-1),Ht={"data-label":"No"},Gt={"data-label":"Kode Produk"},Jt={"data-label":"Nama Produk"},Yt={"data-label":"Batch"},Xt={"data-label":"Exp Date"},Zt={"data-label":"Qty Konfirmasi",style:{"text-align":"center"}},te={"data-label":"Qty Return",style:{"text-align":"center"}},ee={"data-label":"Aksi",style:{"text-align":"center"}},ae={key:1},ne=n("td",{colspan:"9",style:{"text-align":"center"}}," Belum ada data tersedia ",-1),oe=[ne],se={class:"bottom-action-button"},le={class:"action-item"},ge=J({__name:"index",setup(T){const k=wt(),b=xt(),v=Y(),_=u(!0),p=u(!1),o=u({}),C=u({}),B=u({}),K=u();K.value={reason:{required:!0,message:"Alasan tidak boleh kosong",trigger:["input","blur"]}};const y=u({show:!1,data:{},form:{},loading:p}),s=u({show:u(!1),type:"",icon:Ct(),iconColor:"",hideIcon:!1,title:"",subtitle:"",align:"center"}),m=r=>()=>H(W,null,{default:()=>H(r)});X(()=>{localStorage.removeItem("rr-product-data"),g()});async function g(){_.value=!0,await D(),await w(),_.value=!1}async function D(){const r=k.query.return_id;await I.getDetailReturn(r).then(l=>{var i;O(l.data.do_type,(i=l.data.customer)==null?void 0:i.id),o.value=l.data}).catch(l=>{const i=l.response.data;v.error(i.message)})}async function w(){const r=k.query.return_id;await I.getListDetailReturn(r).then(l=>{C.value=l.data}).catch(l=>{const i=l.response.data;v.error(i.message)})}async function O(r,l){r==="customer"?await I.getDetailCustomer(l).then(i=>{B.value=i.data}).catch(i=>{const $=i.response.data;v.error($.message)}):r==="crossdocking"&&await I.getDetailPlant(l).then(i=>{B.value=i.data}).catch(i=>{const $=i.response.data;v.error($.message)})}const M=[{label:"Scan",key:"scan",icon:m(Vt)}];function E(r,l){switch(r){case"scan":b.push({name:"penerimaan-return-code-scan",query:{return_id:l.rr_id,product_id:l.id}});break}}function Q(){at()}function N(){y.value.show=!0,y.value.data=o,V()}function U(){y.value.show=!1}function et(){p.value=!0;const r=new FormData;r.append("rr_id",k.query.return_id),r.append("reason",y.value.form.reason),I.postFinish(r).then(()=>{p.value=!1,U(),g(),y.value.form={},setTimeout(()=>{s.value.title="Berhasil",s.value.subtitle="Berhasil terima return",nt()},300)}).catch(l=>{p.value=!1;const i=l.response.data;v.error(i.message)})}function at(){s.value.type="confirm",s.value.hideIcon=!0,s.value.title="Konfirmasi",s.value.subtitle="Apakah Anda yakin untuk melakukan terima return?",s.value.show=!0}function nt(){s.value.type="success",s.value.hideIcon=!1,s.value.iconColor="#219653",s.value.icon=Qt,s.value.show=!0}function V(){s.value.show=!1}return(r,l)=>{const i=ht,$=Bt,A=Nt,F=tt,z=$t,ot=qt,st=It,lt=St,rt=Mt,it=At,R=Z,ut=Ft,ct=Lt,dt=Kt,_t=Dt("router-link"),pt=ft;return h(),x(L,null,[n("div",Pt,[t(_)?(h(),x("div",Tt,[a(i)])):(h(),x(L,{key:1},[a($,{style:{"margin-bottom":"4px"}},{default:e(()=>[d("DO Return : "+c(t(o).code),1)]),_:1}),a(it,{gutter:"16"},{default:e(()=>[a(z,{span:8},{default:e(()=>[a(F,{vertical:"",size:0},{default:e(()=>[a(A,null,{default:e(()=>[d("Tanggal DO Return : "+c(t(G)(t(o).date).format("yyyy-MM-DD")),1)]),_:1}),a(A,null,{default:e(()=>[d("Customer : "+c(t(o).customer.name),1)]),_:1}),a(A,null,{default:e(()=>{var f,q;return[d("Alamat : "+c(r.$filters.setAddress((q=(f=t(o).customer)==null?void 0:f.address)==null?void 0:q.address)),1)]}),_:1})]),_:1})]),_:1}),a(z,{span:8},{default:e(()=>[a(F,{vertical:"",size:0},{default:e(()=>[a(A,null,{default:e(()=>[d("DO Origin : "+c(t(o).do_origin_code),1)]),_:1})]),_:1})]),_:1}),a(z,{span:8},{default:e(()=>[a(F,{vertical:"",size:15,align:"end"},{default:e(()=>[a(ot,{round:"",bordered:!1,strong:"",type:t(o).status==="cancel"?"error":t(o).status==="pending"?"warning":t(o).status==="complete"?"primary":"success",size:"large"},{default:e(()=>[d(c(r.$filters.toStatus(t(o).status)),1)]),_:1},8,["type"]),a(rt,{style:{width:"250px","text-align":"center","border-radius":"15px",background:"#eee"}},{default:e(()=>[a(st,{style:{"font-size":"14px"}},{default:e(()=>[d("Qty Konfirmasi/Qyt Return")]),_:1}),a(lt,{style:{"margin-top":"0","margin-bottom":"0"}},{default:e(()=>[d(c(`${t(o).qty.receive}/${t(o).qty.request}`),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),n("div",Ut,[n("div",jt,[t(_)?(h(),S(i,{key:0})):(h(),S(dt,{key:1,"x-scrollable":""},{default:e(()=>[a(ct,{"single-line":!1},{default:e(()=>[Wt,n("tbody",null,[t(C).list.length>0?(h(!0),x(L,{key:0},Rt(t(C).list,(f,q)=>(h(),x("tr",{key:q},[n("td",Ht,c(q+1),1),n("td",Gt,c(f.product.item_code),1),n("td",Jt,c(f.product.short_name),1),n("td",Yt,c(f.batch),1),n("td",Xt,c(t(G)(f.created_at).format("yyyy-MM-DD")),1),n("td",Zt,c(r.$filters.toNumber(f.current_qty)),1),n("td",te,c(r.$filters.toNumber(f.qty)),1),n("td",ee,[a(ut,{placement:"bottom-end",options:M,onSelect:mt=>E(mt,f)},{default:e(()=>[a(R,{tertiary:""},{icon:e(()=>[a(t(W),null,{default:e(()=>[a(t(Et))]),_:1})]),_:1})]),_:2},1032,["onSelect"])])]))),128)):(h(),x("tr",ae,oe))])]),_:1})]),_:1}))])])],64)),n("div",se,[n("div",le,[a(_t,{to:{name:"penerimaan-return"},class:"text-decoration-none"},{default:e(()=>[a(R,{loading:t(p),color:"#828282",class:"button-tnt",style:{width:"120px"}},{default:e(()=>[d("Kembali ")]),_:1},8,["loading"])]),_:1}),t(o).status!=="cancel"&&t(o).status!=="complete"?(h(),S(R,{key:0,loading:t(p),type:"primary",class:"button-tnt",style:{width:"120px"},onClick:Q},{default:e(()=>[d(" Terima Return ")]),_:1},8,["loading"])):P("",!0)])])]),a(zt,{show:t(y).show,data:t(y).data,value:t(y).form,loading:t(p),"onClick:close":U,"onClick:confirm":et},null,8,["show","data","value","loading"]),a(pt,{show:t(s).show,"onUpdate:show":l[0]||(l[0]=f=>t(s).show=f),icon:t(s).icon,"hide-icon":t(s).hideIcon,title:t(s).title,subtitle:t(s).subtitle,align:t(s).align},{default:e(()=>[a(F,{justify:"center"},{default:e(()=>[t(s).type=="confirm"?(h(),x(L,{key:0},[a(R,{loading:t(p),color:"#828282",class:"button-tnt",onClick:V},{default:e(()=>[d(" Tutup ")]),_:1},8,["loading"]),a(R,{loading:t(p),type:"primary",class:"button-tnt",onClick:N},{default:e(()=>[d(" Yakin ")]),_:1},8,["loading"])],64)):P("",!0),t(s).type=="success"?(h(),S(R,{key:1,color:"#828282",class:"button-tnt",onClick:V},{default:e(()=>[d(" Tutup ")]),_:1})):P("",!0)]),_:1})]),_:1},8,["show","icon","hide-icon","title","subtitle","align"])],64)}}});export{ge as default};
