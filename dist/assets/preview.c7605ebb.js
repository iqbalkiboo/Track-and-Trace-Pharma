import{_ as re}from"./t-list-void-modal.vue_vue_type_script_setup_true_lang.35b6889d.js";import{_ as ae}from"./t-loading.vue_vue_type_script_setup_true_lang.71bf4981.js";import{d as le,E as se,r as f,G as _e,f as ne,aI as pe,o as y,c as E,k as a,w as l,i as e,S as U,h as N,F as T,g as ve,l as ge,q as w,t as v,a as u,ah as F,aY as X,aZ as ee,j as G,s as oe,v as ie,K as ce,ag as fe,ab as me,bn as he,b as ye,p as ke,af as ze,ad as be,ae as we,N as xe}from"./index.21c0d750.js";import{h as Ce}from"./moment.62d3fb0a.js";import{c as M}from"./pengecekan.5688c890.js";import{A as te}from"./ArrowBackOutline.8e9fb91f.js";import"./getCompanyId.7d0eb93b.js";import"./getHoldingId.48f570fc.js";const De=["onClick"],Le=["value","id"],Ee=le({__name:"t-preview-list",props:{scanData:{default:()=>({})},detailData:{default:()=>({})},value:{default:()=>({})},params:{default:()=>({})}},emits:["click:bulk","click:close","click:getCheckingLevel","click:getDetailByCode","update:params"],setup(O,{emit:L}){const z=O,x=se(),k=f(!1),B=f(!1),s=f({}),p=f({}),b=f([]),m=f({show:!1,id:"",code:"",level:""});_e(p,h=>L("update:params",h),{deep:!0}),ne(()=>{s.value=z.value,p.value=z.params}),pe(async()=>{s.value=await z.value,p.value=await z.params,k.value=!1});function I(h){const g=document.getElementById("copyCode"+h);g.select(),g.setSelectionRange(0,99999),navigator.clipboard.writeText(g.value),x.success("Text tersalin")}function C(h){k.value=!0,s.value={},L("click:getCheckingLevel",h)}function _(h){p.value.page=1,p.value.limit=h,C(p.value.level)}function S(h,g){m.value.id=h,m.value.code=g,m.value.level=p.value.level,m.value.show=!0}function K(){m.value.show=!1}async function Q(h){L("click:getDetailByCode",h)}return(h,g)=>{const q=ae,V=oe,D=ie,R=ce,j=fe,A=me,d=he,n=re;return y(),E(T,null,[a(D,{vertical:"",size:16},{default:l(()=>[a(d,{value:e(b),"onUpdate:value":g[3]||(g[3]=t=>U(b)?b.value=t:null)},{default:l(()=>[a(A,{"x-scrollable":""},{default:l(()=>[a(D,{vertical:"",size:10,wrap:!1},{default:l(()=>[e(k)?(y(),N(q,{key:0})):(y(!0),E(T,{key:1},ve(e(s).list,(t,i)=>(y(),E("div",{key:t.id,class:"card-tnt",style:ge([{"margin-top":"0","border-radius":"12px"},(t==null?void 0:t.status)==="void"?"background-color: #d030502e;":(t==null?void 0:t.status)==="pass"?"background-color: #18a0581f;":"background-color: #eee;"])},[a(D,{wrap:!1,justify:"space-between",align:"center",style:{position:"relative"}},{default:l(()=>{var o;return[a(D,{wrap:!1,size:0},{default:l(()=>[a(V,{style:{"margin-right":"10px"}},{default:l(()=>[w(v(e(p).limit*(e(p).page-1)+(i+1)),1)]),_:2},1024),a(V,{style:{"margin-left":"10px"}},{default:l(()=>{var r;return[w(v("Kode Level "+((r=e(p))==null?void 0:r.level)+" : ")+" ",1),u("span",{style:{"font-weight":"500",cursor:"pointer"},onClick:F(P=>I(i),["prevent"])},v(t.code),9,De)]}),_:2},1024),X(u("div",null,[X(u("input",{type:"text",value:t.code,id:"copyCode"+i},null,8,Le),[[ee,!1]])],512),[[ee,!1]])]),_:2},1024),z.detailData.serialize&&z.detailData.serialize[0].level!==((o=e(p))==null?void 0:o.level)?(y(),N(D,{key:0,align:"center",size:14,wrap:!1},{default:l(()=>[a(R,{secondary:"",strong:"",type:"primary",class:"button-tnt",style:{padding:"1rem 3rem",cursor:"default"}},{default:l(()=>[w(v(t.serialize.total_pass)+" Pass",1)]),_:2},1024),a(R,{secondary:"",strong:"",type:"error",class:"button-tnt",style:{padding:"1rem 3rem"},onClick:F(r=>S(t.id,t.code),["prevent"])},{default:l(()=>[w(v(t.serialize.total_void)+" Void ",1)]),_:2},1032,["onClick"]),a(R,{loading:e(B),text:"",type:"primary",onClick:F(r=>Q(t.code),["prevent"])},{default:l(()=>[w(" Detail ")]),_:2},1032,["loading","onClick"])]),_:2},1024)):G("",!0)]}),_:2},1024)],4))),128)),a(D,{justify:"center",style:{"margin-top":"14px"}},{default:l(()=>[a(j,{page:e(p).page,"onUpdate:page":[g[0]||(g[0]=t=>e(p).page=t),g[2]||(g[2]=t=>C(e(p).level))],"page-size":e(p).limit,"onUpdate:pageSize":[g[1]||(g[1]=t=>e(p).limit=t),_],"page-count":e(s).total_page,"page-slot":7,"show-size-picker":e(s).total_data>10,"page-sizes":[10,20,30,40,50]},null,8,["page","page-size","page-count","show-size-picker"])]),_:1})]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),a(n,{show:e(m).show,id:e(m).id,code:e(m).code,level:e(m).level,"onClick:close":K},null,8,["show","id","code","level"])],64)}}}),Be={class:"body-tnt"},Pe={key:0,class:"card-tnt"},Ne=u("span",null,"No Pk : ",-1),Se={style:{"font-weight":"500"}},Ve=u("span",null,"Nama Produk : ",-1),Re={style:{"font-weight":"500"}},$e=u("span",null,"Kode Produk : ",-1),Me={style:{"font-weight":"500"}},Ue=u("span",null,"No Batch Produksi : ",-1),Te={style:{"font-weight":"500"}},qe=u("span",null,"Exp. Date : ",-1),Ie={style:{"font-weight":"500"}},Ke=u("span",null,"UOM : ",-1),Qe={style:{"font-weight":"500"}},je=u("span",null,"Qty Level Terendah : ",-1),Ae={style:{"font-weight":"500"}},Fe={class:"card-tnt",style:{border:"1px solid #E5E5E5","margin-top":"0",padding:"8px","text-align":"center"}},Ge={class:"card-tnt",style:{border:"1px solid #E5E5E5","margin-top":"0",padding:"8px","text-align":"center"}},Oe={class:"card-tnt",style:{border:"1px solid #E5E5E5","margin-top":"0",padding:"8px","text-align":"center"}},He={class:"card-tnt"},Ye={class:"bottom-action-button"},Ze={class:"action-item"},Je=u("span",{style:{"margin-left":"5px"}},"Kembali",-1),We=u("span",{style:{"margin-left":"5px"}},"Level Sebelumnya",-1),it=le({__name:"preview",setup(O){const L=ye(),z=se(),x=f(!1),k=f(!1),B=f(!1),s=f({}),p=f({}),b=f({}),m=f({}),I=f(),C=f([]),_=f({reception_id:L.params.id,status:"",level:1,page:1,limit:10}),S=f({level:1});ne(()=>{K()});async function K(){h(),await Q()}async function Q(){x.value=!0;const d=L.params.id;await M.getDetailChecking(d).then(n=>{var t,i;s.value=n.data,g((i=s.value)==null?void 0:i.serialize[((t=s.value)==null?void 0:t.serialize.length)-1].level)}).catch(n=>{const t=n.response.data;z.error(t.message)})}function h(){const d=L.params.id;M.getDetailCheckingProduct(d).then(n=>{p.value=n.data}).catch(n=>{const t=n.response.data;z.error(t.message)})}async function g(d){var t,i;const n=((t=s.value)==null?void 0:t.serialize.length)-1;d===((i=s.value)==null?void 0:i.serialize[n].level)?(k.value=!0,_.value.level=d,await M.getCheckingLevel(_.value).then(o=>{b.value=o.data,b.value.list.forEach(r=>{r.active=!1,r.checked=!1}),x.value=!1,B.value=!1,k.value=!1}).catch(o=>{x.value=!1,B.value=!1,k.value=!1;const r=o.response.data;z.error(r.message)})):V(m.value.id,!1)}async function q(d){x.value=!0,k.value=!0,S.value.level=_.value.level,_.value.page=1;const n=L.params.id,t=_.value.level;return await M.getDetailByCode(d,n,t).then(i=>{var o,r;C.value.includes(i.data.code)||(typeof C.value[((o=s.value)==null?void 0:o.serialize.length)-_.value.level]<"u"&&C.value.splice(((r=s.value)==null?void 0:r.serialize.length)-_.value.level,1),C.value.push(i.data.code)),m.value=i.data,V(m.value.id,!0)}).catch(i=>{x.value=!1,B.value=!1,k.value=!1;const o=i.response.data;z.error(o.message)})}async function V(d,n){k.value=!0;const t=f({});return t.value={..._.value},delete t.value.reception_id,delete t.value.level,delete t.value.status,await M.getCheckingItems(d,t.value).then(i=>{n&&(_.value.level=_.value.level-1),b.value=i.data,b.value.list.forEach(o=>{o.active=!1,o.checked=!1}),x.value=!1,B.value=!1,k.value=!1}).catch(i=>{k.value=!1;const o=i.response.data;z.error(o.message)})}function D(d){let n=0;return d.forEach(t=>{n+=t.qty}),n}function R(d){let n=0;return d.forEach(t=>{n+=t.checking.total_qty_passed}),n}function j(d){let n=0;return d.forEach(t=>{"total_check_void"in t&&(n+=t.total_check_void)}),n}function A(){var d,n,t,i;if(((d=s.value.serialize)==null?void 0:d.length)-1===_.value.level)x.value=!0,C.value=[],g((t=s.value)==null?void 0:t.serialize[((n=s.value)==null?void 0:n.serialize.length)-1].level);else{const o=C.value[((i=s.value)==null?void 0:i.serialize.length)-1-S.value.level];_.value.level+=2,q(o)}}return(d,n)=>{var J,W;const t=ae,i=ze,o=oe,r=ie,P=be,H=we,ue=Ee,Y=xe,Z=ce,de=ke("router-link");return y(),E("div",Be,[e(x)?(y(),E("div",Pe,[a(t)])):(y(),E(T,{key:1},[a(i,{style:{"margin-bottom":"16px"}},{default:l(()=>{var c;return[((c=e(s).serialize)==null?void 0:c.length)===e(_).level?(y(),E(T,{key:0},[w(" No PK : "+v(e(s).pk_id),1)],64)):(y(),E(T,{key:1},[w(" Kode Level "+v(e(S).level)+" : "+v(e(m).code),1)],64))]}),_:1}),a(H,{cols:"3","item-responsive":"",responsive:"screen","x-gap":"16","y-gap":"16"},{default:l(()=>[a(P,{span:"3 m:1"},{default:l(()=>[a(r,{vertical:"",size:15},{default:l(()=>{var c;return[((c=e(s).serialize)==null?void 0:c.length)!==e(_).level?(y(),N(r,{key:0,vertical:"",size:0},{default:l(()=>[a(o,{style:{"margin-bottom":"0"}},{default:l(()=>[Ne,u("span",Se,v(e(s).pk_id),1)]),_:1})]),_:1})):G("",!0),a(r,{vertical:"",size:0},{default:l(()=>[a(o,{style:{"margin-bottom":"0"}},{default:l(()=>{var $;return[Ve,u("span",Re,v(($=e(s).product)==null?void 0:$.long_name),1)]}),_:1})]),_:1}),a(r,{vertical:"",size:0},{default:l(()=>[a(o,{style:{"margin-bottom":"0"}},{default:l(()=>{var $;return[$e,u("span",Me,v(($=e(s).product)==null?void 0:$.item_code),1)]}),_:1})]),_:1}),a(r,{vertical:"",size:0},{default:l(()=>[a(o,{style:{"margin-bottom":"0"}},{default:l(()=>[Ue,u("span",Te,v(e(s).batch_number),1)]),_:1})]),_:1})]}),_:1})]),_:1}),a(P,{span:"3 m:1"},{default:l(()=>[a(r,{vertical:"",size:15},{default:l(()=>[a(r,{vertical:"",size:0},{default:l(()=>[a(o,{style:{"margin-bottom":"0"}},{default:l(()=>{var c;return[qe,u("span",Ie,v(e(Ce)((c=e(s).date)==null?void 0:c.expired_date).format("yyyy-MM-DD")),1)]}),_:1})]),_:1}),a(r,{vertical:"",size:0},{default:l(()=>[a(o,{style:{"margin-bottom":"0"}},{default:l(()=>{var c;return[Ke,u("span",Qe,v((c=e(p).uom)==null?void 0:c.name),1)]}),_:1})]),_:1}),a(r,{vertical:"",size:0},{default:l(()=>[a(o,{style:{"margin-bottom":"0"}},{default:l(()=>{var c;return[je,u("span",Ae,v(e(s).serialize?(c=e(s).serialize[0])==null?void 0:c.qty:"0"),1)]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(H,{cols:"3","item-responsive":"",responsive:"screen","x-gap":"16","y-gap":"16",style:{"margin-top":"18px"}},{default:l(()=>[a(P,{span:"3 m:1"},{default:l(()=>{var c;return[u("div",Fe,[((c=e(s).serialize)==null?void 0:c.length)===e(_).level?(y(),N(o,{key:0,style:{"font-size":"13px","margin-bottom":"0"}},{default:l(()=>[w(" Semua ("+v(e(s).serialize?D(e(s).serialize):0)+") ",1)]),_:1})):(y(),N(o,{key:1},{default:l(()=>[w(" Semua ("+v(e(s).serialize?D(e(s).serialize):0)+") ",1)]),_:1}))])]}),_:1}),a(P,{span:"3 m:1"},{default:l(()=>[u("div",Ge,[a(o,{style:{"font-size":"13px","margin-bottom":"0"}},{default:l(()=>[w(" Pass ("+v(e(s).serialize?R(e(s).serialize):0)+") ",1)]),_:1})])]),_:1}),a(P,{span:"3 m:1"},{default:l(()=>[u("div",Oe,[a(o,{style:{"font-size":"13px","margin-bottom":"0"}},{default:l(()=>[w(" Void ("+v(e(s).serialize?j(e(s).serialize):0)+") ",1)]),_:1})])]),_:1})]),_:1}),u("div",He,[a(ue,{ref_key:"tahapTableRef",ref:I,"detail-data":e(s),"onUpdate:detailData":n[0]||(n[0]=c=>U(s)?s.value=c:null),"scan-data":e(m),"onUpdate:scanData":n[1]||(n[1]=c=>U(m)?m.value=c:null),value:e(b),"onUpdate:value":n[2]||(n[2]=c=>U(b)?b.value=c:null),params:e(_),"onUpdate:params":n[3]||(n[3]=c=>U(_)?_.value=c:null),type:"semua","onClick:getCheckingLevel":g,"onClick:getDetailByCode":q},null,8,["detail-data","scan-data","value","params"])])],64)),u("div",Ye,[u("div",Ze,[a(de,{to:{name:"produksi-pengecekan-tahap2-id"},class:"text-decoration-none"},{default:l(()=>[a(Z,{color:"#828282",class:"button-tnt",style:{width:"120px"}},{default:l(()=>[a(Y,{component:e(te)},null,8,["component"]),Je]),_:1})]),_:1}),(J=e(s).serialize)!=null&&J.length&&((W=e(s).serialize)==null?void 0:W.length)!==e(_).level?(y(),N(Z,{key:0,loading:e(k),color:"#828282",ghost:"",class:"button-tnt",onClick:A},{default:l(()=>[a(Y,{component:e(te)},null,8,["component"]),We]),_:1},8,["loading"])):G("",!0)])])])}}});export{it as default};
