import{_ as _e}from"./t-loading.vue_vue_type_script_setup_true_lang.71bf4981.js";import{d as de,b as pe,u as ge,E as me,r as g,f as fe,o as m,c as N,k as n,w as o,q as _,t as c,i as a,ah as E,aY as D,a as l,aZ as I,h as C,j as L,F as ve,g as he,af as ye,aJ as ke,s as be,v as xe,ak as we,a7 as Se,a8 as Ce,a9 as ze,aa as Be,ab as Ne,ag as De,L as Ie,K as Te,N as Ee}from"./index.21c0d750.js";import{h as Le}from"./moment.62d3fb0a.js";import{m as T}from"./master-warehouse.353b4b3b.js";import{s as Me}from"./penyimpanan-stok.4693d521.js";import{A as Re}from"./ArrowBackOutline.8e9fb91f.js";import"./getCompanyId.7d0eb93b.js";const $e={class:"body-tnt"},Ke=["value"],Pe={style:{display:"flex","align-items":"end"}},je=l("th",null,"No",-1),Ve=l("th",null,"Kode Serialisasi",-1),Fe=l("th",{style:{"text-align":"right"}},"Level",-1),Oe=l("th",{style:{"text-align":"center"}},"Status",-1);const Ue=["onClick"],qe=["value","id"],Ae={style:{"text-align":"right"}},He={style:{"text-align":"center"}};const Je={key:1},Qe=l("td",{colspan:"4",style:{"text-align":"center"}}," Belum ada data produk tersedia ",-1),Ge=[Qe],We={style:{"margin-top":"14px",display:"flex","justify-content":"center"}},Ye={class:"bottom-action-button"},Ze={class:"action-item"},Xe=l("span",{style:{"margin-left":"5px"}},"Level Sebelumnya",-1),rt=de({__name:"list-serialize",setup(et){const F=pe(),O=ge(),h=me(),w=g(!0),z=g(!0),y=g({}),f=g({}),u=localStorage.getItem("warehouse_type"),U=localStorage.getItem("warehouse_name"),q=localStorage.getItem("plant_id"),k=JSON.parse(localStorage.getItem("xx_product_storage")),b=g([]),p=g(0),i=g(0),s=g({code:"",parent_code:"",warehouse_id:q,batch_number:k.batch,un_nested_wh:1,sort:"desc",sort_field:"serialize.level",page:1,limit:10});fe(()=>{A()});async function A(){await H(),S()}async function S(){if(w.value=!0,z.value=!0,u==="building"||u==="building_non_room"){const e=localStorage.getItem("building_id");s.value.building_id=e}else if(u==="room"||u==="room_non_rack"){const e=localStorage.getItem("room_id");s.value.room_id=e}else if(u==="rack_pallete"||u==="rack_pallete_non_bin"){const e=localStorage.getItem("rack_id");s.value.rack_id=e}else{const e=localStorage.getItem("bin_id");s.value.bin_id=e}await Me.getListSerialize(s.value).then(e=>{w.value=!1,z.value=!1,y.value=e.data}).catch(e=>{w.value=!1,z.value=!1;const t=e.response.data;h.error(t.message)})}async function H(){const e=F.params.id;u==="building"||u==="building_non_room"?await T.getDetailBuilding(e).then(t=>{f.value=t.data}).catch(t=>{const d=t.response.data;h.error(d.message)}):u==="room"||u==="room_non_rack"?await T.getDetailRoom(e).then(t=>{f.value=t.data}).catch(t=>{const d=t.response.data;h.error(d.message)}):u==="rack_pallete"||u==="rack_pallete_non_bin"?await T.getDetailRackPallete(e).then(t=>{f.value=t.data}).catch(t=>{const d=t.response.data;h.error(d.message)}):await T.getDetailBin(e).then(t=>{f.value=t.data}).catch(t=>{const d=t.response.data;h.error(d.message)})}function J(e){s.value.page=1,s.value.limit=e,S()}const M=g(0);function Q(){clearTimeout(M.value),M.value=setTimeout(function(){S()},600)}function G(e){let t="";return e.warehouse_building&&(t+=e.warehouse_building.name),e.warehouse_room&&(t+=" / "+e.warehouse_room.name),e.warehouse_rack&&(t+=" / "+e.warehouse_rack.name+" / "),t+=e.name,t}function W(){const e=document.getElementById("copyErpCode");e.select(),e.setSelectionRange(0,99999),navigator.clipboard.writeText(e.value),h.success("Kode erp tersalin")}function Y(e){const t=document.getElementById("copyCode"+e);t.select(),t.setSelectionRange(0,99999),navigator.clipboard.writeText(t.value),h.success("Kode serialisasi tersalin")}function R(e,t,d){s.value.parent_code=e,s.value.page=1,b.value.includes(e)||b.value.push(e),p.value===0?p.value=t:p.value===i.value&&(p.value=0,i.value=0,b.value=[],s.value.parent_code=""),d==="get"?i.value===p.value-1?i.value=p.value-2:(i.value=p.value-1,i.value<0&&(i.value=0)):(i.value=p.value-1,i.value<0&&(i.value=0),i.value===p.value-1&&b.value.pop()),S()}function Z(){O.push({name:"penyimpanan-stok-id-detail-list-product"})}function X(){const e=b.value[p.value-2-i.value];i.value=i.value+1,R(e,i.value,"back")}return(e,t)=>{const d=ye,ee=ke,v=be,x=xe,te=we,$=Se,ae=Ce,oe=_e,ne=ze,le=Be,se=Ne,ie=De,re=Ie,K=Te,ce=Ee;return m(),N("div",$e,[n(x,{vertical:"",size:14},{default:o(()=>[n(x,{justify:"space-between"},{default:o(()=>[n(x,{vertical:"",size:0},{default:o(()=>[n(d,{style:{"margin-bottom":"4px"}},{default:o(()=>[_(c(a(U)),1)]),_:1}),n(ee,{style:{"margin-bottom":"0"}},{default:o(()=>[_(c(Object.keys(a(f)).length>0?G(a(f)):"loading..."),1)]),_:1}),n(v,{type:"primary",strong:"",style:{cursor:"pointer"},onClick:E(W,["prevent"])},{default:o(()=>[_(c(a(f).erp_code),1)]),_:1},8,["onClick"]),D(l("div",null,[D(l("input",{type:"text",value:a(f).erp_code,id:"copyErpCode"},null,8,Ke),[[I,!1]])],512),[[I,!1]])]),_:1}),l("div",Pe,[n(te,{value:a(s).code,"onUpdate:value":[t[0]||(t[0]=r=>a(s).code=r),Q],type:"text",placeholder:"Cari kode serialisasi",clearable:"",style:{width:"300px","max-width":"200%"}},null,8,["value"])])]),_:1}),n(ae,{gutter:"12"},{default:o(()=>[n($,{span:6},{default:o(()=>[n(x,{vertical:""},{default:o(()=>[n(v,null,{default:o(()=>[_(" Kode Produk : "+c(a(k).code),1)]),_:1}),n(v,null,{default:o(()=>[_(" Nama Produk : "+c(a(k).name),1)]),_:1}),n(v,null,{default:o(()=>[_(" No. Batch : "+c(a(k).batch),1)]),_:1})]),_:1})]),_:1}),n($,{span:6},{default:o(()=>[n(x,{vertical:""},{default:o(()=>[n(v,null,{default:o(()=>[_(" Expired Date : "+c(a(Le)(a(k).expired_date).format("yyyy-MM-DD")),1)]),_:1}),n(v,null,{default:o(()=>[_(" Total Qty Level Terendah : "+c(e.$filters.toNumber(a(k).count)),1)]),_:1})]),_:1})]),_:1})]),_:1}),n(re,{style:{"margin-bottom":"1rem","border-radius":"10px"}},{default:o(()=>[a(w)?(m(),C(oe,{key:0})):(m(),C(se,{key:1,"x-scrollable":""},{default:o(()=>[n(le,{bordered:!1,"single-line":!1},{default:o(()=>[l("thead",null,[l("tr",null,[je,Ve,Fe,Oe,L("",!0)])]),l("tbody",null,[a(y).list&&a(y).list.length>0?(m(!0),N(ve,{key:0},he(a(y).list,(r,B)=>{var P;return m(),N("tr",{key:B},[l("td",null,c(a(s).limit*(a(s).page-1)+(B+1)),1),l("td",null,[n(x,null,{default:o(()=>{var j;return[((j=r.serialize)==null?void 0:j.level)!==1?(m(),C(v,{key:0,type:"primary",strong:"",style:{cursor:"pointer","text-decoration":"underline"},onClick:E(ue=>{var V;return R(r.code,(V=r.serialize)==null?void 0:V.level,"get")},["prevent"])},{default:o(()=>[_(c(r.code),1)]),_:2},1032,["onClick"])):(m(),C(v,{key:1,strong:""},{default:o(()=>[_(c(r.code),1)]),_:2},1024)),l("div",{style:{"border-radius":"5px","padding-left":"4px","padding-right":"4px",border:"1px solid #000",cursor:"pointer"},onClick:E(ue=>Y(B),["prevent"])}," Copy ",8,Ue)]}),_:2},1024),D(l("div",null,[D(l("input",{type:"text",value:r.code,id:"copyCode"+B},null,8,qe),[[I,!1]])],512),[[I,!1]])]),l("td",Ae,c((P=r.serialize)==null?void 0:P.level),1),l("td",He,[n(ne,{type:"success",bordered:!1,round:""},{default:o(()=>[_(c(r.status?r.status:"-"),1)]),_:2},1024)]),L("",!0)])}),128)):(m(),N("tr",Je,Ge))])]),_:1})]),_:1})),l("div",We,[n(ie,{page:a(s).page,"onUpdate:page":[t[1]||(t[1]=r=>a(s).page=r),S],"page-size":a(s).limit,"onUpdate:pageSize":[t[2]||(t[2]=r=>a(s).limit=r),J],"page-count":a(y).total_page,"page-slot":7,"show-size-picker":a(y).total_data>10,"page-sizes":[10,20,30,40,50]},null,8,["page","page-size","page-count","show-size-picker"])])]),_:1})]),_:1}),l("div",Ye,[l("div",Ze,[n(K,{color:"#828282",class:"button-tnt",style:{width:"120px"},loading:a(w),onClick:Z},{default:o(()=>[_(" Kembali ")]),_:1},8,["loading"]),a(b).length>0?(m(),C(K,{key:0,loading:a(z),color:"#828282",ghost:"",class:"button-tnt",onClick:X},{default:o(()=>[n(ce,{component:a(Re)},null,8,["component"]),Xe]),_:1},8,["loading"])):L("",!0)])])])}}});export{rt as default};
